
<!doctype html>
<html lang="hu" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Benedek Zoltán">
      
      
        <link rel="canonical" href="https://bmeviauab00.github.io/szoftvertechnikak/2024/labor/old-5-mvvm/index_ger/">
      
      
      
      
      <link rel="icon" href="../../../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.9">
    
    
      
        <title>5. MVVM - BMEVIAUAB00 Szoftvertechnikák</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.f2e4d321.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../css/timeago.css">
    
      <link rel="stylesheet" href="../../../extra-material-theme.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="aut" data-md-color-primary="aut" data-md-color-accent="red">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#5-mvvm" class="md-skip">
          Kihagyás
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Élőfej">
    <a href="../../.." title="BMEVIAUAB00 Szoftvertechnikák" class="md-header__button md-logo" aria-label="BMEVIAUAB00 Szoftvertechnikák" data-md-component="logo">
      
  <img src="../../../img/logo-bme-aut.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            BMEVIAUAB00 Szoftvertechnikák
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              5. MVVM
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="aut" data-md-color-primary="aut" data-md-color-accent="red"  aria-label="Váltás sötét témára"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Váltás sötét témára" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="red" data-md-color-accent="indigo"  aria-label="Váltás világos témára"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Váltás világos témára" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Keresés" placeholder="Keresés" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Keresés">
        
        <button type="reset" class="md-search__icon md-icon" title="Törlés" aria-label="Törlés" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Keresés inicializálása
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/bmeviauab00/szoftvertechnikak" title="Főoldalra ugrás" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    bmeviauab00/szoftvertechnikak
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Lapok" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  Szoftvertechnikák (2024-től)

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../1-model-es-kod-kapcsolata/" class="md-tabs__link">
          
  
  Laborok

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../hazi/" class="md-tabs__link">
          
  
  Önálló/házi feladatok

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../1-model-es-kod-kapcsolata/index_eng/" class="md-tabs__link">
          
  
  English course labs

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../hazi/index_eng/" class="md-tabs__link">
          
  
  Homework

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../1-model-es-kod-kapcsolata/index_ger/" class="md-tabs__link">
          
  
  Deutschkurs-Labore

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../hazi/meghirdetes-elott_ger/" class="md-tabs__link">
          
  
  Hausaufgaben

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigáció" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="BMEVIAUAB00 Szoftvertechnikák" class="md-nav__button md-logo" aria-label="BMEVIAUAB00 Szoftvertechnikák" data-md-component="logo">
      
  <img src="../../../img/logo-bme-aut.png" alt="logo">

    </a>
    BMEVIAUAB00 Szoftvertechnikák
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/bmeviauab00/szoftvertechnikak" title="Főoldalra ugrás" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    bmeviauab00/szoftvertechnikak
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Szoftvertechnikák (2024-től)
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Laborok
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Laborok
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1-model-es-kod-kapcsolata/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. A modell és a kód kapcsolata
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2-nyelvi-eszkozok/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. Nyelvi eszközök
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../3-felhasznaloi-felulet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. A felhasználói felület kialakítása
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../4-tobbszalu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4. Többszálú alkalmazások készítése
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../5-mvvm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5. MVVM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../6-tervezesi-mintak/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6. Tervezési minták (kiterjeszthetőség)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../7-adatkezeles/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7. Adatkezelés
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Önálló/házi feladatok
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Önálló/házi feladatok
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hazi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Útmutató
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hazi/1-model-es-kod-kapcsolata/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. HF - A modell és a kód kapcsolata
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hazi/2-nyelvi-eszkozok/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. HF - Nyelvi eszközök
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hazi/3-felhasznaloi-felulet-kialakitasa/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. HF - Felhasználói felület kialakítása
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hazi/meghirdetes-elott/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4. HF - Többszálú alkalmazások fejlesztése
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hazi/meghirdetes-elott/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5. HF - MVVM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hazi/meghirdetes-elott/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6. HF - Tervezési minták
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hazi/meghirdetes-elott/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IMSc HF - Liftrendszer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hazi/meghirdetes-elott/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IMSc HF - MVVM receptek
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hazi/fejlesztokornyezet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fejlesztőkörnyezet
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    English course labs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            English course labs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1-model-es-kod-kapcsolata/index_eng/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. The relationship between the model and the code
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2-nyelvi-eszkozok/index_eng/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. Language tools
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../3-felhasznaloi-felulet/index_eng/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. The design of the user interface
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../4-tobbszalu/index_eng.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    None
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../meghirdetes-elott_eng/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5. MVVM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../6-tervezesi-mintak/index_eng.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    None
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../7-adatkezeles/index_eng.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    None
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Homework
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Homework
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hazi/index_eng/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hazi/1-model-es-kod-kapcsolata/index_eng/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. HW - The relationship between the model and the code
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hazi/2-nyelvi-eszkozok/index_eng/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. HW - Language tools
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hazi/3-felhasznaloi-felulet-kialakitasa/index_eng/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. HW - Implementing the user interface
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hazi/meghirdetes-elott_eng/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4. HW - Developing multithreaded applications
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hazi/meghirdetes-elott_eng/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5. HW - MVVM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hazi/meghirdetes-elott_eng/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6. HW - Design patterns
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hazi/meghirdetes-elott_eng/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IMSc HW - Liftsystem
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hazi/meghirdetes-elott_eng/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IMSc HW - MVVM recipies
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hazi/fejlesztokornyezet/index_eng/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Development environment
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Deutschkurs-Labore
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Deutschkurs-Labore
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1-model-es-kod-kapcsolata/index_ger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. Beziehung zwischen dem Modell und dem Code
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2-nyelvi-eszkozok/index_ger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. Sprachliche Mittel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../3-felhasznaloi-felulet/index_ger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. Entwurf der Benutzeroberfläche
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../4-tobbszalu/index_ger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4. Erstellung von mehrfädigen Anwendungen
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../meghirdetes-elott_ger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5. MVVM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../6-tervezesi-mintak/index_ger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6. Entwurfsmuster (Erweiterbarkeit)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../7-adatkezeles/index_ger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7. Datenverwaltung
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Hausaufgaben
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Hausaufgaben
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hazi/meghirdetes-elott_ger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. Beziehung zwischen dem Modell und dem Code
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hazi/meghirdetes-elott_ger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. Sprachliche Mittel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hazi/3-felhasznaloi-felulet-kialakitasa/index_ger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. Entwurf der Benutzeroberfläche
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hazi/4-tobbszalu-alkalmazasok-fejlesztese/index_ger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4. Entwicklung von Multithreading-Anwendungen
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hazi/5-mvvm/index_ger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5. MVVM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hazi/meghirdetes-elott_ger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6. Entwurfsmuster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hazi/fejlesztokornyezet/index_ger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Entwicklungsumgebung
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Tartalomjegyzék">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tartalomjegyzék
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#das-ziel-der-ubung" class="md-nav__link">
    <span class="md-ellipsis">
      Das Ziel der Übung
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#voraussetzungen" class="md-nav__link">
    <span class="md-ellipsis">
      Voraussetzungen
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ursprungliches-projekt" class="md-nav__link">
    <span class="md-ellipsis">
      Ursprüngliches Projekt
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#uber-das-mvvm-muster" class="md-nav__link">
    <span class="md-ellipsis">
      Über das MVVM-Muster
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aufgabe-0-projektstruktur" class="md-nav__link">
    <span class="md-ellipsis">
      Aufgabe 0. - Projektstruktur
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aufgabe-1-rezepte-hauptseite" class="md-nav__link">
    <span class="md-ellipsis">
      Aufgabe 1. - Rezepte Hauptseite
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Aufgabe 1. - Rezepte Hauptseite">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-datenzugangsdienst" class="md-nav__link">
    <span class="md-ellipsis">
      1.1 Datenzugangsdienst
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-startseite-viewmodel" class="md-nav__link">
    <span class="md-ellipsis">
      1.2 Startseite ViewModel
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1.2 Startseite ViewModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dependency-injection" class="md-nav__link">
    <span class="md-ellipsis">
      Dependency Injection¶
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viewmodel-status" class="md-nav__link">
    <span class="md-ellipsis">
      ViewModel-Status
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-ansicht-der-hauptseite" class="md-nav__link">
    <span class="md-ellipsis">
      1.3 Ansicht der Hauptseite
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aufgabe-2-rezept-detailseite" class="md-nav__link">
    <span class="md-ellipsis">
      Aufgabe 2. - Rezept-Detailseite
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Aufgabe 2. - Rezept-Detailseite">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-abfrage-eines-rezepts" class="md-nav__link">
    <span class="md-ellipsis">
      2.1 Abfrage eines Rezepts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-rezept-detailliertes-viewmodel" class="md-nav__link">
    <span class="md-ellipsis">
      2.2 Rezept detailliertes ViewModel
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-rezeptdetailseite-navigation" class="md-nav__link">
    <span class="md-ellipsis">
      2.3 Rezeptdetailseite, Navigation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.3 Rezeptdetailseite, Navigation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#command" class="md-nav__link">
    <span class="md-ellipsis">
      Command
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24-rezept-detailansicht" class="md-nav__link">
    <span class="md-ellipsis">
      2.4 Rezept-Detailansicht
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aufgabe-3-kommentare-hinzufugen" class="md-nav__link">
    <span class="md-ellipsis">
      Aufgabe 3. - Kommentare hinzufügen
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Aufgabe 3. - Kommentare hinzufügen">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#webdienst" class="md-nav__link">
    <span class="md-ellipsis">
      Webdienst
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viewmodel" class="md-nav__link">
    <span class="md-ellipsis">
      ViewModel
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ausblick-bedingungen-fur-die-ausfuhrung-von-befehlen" class="md-nav__link">
    <span class="md-ellipsis">
      Ausblick: Bedingungen für die Ausführung von Befehlen
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/bmeviauab00/szoftvertechnikak/edit/master/docs/labor/old-5-mvvm/index_ger.md" title="Oldal szerkesztése" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg>
    </a>
  
  


<h1 id="5-mvvm">5. MVVM<a class="headerlink" href="#5-mvvm" title="Permanent link">&para;</a></h1>
<h2 id="das-ziel-der-ubung">Das Ziel der Übung<a class="headerlink" href="#das-ziel-der-ubung" title="Permanent link">&para;</a></h2>
<p>In dieser Übung werden wir eine Rezept-Browser-Anwendung unter Verwendung des MVVM-Entwurfsmusters erstellen.</p>
<h2 id="voraussetzungen">Voraussetzungen<a class="headerlink" href="#voraussetzungen" title="Permanent link">&para;</a></h2>
<p>Die für die Durchführung des Labors benötigten Werkzeuge:</p>
<ul>
<li>Betriebssystem Windows 10 oder Windows 11 (Linux und macOS nicht geeignet)</li>
<li>Visual Studio 2022<ul>
<li>Windows Desktop Development Workload</li>
</ul>
</li>
</ul>
<h2 id="ursprungliches-projekt">Ursprüngliches Projekt<a class="headerlink" href="#ursprungliches-projekt" title="Permanent link">&para;</a></h2>
<p>Klonen Sie das ursprüngliche Projekt mit dem folgenden Befehl:</p>
<div class="highlight"><pre><span></span><code>git clone https://github.com/bmeviauab00/lab-mvvm-kiindulo
</code></pre></div>
<details class="success">
<summary>Laden Sie die fertige Lösung herunter</summary>
<p><img alt="❗" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2757.svg" title=":exclamation:" /> Es ist wichtig, dass Sie sich während des Praktikums an die Anleitung halten. Es ist verboten (und sinnlos), die fertige Lösung herunterzuladen. Allerdings kann es bei der anschließenden Selbsteinübung nützlich sein, die fertige Lösung zu überprüfen, daher stellen wir sie zur Verfügung.</p>
<p>Die Lösung ist [auf GitHub] (<a href="https://github.com/bmeviauab00/lab-mvvm-kiindulo">https://github.com/bmeviauab00/lab-mvvm-kiindulo</a>) im <code>solve</code>-Zweig verfügbar. Der einfachste Weg, es herunterzuladen, ist, den <code>git clone</code>-Zweig von der Kommandozeile aus zu klonen:</p>
<p><code>git clone https://github.com/bmeviauab00/lab-mvvm-kiindulo -b solved</code></p>
</details>
<h2 id="uber-das-mvvm-muster">Über das MVVM-Muster<a class="headerlink" href="#uber-das-mvvm-muster" title="Permanent link">&para;</a></h2>
<p>Das MVVM (Model-View-ViewModel) ist ein Architekturentwurfsmuster, das bei der Entwicklung von XAML-Anwendungen eingesetzt werden kann, aber auch häufig in anderen clientseitigen Technologien verwendet wird. Das MVVM-Muster wurde entwickelt, um die Benutzeroberfläche und die zugrunde liegende Logik zu entkoppeln und so eine lose gekoppelte Anwendung zu schaffen, die die Testbarkeit, Wartbarkeit und Wiederverwendbarkeit erhöht.</p>
<p>Das MVVM-Muster besteht aus drei (+1) Hauptteilen:</p>
<ul>
<li><strong>Modell</strong>: Enthält das Geschäftsmodell/Domänenmodell der Anwendung, das ViewModels zum Speichern von Daten verwenden können.</li>
<li><strong>View</strong> (Ansicht): Sie enthält eine Beschreibung der Benutzeroberfläche und der rein auf die Ansichten bezogenen Logik (z.B.: Behandlung von Animationen).</li>
<li><strong>ViewModel</strong> (Ansichtsmodell): Eine <strong>Abstraktion</strong> der Ansicht, die den Zustand der Ansicht und die Operationen enthält, die mit der Ansicht durchgeführt werden können, <strong>unabhängig von der Ansicht</strong>. Die lose Kopplung zwischen dem ViewModel und dem View wird durch die Datenverbindung gewährleistet.</li>
<li><strong>Services</strong> (Dienstleistungen): Klassen, die die Geschäftslogik der Anwendung enthalten und von ViewModels verwendet werden. Wäre die gesamte Geschäftslogik in ViewModels enthalten, wären diese zu komplex und undurchsichtig. Dies ist nicht Teil des MVVM-Musters, aber wir erwähnen es hier, weil wir die Anwendungsarchitektur auf diese Weise nutzen werden.</li>
</ul>
<p>Neu:</p>
<ul>
<li><strong>Modell</strong>: Erfasst domänenspezifische Daten, die ViewModels zum Speichern von Daten verwenden können. Z.B. die Klasse Recipe/Product/Order, die die Daten eines Rezepts/Produkts/Bestellung zusammenfasst.</li>
<li><strong>View</strong> (Ansicht): Sie enthält eine Beschreibung der Benutzeroberfläche (und der rein auf die Ansichten bezogenen Logik, z. B. die Behandlung von Animationen). Typischerweise eine von Window, Page, UserControl abgeleitete Klasse, mit einer deklarativen Beschreibung in XAML, der Code-Behind ist oft leer (weil die Logik im ViewModel ist).</li>
<li><strong>ViewModel</strong> (Ansichtsmodell): Sie enthält die Logik für die Ansicht: Sie enthält den Zustand der Ansicht und die Operationen, die mit der Ansicht durchgeführt werden können. Sie ist <strong>unabhängig von der Ansicht</strong>, wird eine lose Kopplung zwischen dem ViewModel und der Ansicht durch Datenverbindung erreicht (die Steuerelemente der Ansicht binden an die Eigenschaften des ViewModels). Einheitlich testbar (unit test)!</li>
<li><strong>Services</strong> (Dienstleistungen): Klassen, die die Geschäfts-/Anwendungslogik enthalten und von ViewModels verwendet werden. Wäre die gesamte Geschäftslogik in ViewModels enthalten, wären diese zu komplex und undurchsichtig. Dies ist nicht Teil des MVVM-Musters, aber wir erwähnen es hier, weil wir auf diese Weise die Architektur der Anwendung aufbauen werden.</li>
</ul>
<figure>
<p><a class="glightbox" href="../images/mvvm.drawio.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="MVVM" src="../images/mvvm.drawio.png" /></a></p>
</figure>
<p><img alt="❗" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2757.svg" title=":exclamation:" /> Wozu erstellen wir ViewModel-Klassen?</p>
<ul>
<li>Wir erstellen immer eine ViewModel-Klasse für jede <strong>Ansicht</strong> (z.B. Window, Page, Dialog, UserControl) und erzeugen daraus je ein Objekt für jede Ansicht.  Z.B. MainPage für MainPageViewModel, DancerDialog für DancerDialogViewModel. Wir wenden dies in der Praxis an.</li>
<li>Für jede <strong>Modellklasse</strong> (z.B. Recipe, Product, Dancer  usw.) können Sie optional Wrapper-ViewModel-Klassen erstellen (z.B. RecipeViewModel, ProductViewModel, DancerViewModel), aber wir werden sie in dieser Übung <strong>nicht</strong> erstellen. Das liegt daran, dass wir nicht dem Strict MVVM-Muster folgen, sondern dem Relaxed MVVM-Muster (siehe Vorlesung).</li>
</ul>
<h2 id="aufgabe-0-projektstruktur">Aufgabe 0. - Projektstruktur<a class="headerlink" href="#aufgabe-0-projektstruktur" title="Permanent link">&para;</a></h2>
<p>Der Anwendungsrahmen ist bereits vorbereitet. Schauen wir uns die Projektstruktur an.</p>
<p><code>MvvmLab</code> ist ein Projekt für eine ausführbare Anwendung, die das WinUI-Framework in seiner Anzeigeschicht mit der bereits erlernten XAML-Sprache verwendet. Das Projekt <code>MvvmLab.Core</code> (Klassenbibliothek) enthält die vollständig ansichtsunabhängige Geschäftslogik.</p>
<p>Was ist für uns in der Anfangsphase des Projekts wichtig?</p>
<ul>
<li><code>App.xaml.cs</code>: Ein Anwendungseintrittspunkt, der die in modernen .NET-Anwendungen verwendeten Muster Host Builder und Dependency Injection verwendet. Dies ist nicht das Thema dieses Semesters, aber die Injektion von Abhängigkeit wird im Labor behandelt werden.</li>
<li><code>Views</code>-Ordner: Enthält Ansichten der Anwendung, derzeit <code>MainPage</code></li>
<li><code>ViewModels</code>-Ordner: Enthält die ViewModels der Anwendung, derzeit <code>MainPageViewModel</code></li>
<li><code>INagivationService</code> ( im Ordner <code>Services</code> ): Dienst für die Navigation zwischen Seiten</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">MVVM und Boilerplate-Bibliotheken</p>
<p>MVVM-Muster wird selten allein auf der Grundlage des .NET-Frameworks implementiert. Es lohnt sich, einige MVVM-Bibliotheken zu verwenden, die Ihren Code kompakter und übersichtlicher machen und weniger Boilerplate-Code enthalten. Die am häufigsten verwendeten Bibliotheken sind:</p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/dotnet/communitytoolkit/mvvm/">MVVM Toolkit</a>: MVVM-Bibliothek, die von Microsoft gepflegt wird</li>
<li>[Prism] (<a href="https://prismlibrary.com/">https://prismlibrary.com/</a>): Früher wurde es von Microsoft gewartet und war sehr weit verbreitet, aber jetzt wird es von externen Entwicklern gewartet und ist mit der Zeit kostenpflichtig geworden.</li>
<li><a href="https://reactiveui.net/">ReactiveUI</a>: Es verwendet die Reactive Extensions (Rx)-Bibliotheken, um den Zustand des ViewModels zu verwalten und Daten zwischen der Ansicht und dem ViewModel zu binden. Diese Bibliothek bietet die meisten Dienste, ist aber auch am schwierigsten zu erlernen.</li>
<li><a href="https://platform.uno/uno-extensions/">Uno.Extensions</a>: Es basiert auf dem MVVM-Toolkit, enthält aber auch mehrere Funktionen, die Mängel im WinUI-Framework ausfüllen.</li>
</ul>
<p>Während des Praktikums werden wir das MVVM-Toolkit von Microsoft verwenden.</p>
<p>Das ursprüngliche Projekt wurde mit dem Visual Studio Add-on <a href="https://marketplace.visualstudio.com/items?itemName=TemplateStudio.TemplateStudioForWinUICs">Windows Template Studio</a> erstellt.</p>
</div>
<h2 id="aufgabe-1-rezepte-hauptseite">Aufgabe 1. - Rezepte Hauptseite<a class="headerlink" href="#aufgabe-1-rezepte-hauptseite" title="Permanent link">&para;</a></h2>
<p>Die Lösung werden wir "von unten" aufbauen, von den Daten ausgehend werden wir schrittweise zur Ansicht. Die Entwicklung von oben nach unten ist zwar in der Praxis oft nützlicher, aber aufgrund der zeitlichen Beschränkungen im Labor ist die Entwicklung von unten nach oben schneller und einfacher, weil man die Daten so nicht mocken muss. Die folgende Abbildung gibt einen Überblick über die wichtigsten Klassen, die mit der Hauptseite verbunden sind.</p>
<figure>
<p><a class="glightbox" href="../images/mvvm-mainpage.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Főoldal" src="../images/mvvm-mainpage.png" /></a>
<figurecation>MMVM-basierte Implementierung der Homepage<figurecaption></p>
</figure>
<p>Schlüsselelemente:</p>
<ul>
<li><code>MainPage</code>: Diese Ansicht, ein Nachkomme der Seite, ist eine XAML-basierte Beschreibung der Benutzeroberfläche.</li>
<li><code>MainPageViewModel</code>: das ViewModel für die Hauptseite (<code>MainPage</code>). Es enthält Rezeptgruppen in einer (generierten) <code>RecipeGroups</code> Eigenschaft, und Rezepte in den Rezeptgruppen. Diese Ansicht zeigt die Kopfzeile der Rezeptgruppen sowie die Kopfzeile und die Bilder der Rezepte in den Gruppen mit Datenverbindung.</li>
<li><code>RecipeGroup</code> und <code>Recipe</code>: Modellklassen für Rezeptgruppen und Rezepte.</li>
<li><code>RecipeService</code>: Anwendungslogik/Datenzugriff zur Verwaltung von Rezepten (kommuniziert mit einem entfernten Dienst) unter Verwendung von ViewModel.</li>
</ul>
<h3 id="11-datenzugangsdienst">1.1 Datenzugangsdienst<a class="headerlink" href="#11-datenzugangsdienst" title="Permanent link">&para;</a></h3>
<p>Beginnen wir mit der Datenzugriffsschicht, die nun als Modellschicht im MVVM-Muster betrachtet werden kann.</p>
<p>Unsere Anwendung ruft Daten von einem Webserver ab (über die sogenannte REST-API, HTTP). Client-Server-Architekturen wie diese sind eine sehr verbreitete Lösung in der modernen Anwendungsentwicklung. Dies wird im nächsten Semester in Mobile und Web Software, und Data Driven Applications ausführlicher behandelt. Für den Moment genügt es zu wissen, dass unsere Client-Anwendung HTTP-Anfragen an den Server sendet, der mit der Rückgabe von Daten im JSON-Format antwortet.</p>
<figure>
<p><a class="glightbox" href="../images/client-server.drawio.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Kliens-szerver architektúra" src="../images/client-server.drawio.png" /></a>
<figurecation>Client-Server-Architektur<figurecaption></p>
</figure>
<p>Der Ferndienst ist verfügbar unter: <a href="https://bmecookbook2.azurewebsites.net/api">https://bmecookbook2.azurewebsites.net/api</a>. Der Dienst umfasst eine OpenApi-basierte Dokumentation über die <a href="https://bmecookbook2.azurewebsites.net/swagger">https://bmecookbook2.azurewebsites.net/swagger</a> am. Schauen wir uns dies an oder probieren wir die Endpunkte auch über die Oberfläche von Swagger aus (indem man die URL mit der Endung "swagger" in die Adresszeile eines Browsers eingibt). Für die erste Aufgabe werden wir den Endpunkt <code>/api/Recipes/Groups</code> verwenden, der die Gruppierung von Rezepten zurückgibt.</p>
<p>Fügen wir eine neue Klasse namens <code>RecipeGroup</code> in den Ordner <code>Models</code> des Projekts <code>MvvmLab.Core</code> ein.</p>
<p>Rufen wir mit Swagger den Endpunkt "api/Recipes/Groups" auf (genauer gesagt, senden wir eine HTTP-GET-Anfrage)</p>
<ul>
<li>Öffnen wir in der Swagger-Oberfläche die Beschreibung des Endpunktes "Get api/Recipes/Groups".</li>
<li>Klicken wir auf die Taste Execute.</li>
<li>Die vom Dienst gesendete JSON-Antwort wird unter "Response body" angezeigt: Hier sehen wir, dass die Antwort Rezeptgruppen enthält. Jede Gruppe hat einen "Titel" (z.B. Chinese, Mexican, Italian), und unter jeder Gruppe finden wir zwischen <code>[]</code> (JSON-Array) die Daten der Rezepte in der Gruppe. </li>
<li>
<p>Kopieren wir die JSON-Daten von <code>RecipeGroup</code> in die Zwischenablage. Wir können auch die Ausgabe unter "Example Value" verwenden, wenn wir sie in die Zwischenablage kopieren (kopieren wir jedoch nicht die öffnenden [ und schließenden ] Schriftzeichen). Wenn wir aus irgendeinem Grund nicht weiterkommen können, können wir den Inhalt auch aus das folgende Dropdown-Menü in die Zwischenablage kopieren:</p>
<details>
<summary>In die Zwischenablage zu kopieren</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;Title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;Recipes&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;Id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;BackgroundImage&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
</details>
</li>
</ul>
<p>In Visual Studio wählen wir im Menü <code>Edit</code> / <code>Paste Special</code> / <code>Paste JSON as Classes</code> aus, um den Inhalt der Zwischenablage einfügen. VS generiert dann Klassen, die der Struktur des von uns eingefügten JSON entsprechen.</p>
<p><a class="glightbox" href="../images/paste-json-as-classes.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="JSON als Klassen einfügen" src="../images/paste-json-as-classes.png" /></a></p>
<p>Die entstehenden Klassen können umbenannt werden, um den C#-Codierungskonventionen zu entsprechen. Benennen wir die Klasse <code>Rootobject</code> in <code>RecipeGroup</code> und die Klasse <code>Recipe</code> in <code>RecipeHeader</code> um.</p>
<div class="highlight"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">RecipeGroup</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">Title</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="n">RecipeHeader</span><span class="p">[]</span><span class="w"> </span><span class="n">Recipes</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">RecipeHeader</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">Id</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">Title</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">BackgroundImage</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title"> Verwenden von <code>List&lt;T&gt;</code> </p>
<p>In unserem Fall war es nicht notwendig (weil wir die Rezeptgruppen nicht erweitern), aber wenn es bequemer für uns ist, können wir die Blöcke in den generierten Code im  <code>List&lt;T&gt;</code> umwandeln.</p>
</div>
<p>Erstellen wir eine Schnittstelle <code>IRecipeService</code> zum Namespace <code>MvvmLab.Core.Services</code>, über die auf den Remote-Dienst zugegriffen werden soll. In der Schnittstelle erstellen wir eine Methode <code>GetRecipeGroupsAsync</code>, die die Rezeptgruppen abfragt und zurückgibt.</p>
<div class="highlight"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="k">interface</span><span class="w"> </span><span class="n">IRecipeService</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="n">Task</span><span class="o">&lt;</span><span class="n">RecipeGroup</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="n">GetRecipeGroupsAsync</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Task-Rückgabewert</p>
<p>In der Schnittstelle ist der eigentliche Rückgabewert (<code>RecipeGroup[]</code>) in ein Objekt <code>Task&lt;T&gt;</code> verpackt, da es vorzuziehen ist, Netzwerkoperationen asynchron zu implementieren. In .NET ist die modernste und einfachste Art, Asynchronität zu implementieren, die Verwendung von <code>Task</code>s. Und die Asynchronität sorgt dafür, dass die Benutzeroberfläche nicht einfriert, wenn die Netzwerkanforderung lange dauert (und das alles, ohne separate Threads zu starten).</p>
</div>
<p>Die Implementierung der Schnittstelle wird im Namespace <code>MvvmLab.Core.Services</code> unter <code>RecipeService</code> erstellt. Unser Dienst wird die integrierte .NET-Klasse <code>HttpClient</code> für REST-API-Aufrufe verwenden.  <code>GetFromJsonAsync</code> stellt eine asynchrone HTTP GET-Anfrage an die angegebene Adresse und deserialisiert die Antwort von JSON in den angegebenen Typ.</p>
<div class="highlight"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">RecipeService</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">IRecipeService</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">private</span><span class="w"> </span><span class="k">readonly</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">_baseUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;https://bmecookbook2.azurewebsites.net/api&quot;</span><span class="p">;</span>

<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="n">Task</span><span class="o">&lt;</span><span class="n">RecipeGroup</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="n">GetRecipeGroupsAsync</span><span class="p">()</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">using</span><span class="w"> </span><span class="nn">var</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HttpClient</span><span class="p">();</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="n">client</span><span class="p">.</span><span class="n">GetFromJsonAsync</span><span class="o">&lt;</span><span class="n">RecipeGroup</span><span class="p">[]</span><span class="o">&gt;</span><span class="p">(</span><span class="s">$&quot;{_baseUrl}/Recipes/Groups&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Die Operation <code>GetFromJsonAsync</code> ist asynchron, sie gibt also <code>Task</code> zurück, wir können dies nicht blockierend erwarten und mit dem Schlüsselwort <code>await</code> auf das Ergebnis zugreifen.</p>
<div class="admonition tip">
<p class="admonition-title">async-await</p>
<p>Die Schlüsselwörter <code>async</code> und <code>await</code> werden in den meisten modernen Sprachen verwendet, um asynchrone Funktionsaufrufe auf Sprachebene zu behandeln. Wir werden am Ende des Semesters mehr darüber sprechen, wie es funktioniert, aber bis dahin müssen Sie Folgendes wissen, um es zu nutzen:</p>
<ul>
<li>Mit dem Schlüsselwort <code>await</code> können wir auf eine asynchrone Ausführung warten, ohne den Aufrufer zu blockieren.</li>
<li>Das Schlüsselwort <code>await</code> kann nur in Funktionen mit dem Schlüsselwort <code>async</code> verwendet werden.</li>
<li><code>async</code>-Funktionen können nur den Rückgabewert <code>Task</code> oder <code>Task&lt;T&gt;</code> oder <code>void</code> haben. (Oder "Task-ähnlich", aber das nehmen wir hier nicht.)<ul>
<li>Wenn man eine <code>async</code>-Funktion von außen abwarten will, kann man das nicht mit void tun, sondern man muss einen Rückgabewert von <code>Task</code> oder <code>Task&lt;T&gt;</code> haben.</li>
<li>In <code>async</code>-Funktionen wird die Syntax der <code>return</code>-Anweisung geändert: es muss nicht das Task-Objekt zurückgegeben werden, sondern die darin enthaltenen Daten (<code>void</code> für <code>Task</code>, <code>Task&lt;T&gt;</code> für <code>T</code>).</li>
</ul>
</li>
</ul>
</div>
<h3 id="12-startseite-viewmodel">1.2 Startseite ViewModel<a class="headerlink" href="#12-startseite-viewmodel" title="Permanent link">&para;</a></h3>
<p>Im nächsten Schritt erstellen wir das ViewModel der Hauptseite, das den soeben erstellten Dienst verwendet, um die Rezeptgruppen abzurufen und sie als Status für die Ansicht zu speichern.</p>
<h4 id="dependency-injection">Dependency Injection¶<a class="headerlink" href="#dependency-injection" title="Permanent link">&para;</a></h4>
<p>Öffnen wir die Klasse <code>MainPageViewModel</code> aus dem Ordner <code>MvvmLab.ViewModels</code>.  Unser ViewModel benötigt eine Klasse, die die Schnittstelle <code>IRecipeService</code> implementiert, über die es die Rezeptgruppen abfragen kann. Im <code>MainPageViewModel</code> Konstruktor erhalten wir die erforderliche Abhängigkeit über Dependency Injection. In unserem Fall bedeutet dies, dass wir einen Parameter vom Typ <code>IRecipeService</code> erwarten, der vom ViewModel empfangen wird, wenn es instanziiert wird, und der Parameter wird in einer privaten Variablen gespeichert.</p>
<div class="highlight"><pre><span></span><code><span class="k">private</span><span class="w"> </span><span class="k">readonly</span><span class="w"> </span><span class="n">IRecipeService</span><span class="w"> </span><span class="n">_recipeService</span><span class="p">;</span>

<span class="k">public</span><span class="w"> </span><span class="nf">MainPageViewModel</span><span class="p">(</span><span class="n">IRecipeService</span><span class="w"> </span><span class="n">recipeService</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">_recipeService</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">recipeService</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<details class="tip">
<summary>Dependency Injection - DI</summary>
<p>Standardmäßig sind Klassen eng mit ihren Abhängigkeiten gekoppelt (Referenz, Instanziierung). </p>
<p><figure markdown>
<a class="glightbox" href="../images/without-di.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Ohne DI" src="../images/without-di.png" /></a>
<figurecaption>Starke Kopplung ohne DI</figurecaption>
</figure></p>
<p>Diese enge Kopplung erschwert die Prüfung, Wartung und Wiederverwendung. Dies wird durch den Einsatz von Dependency Injection (und Strategy) unterstützt. In diesem Kurs lernen wir das Dependency Injection (DI) Entwurfmuster kennen, das immer in Verbindung mit dem Strategy-Muster verwendet wird. Die Idee ist, dass eine Klasse ihre Abhängigkeiten (die Klassen, von denen sie abhängt und die sie verwendet) nicht selbst erzeugt, sondern sie von außen erhält, z.B. in einem Konstruktorparameter. Das Strategy-Muster impliziert, dass sie nur als "Schnittstelle" von ihnen abhängt. </p>
<p>Die meisten Plattformen bieten heute auch einen zusätzlichen Dienst, einen so genannten DI-<strong>Container</strong> (auch IoC-Container genannt),  zur bequemen Verwaltung von Abhängigkeiten. 
Der Lebenszyklus von Abhängigkeiten wird dann von einer speziellen Komponente, dem DI-Container, verwaltet. Der DI-Container (dargestellt als Builder) ist für die Instanziierung von Klassen und die rekursive Injektion von Abhängigkeiten zuständig.</p>
<p><figure markdown>
<a class="glightbox" href="../images/with-di.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Mit DI" src="../images/with-di.png" /></a>
<figurecaption>DI-Klassendiagramm</figurecaption>
</figure></p>
</details>
<p>Um die entsprechenden Implementierungen zu injektieren, während des Durchlaufens der Abhängigkeitsgraph während der Instanziierung, müssen die <strong>Abhängigkeitszuordnungen</strong> im DI-Container registriert werden. In unserer Anwendung tun wir dies in der Datei <code>App.xaml.cs</code> in der Methode <code>ConfigureServices</code>.  Fügen wir die folgende Zeile hinzu, z.B. unter dem Abschnitt <code>// Core Services</code>: </p>
<div class="highlight"><pre><span></span><code><span class="n">services</span><span class="p">.</span><span class="n">AddTransient</span><span class="o">&lt;</span><span class="n">IRecipeService</span><span class="p">,</span><span class="w"> </span><span class="n">RecipeService</span><span class="o">&gt;</span><span class="p">();</span>
</code></pre></div>
<p>Dies sagt uns, dass das DI-Framework eine <code>RecipeService</code>-Implementierung injektiert, wenn eine Klasse eine <code>IRecipeService</code>-Abhängigkeit erwartet (z.B. den Konstruktor von <code>MainPageViewModel</code>). (Da wir sie hier als <strong>Transient</strong> Lifetime registriert haben, wird jede <code>IRecipeService</code>-Abhängigkeitsanforderung durch eine neue <code>RecipeService</code>-Instanz erfüllt).</p>
<p>Damit Dependency Injection in unserer Anwendung funktioniert, muss die Klasse <code>MainPageViewModel</code> auch im Container registriert sein, der ebenfalls unter <code>ConfigureServices</code> zu finden ist.</p>
<div class="admonition note">
<p class="admonition-title">Über DI-Container im Detail</p>
<p>Die Verwendung und Funktionsweise von DI-Containern wird später im Kurs Datengesteuerte Systeme ausführlich behandelt.</p>
</div>
<h4 id="viewmodel-status">ViewModel-Status<a class="headerlink" href="#viewmodel-status" title="Permanent link">&para;</a></h4>
<p>Im nächsten Schritt werden wir das Hochladen des ViewModel-Status implementieren.</p>
<p>Unser Ziel ist, dass</p>
<ul>
<li><code>MainPageViewModel</code> hat eine Eigenschaft namens <code>RecipeGroups</code>, die Rezeptgruppen enthält (wir wollen diese an die Oberfläche binden),</li>
<li>die Änderungen von <code>RecipeGroups</code> von der Schnittstelle verfolgt werden, was die Implementierung von <code>INotifyPropertyChanged</code> und das korrekte Auslösen von <code>PropertyChanged</code> erfordert (wie wir bereits in der vorherigen Übung/Hausaufgabe gesehen haben).</li>
</ul>
<p>Dies würde relativ "viel" Arbeit erfordern, aber das MVVM-Toolkit vereinfacht unser Leben, denn wir müssen nur das Folgendes tun:</p>
<ul>
<li>Erstellen wir in <code>MainPageViewModel</code> eine <code>RecipeGroup[]</code> <strong>Member-Variable</strong> (keine Eigenschaft) mit dem Namen <code>_recipeGroups</code>. </li>
<li>Die Variable wird mit dem Attribut <code>ObservableProperty</code> versehen. </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="na">[ObservableProperty]</span>
<span class="k">private</span><span class="w"> </span><span class="n">RecipeGroup</span><span class="p">[]</span><span class="w"> </span><span class="n">_recipeGroups</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Array</span><span class="p">.</span><span class="n">Empty</span><span class="o">&lt;</span><span class="n">RecipeGroup</span><span class="o">&gt;</span><span class="p">();</span>
</code></pre></div>
<p>Hier sind wir nun. Aber was passiert dann?</p>
<ul>
<li>Auf dieser Grundlage erzeugt MVVM Toolkit automatisch eine Eigenschaft namens <code>RecipeGroups</code> in der generierten (partiellen) Hälfte der Klasse.</li>
<li>Diese generierte Eigenschaft nutzt die Vorteile der Schnittstelle <code>INotifyPropertyChanged</code>. Wenn sich der Wert der Eigenschaft <code>RecipeGroups</code> ändert, wird das Ereignis <code>PropertyChanged</code> ausgelöst, um die Ansicht entlang der Datenverbindungen zu benachrichtigen.</li>
<li>Unser <code>MainPageViewModel</code> implementiert bereits die Schnittstelle <code>INotifyPropertyChanged</code>, da es von der Klasse <code>ObservableObject</code> des MVVM-Toolkits stammt.</li>
</ul>
<p>In <code>MainPageViewModel</code> implementieren wir die vorbereitete Schnittstelle <code>INavigationAware</code>, die es uns ermöglicht, das Navigations-Lebenszyklus-Ereignis zwischen Ansichten zu handhaben und sogar Daten zwischen ViewModels zu übergeben. In der Methode <code>OnNavigatedTo</code> werden die Rezeptgruppen über <code>IRecipeService</code> abgefragt und in der Variablen <code>RecipeGroups</code> gespeichert.</p>
<div class="highlight"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="k">partial</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">MainPageViewModel</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ObservableObject</span><span class="p">,</span><span class="w"> </span><span class="n">INavigationAware</span>
<span class="p">{</span>
<span class="w">    </span><span class="c1">// ...</span>

<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">OnNavigatedTo</span><span class="p">(</span><span class="kt">object</span><span class="w"> </span><span class="n">parameter</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="hll"><span class="w">        </span><span class="n">RecipeGroups</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="n">_recipeService</span><span class="p">.</span><span class="n">GetRecipeGroupsAsync</span><span class="p">();</span>
</span><span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">OnNavigatedFrom</span><span class="p">()</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="13-ansicht-der-hauptseite">1.3 Ansicht der Hauptseite<a class="headerlink" href="#13-ansicht-der-hauptseite" title="Permanent link">&para;</a></h3>
<p>Erstellen wir die Ansicht auf <code>MainPage</code>, in der die Rezeptgruppen angezeigt werden.</p>
<p>Damit <code>GridView</code> die Gruppierung behandeln kann, brauchen wir eine Liste, die die Gruppierung vornimmt. Wir können dies mit der Klasse <code>CollectionViewSource</code> tun, die in gewisser Weise UI-spezifische Wrapping-Aufgaben für Sammlungen übernimmt. <code>CollectionViewSource</code> muss die zu gruppierenden Elemente und die Eigenschaft, auf der die Gruppen basieren, angegeben werden. Wir müssen auch die Eigenschaft angeben, auf der die Elemente innerhalb der Gruppen angezeigt werden sollen.</p>
<p>Erstellen wir die Instanz <code>CollectionViewSource</code> in den Ressourcen der Seite (fügen wir den Code unten in <code>MainPage.xaml</code> ein, oberhalb des Grids, auf der gleichen Ebene wo es liegt).</p>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;Page.Resources&gt;</span>
<span class="w">    </span><span class="nt">&lt;CollectionViewSource</span><span class="w"> </span><span class="na">x:Name=</span><span class="s">&quot;RecipeGroupsCollectionSource&quot;</span>
<span class="w">                            </span><span class="na">IsSourceGrouped=</span><span class="s">&quot;True&quot;</span>
<span class="w">                            </span><span class="na">ItemsPath=</span><span class="s">&quot;Recipes&quot;</span>
<span class="w">                            </span><span class="na">Source=</span><span class="s">&quot;{x:Bind ViewModel.RecipeGroups, Mode=OneWay}&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="nt">&lt;/Page.Resources&gt;</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Beachten Sie, dass wir in der Datenverbindung an die Eigenschaft <code>ViewModel</code> binden, die sich in <code>MainPage.xaml.cs</code> befindet, und einfach die Eigenschaft <code>DataContext</code> an unseren ViewModel-Typ übergeben.</p>
<div class="highlight"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="n">MainPageViewModel</span><span class="w"> </span><span class="n">ViewModel</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">DataContext</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">MainPageViewModel</span><span class="p">;</span>
</code></pre></div>
<p>Die Speicherung des ViewModels in der Eigenschaft <code>DataContext</code> der Steuerelemente (Seiten) ist typisch für das MVVM-Muster. In unserem Fall übernimmt die Klasse "NavigationService" des generierten Projekts diese Aufgabe für uns.</p>
</div>
<details class="tip">
<summary>Ressourcen</summary>
<p>In der XAML-Umgebung hat jedes Steuerelement (im obigen Beispiel die Seite) und die Klasse <code>Application</code> standardmäßig eine Eigenschaft <code>Resources</code>, die ein Schlüssel-Wert-Speicher ist (<code>Dictionary&lt;string, object&gt;</code>). Sie können wiederverwendbare Objekte einfügen, sogar auf der Anwendungsebene. Wenn Sie bei der Instanziierung von Ressourcen das Attribut <code>x:Key</code> angeben, können Sie Ressourcen nach Schlüsseln abfragen, z.B. mit der Markup-Erweiterung <code>{StaticResource Key}</code>. </p>
<p>Aber hier haben wir explizit <code>x:Name</code> anstelle von <code>x:Key</code> angegeben, weil wir uns in <code>x:Bind</code> auf den Namen beziehen wollen (zur Erinnerung: das Attribut <code>x:Name</code> wird verwendet, um eine Mitgliedsvariable in unserer Klasse mit diesem Namen zu erzeugen, so dass wir sie aus dem code behind Datei oder während der Verwendung von x:Bind Datenverbindung, mit diesem Namen erreichen können).</p>
</details>
<p>Für die Auflistung der Rezepte verwenden wir nun ein spezielles, von <code>GridView</code> abgeleitetes Steuerelement, nämlich <code>AdaptiveGridView</code>aus dem <a href="https://learn.microsoft.com/en-us/windows/communitytoolkit/">CommunityToolkit-Paket</a>, das die Anzahl und Größe der angezeigten Elemente in Abhängigkeit von der Größe der Ansicht ändert und die Benutzung von Commands für Elementklicks unterstützt. Um auf externe Steuerelemente zu verweisen, fügen wir zu der Seite den folgenden Namespace hinzu:</p>
<div class="highlight"><pre><span></span><code>xmlns:controls=&quot;using:CommunityToolkit.WinUI.UI.Controls&quot;
</code></pre></div>
<p>Erstellen wir die GridView mit der Eigenschaft <code>ItemsSource</code>, die in der obigen Ressource an <code>RecipeGroupsCollectionSource.View</code> gebunden ist.</p>
<p>Innerhalb von <code>GridView</code> können wir wie gewohnt über die Eigenschaft <code>ItemTemplate</code> festlegen, wie jedes Element angezeigt werden soll. In unserem Fall haben wir ein Bild und einen Text, der auf dem Titel des Rezepts basiert, in ein "kartenähnliches" Layout gesetzt.</p>
<p>Und über die Eigenschaft <code>GroupStyle</code> können wir festlegen, wie die Gruppen angezeigt werden sollen. In diesem Fall wollen wir die Kopfzeile anpassen.</p>
<p>Ersetzen wir in <code>MainPage.xaml</code> das Gitter <code>&lt;Grid x:Name="ContentArea"&gt; ...</code> durch das folgende:</p>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;Grid</span><span class="w"> </span><span class="na">x:Name=</span><span class="s">&quot;ContentArea&quot;</span><span class="w"> </span><span class="na">Padding=</span><span class="s">&quot;10&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Grid.RowDefinitions&gt;</span>
<span class="w">        </span><span class="nt">&lt;RowDefinition</span><span class="w"> </span><span class="na">Height=</span><span class="s">&quot;Auto&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;RowDefinition</span><span class="w"> </span><span class="na">Height=</span><span class="s">&quot;*&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/Grid.RowDefinitions&gt;</span>

<span class="w">    </span><span class="nt">&lt;TextBlock</span><span class="w"> </span><span class="na">Text=</span><span class="s">&quot;Recipes&quot;</span>
<span class="w">               </span><span class="na">Grid.Row=</span><span class="s">&quot;0&quot;</span>
<span class="w">               </span><span class="na">Style=</span><span class="s">&quot;{StaticResource TitleLargeTextBlockStyle}&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>

<span class="w">    </span><span class="nt">&lt;controls:AdaptiveGridView</span><span class="w"> </span><span class="na">Grid.Row=</span><span class="s">&quot;1&quot;</span>
<span class="w">                               </span><span class="na">DesiredWidth=</span><span class="s">&quot;180&quot;</span>
<span class="w">                               </span><span class="na">IsItemClickEnabled=</span><span class="s">&quot;True&quot;</span>
<span class="w">                               </span><span class="na">ItemHeight=</span><span class="s">&quot;160&quot;</span>
<span class="w">                               </span><span class="na">ItemsSource=</span><span class="s">&quot;{x:Bind RecipeGroupsCollectionSource.View, Mode=OneWay}&quot;</span>
<span class="w">                               </span><span class="na">SelectionMode=</span><span class="s">&quot;None&quot;</span>
<span class="w">                               </span><span class="na">StretchContentForSingleRow=</span><span class="s">&quot;False&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;GridView.ItemTemplate&gt;</span>
<span class="w">            </span><span class="nt">&lt;DataTemplate</span><span class="w"> </span><span class="na">x:DataType=</span><span class="s">&quot;models:RecipeHeader&quot;</span><span class="nt">&gt;</span>
<span class="w">                </span><span class="nt">&lt;Grid</span><span class="w"> </span><span class="na">MaxWidth=</span><span class="s">&quot;300&quot;</span><span class="nt">&gt;</span>
<span class="w">                    </span><span class="nt">&lt;Image</span><span class="w"> </span><span class="na">Source=</span><span class="s">&quot;{x:Bind BackgroundImage}&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">                    </span><span class="nt">&lt;Border</span><span class="w"> </span><span class="na">Height=</span><span class="s">&quot;40&quot;</span>
<span class="w">                            </span><span class="na">Padding=</span><span class="s">&quot;10,0,0,0&quot;</span>
<span class="w">                            </span><span class="na">VerticalAlignment=</span><span class="s">&quot;Bottom&quot;</span>
<span class="w">                            </span><span class="na">Background=</span><span class="s">&quot;#88000000&quot;</span><span class="nt">&gt;</span>
<span class="w">                        </span><span class="nt">&lt;TextBlock</span><span class="w"> </span><span class="na">VerticalAlignment=</span><span class="s">&quot;Center&quot;</span>
<span class="w">                                   </span><span class="na">Foreground=</span><span class="s">&quot;White&quot;</span>
<span class="w">                                   </span><span class="na">Text=</span><span class="s">&quot;{x:Bind Title}&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">                    </span><span class="nt">&lt;/Border&gt;</span>
<span class="w">                </span><span class="nt">&lt;/Grid&gt;</span>
<span class="w">            </span><span class="nt">&lt;/DataTemplate&gt;</span>
<span class="w">        </span><span class="nt">&lt;/GridView.ItemTemplate&gt;</span>
<span class="w">        </span><span class="nt">&lt;GridView.GroupStyle&gt;</span>
<span class="w">            </span><span class="nt">&lt;GroupStyle&gt;</span>
<span class="w">                </span><span class="nt">&lt;GroupStyle.HeaderTemplate&gt;</span>
<span class="w">                    </span><span class="nt">&lt;DataTemplate</span><span class="w"> </span><span class="na">x:DataType=</span><span class="s">&quot;models:RecipeGroup&quot;</span><span class="nt">&gt;</span>
<span class="w">                        </span><span class="nt">&lt;TextBlock</span><span class="w"> </span><span class="na">Margin=</span><span class="s">&quot;0&quot;</span>
<span class="w">                                   </span><span class="na">Style=</span><span class="s">&quot;{ThemeResource TitleTextBlockStyle}&quot;</span>
<span class="w">                                   </span><span class="na">Text=</span><span class="s">&quot;{x:Bind Title}&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">                    </span><span class="nt">&lt;/DataTemplate&gt;</span>
<span class="w">                </span><span class="nt">&lt;/GroupStyle.HeaderTemplate&gt;</span>
<span class="w">            </span><span class="nt">&lt;/GroupStyle&gt;</span>
<span class="w">        </span><span class="nt">&lt;/GridView.GroupStyle&gt;</span>
<span class="w">    </span><span class="nt">&lt;/controls:AdaptiveGridView&gt;</span>
<span class="nt">&lt;/Grid&gt;</span>
</code></pre></div>
<p>Nehmen wir den folgenden Namespace (hier befinden sich unsere Modellklassen) auf:</p>
<div class="highlight"><pre><span></span><code>`xmlns:models=&quot;using:MvvmLab.Core.Models&quot;`
</code></pre></div>
<p><strong>Probieren wir die App aus!</strong> Achten Sie darauf, dass die Rezeptgruppen auf der Hauptseite erscheinen.</p>
<h2 id="aufgabe-2-rezept-detailseite">Aufgabe 2. - Rezept-Detailseite<a class="headerlink" href="#aufgabe-2-rezept-detailseite" title="Permanent link">&para;</a></h2>
<p>Die Erstellung der detaillierten Rezeptseite erfolgt in folgenden Schritten:</p>
<ol>
<li>Fügen wir der Schnittstelle <code>IRecipeService</code> eine Methode <code>GetRecipeAsync</code> hinzu und erstellen wir die erforderlichen Klassen</li>
<li>Erstellen wir ein Ansichtsmodell <code>RecipeDetailPageViewModel</code>, in dem wir die Rezeptdaten in <code>RecipeDetailPageViewModel</code> über <code>IRecipeService</code> abfragen (die VM erhält die ID bei der Navigation)</li>
<li>Erstellen wir die Ansicht <code>RecipeDetailPage</code>, die auf den Daten des ViewModel aufbaut</li>
<li>Registrieren wir das ViewModel und View für Dependency Injection Konfiguration und Navigation</li>
<li>Navigieren wir von <code>MainPageViewModel</code> zu <code>RecipeDetailPage</code> durch <code>INavigationService</code>, falls es auf das Rezept angeklickt wird und die ID des ausgewählten Rezepts wird an die Detailseite übergegeben</li>
</ol>
<h3 id="21-abfrage-eines-rezepts">2.1 Abfrage eines Rezepts<a class="headerlink" href="#21-abfrage-eines-rezepts" title="Permanent link">&para;</a></h3>
<p>Erstellen wir die Klasse <code>Recipe</code> im Namensraum <code>MvvmLab.Core.Model</code> und generieren wir ihren Inhalt aus den JSON-Beispieldaten, die vom Endpunkt <code>/api/recipes/{id}</code> zurückgegeben werden, unter Verwendung der oben beschriebenen Methode (Paste special).</p>
<div class="highlight"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">Recipe</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">Id</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">BackgroundImage</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">Title</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="kt">string</span><span class="p">[]</span><span class="w"> </span><span class="n">ExtraImages</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="kt">string</span><span class="p">[]</span><span class="w"> </span><span class="n">Ingredients</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">Directions</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="n">Comment</span><span class="p">[]</span><span class="w"> </span><span class="n">Comments</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">Comment</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">Name</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">Text</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Während des "Paste Special" ist es wichtig, ein Rezept in die Zwischenablage zu legen, das einen Kommentar enthält (andernfalls wird die Klasse <code>Comment</code> nicht erzeugt, und die Klasse <code>Recipe</code> erzeugt den Typ <code>object[]</code> des Typs <code>Comments</code>). Es lohnt sich, das Beispiel aus dem Feld "Example value" der Swagger-Beschreibung in die Zwischenablage zu kopieren!</p>
</div>
<p>Die Schnittstelle <code>IRecipeService</code> und ihre Implementierung werden mit einer Methode <code>GetRecipeAsync</code> erweitert, die ein Rezept auf der Grundlage seiner Identifizierungsnummer zurückgibt.</p>
<div class="highlight"><span class="filename">IRecipeService</span><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="n">Task</span><span class="o">&lt;</span><span class="n">Recipe</span><span class="o">&gt;</span><span class="w"> </span><span class="n">GetRecipeAsync</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="p">);</span>
</code></pre></div>
<div class="highlight"><span class="filename">RecipeService</span><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="n">Task</span><span class="o">&lt;</span><span class="n">Recipe</span><span class="o">&gt;</span><span class="w"> </span><span class="n">GetRecipeAsync</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="nn">var</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HttpClient</span><span class="p">();</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="n">client</span><span class="p">.</span><span class="n">GetFromJsonAsync</span><span class="o">&lt;</span><span class="n">Recipe</span><span class="o">&gt;</span><span class="p">(</span><span class="s">$&quot;{_baseUrl}/Recipes/{id}&quot;</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="22-rezept-detailliertes-viewmodel">2.2 Rezept detailliertes ViewModel<a class="headerlink" href="#22-rezept-detailliertes-viewmodel" title="Permanent link">&para;</a></h3>
<p>Die Erstellung eines ViewModels ist im Vergleich zur Hauptseite eine Fingerübung (wir können grundsätzlich auf seinem Muster arbeiten). Erstellen wir die Klasse <code>RecipeDetailPageViewModel</code> im Ordner <code>MvvmLab.ViewModels</code>. </p>
<p>Das ViewModel benötigt eine Klasse, die die Schnittstelle <code>IRecipeService</code> implementiert, über die es das Rezept abfragen kann. Im <code>RecipeDetailPageViewModel</code> Konstruktor wird DI verwendet, um die notwendige Abhängigkeit zu erhalten.</p>
<div class="highlight"><pre><span></span><code><span class="k">private</span><span class="w"> </span><span class="k">readonly</span><span class="w"> </span><span class="n">IRecipeService</span><span class="w"> </span><span class="n">_recipeService</span><span class="p">;</span>

<span class="k">public</span><span class="w"> </span><span class="nf">RecipeDetailPageViewModel</span><span class="p">(</span><span class="n">IRecipeService</span><span class="w"> </span><span class="n">recipeService</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">_recipeService</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">recipeService</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>Erstellen wir in <code>RecipeDetailPageViewModel</code> eine Variable des Typs <code>Recipe</code> mit dem Namen <code>_recipe</code>, in der das Rezept gespeichert werden soll. Die Variable wird mit dem Attribut <code>ObservableProperty</code> versehen, wodurch MVVM Toolkit automatisch die Eigenschaft <code>Recipe</code> in der anderen generierten partiellen Hälfte der Klasse erzeugen kann. Dies setzt voraus, dass die Klasse von der Klasse <code>ObservableObject</code> abgeleitet ist, öffentlich ist und das Schlüsselwort <code>partial</code> enthält.</p>
<div class="highlight"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="k">partial</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">RecipeDetailPageViewModel</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ObservableObject</span>
<span class="p">{</span>
<span class="w">    </span><span class="c1">// ...</span>

<span class="w">    </span><span class="na">[ObservableProperty]</span>
<span class="w">    </span><span class="k">private</span><span class="w"> </span><span class="n">Recipe</span><span class="w"> </span><span class="n">_recipe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="p">();</span>
</code></pre></div>
<p>Implementieren wir die vorbereitete Schnittstelle <code>INavigationAware</code> in <code>RecipeDetailPageViewModel</code>. Wir bereiten uns darauf vor, dass wir  die ID des Rezepts als Navigationsparameter erhalten, das wir anzeigen wollen. In der Methode <code>OnNavigatedTo</code> rufen wir das Rezept über <code>RecipeService</code> ab und speichern es in der Eigenschaft <code>Recipe</code>. </p>
<div class="highlight"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="k">partial</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">RecipeDetailPageViewModel</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ObservableObject</span><span class="p">,</span><span class="w"> </span><span class="n">INavigationAware</span>
<span class="p">{</span>
<span class="w">    </span><span class="c1">// ...</span>

<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">OnNavigatedTo</span><span class="p">(</span><span class="kt">object</span><span class="w"> </span><span class="n">parameter</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">Recipe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="n">_recipeService</span><span class="p">.</span><span class="n">GetRecipeAsync</span><span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">parameter</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">OnNavigatedFrom</span><span class="p">()</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In der Kopfzeile der Aktion <code>OnNavigatedTo</code> mussten wir das Schlüsselwort <code>async</code> verwenden, weil wir <code>await</code> in der Wurzel verwendet haben.</p>
</div>
<h3 id="23-rezeptdetailseite-navigation">2.3 Rezeptdetailseite, Navigation<a class="headerlink" href="#23-rezeptdetailseite-navigation" title="Permanent link">&para;</a></h3>
<p>Erstellen wir eine neue Seite mit dem Namen <code>RecipeDetailPage</code> im Ordner <code>Views</code> (<em>Rechtsklick auf den Ordner Views / Add New Item / Blank Page (WinUI 3)</em>), auf der wir das Rezept anzeigen können. Zeigen wir zunächst nur den Titel des Rezepts in einer <code>TextBlock</code> an.</p>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;Grid</span><span class="w"> </span><span class="na">x:Name=</span><span class="s">&quot;ContentArea&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Grid.RowDefinitions&gt;</span>
<span class="w">        </span><span class="nt">&lt;RowDefinition</span><span class="w"> </span><span class="na">Height=</span><span class="s">&quot;48&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;RowDefinition</span><span class="w"> </span><span class="na">Height=</span><span class="s">&quot;*&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/Grid.RowDefinitions&gt;</span>

<span class="w">    </span><span class="nt">&lt;TextBlock</span><span class="w"> </span><span class="na">Grid.Row=</span><span class="s">&quot;0&quot;</span>
<span class="w">               </span><span class="na">Style=</span><span class="s">&quot;{StaticResource PageTitleStyle}&quot;</span>
<span class="w">               </span><span class="na">Text=</span><span class="s">&quot;{x:Bind ViewModel.Recipe.Title, Mode=OneWay}&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="nt">&lt;/Grid&gt;</span>
</code></pre></div>
<p>Zu der Datenverbingung fügen wir die Eigenschaft <code>ViewModel</code> in <code>RecipeDetailPage.xaml.cs</code> zur Hauptseite hinzu.</p>
<div class="highlight"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="n">RecipeDetailPageViewModel</span><span class="w"> </span><span class="n">ViewModel</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">RecipeDetailPageViewModel</span><span class="p">)</span><span class="n">DataContext</span><span class="p">;</span>
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Übersetzungsfehler</p>
<p>Wenn Sie aus irgendeinem Grund exotische Fehler erhalten, nachdem Sie eine neue Seite hinzugefügt haben, löschen Sie die folgenden Zeilen in der Projektdatei:</p>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;ItemGroup&gt;</span>
<span class="w">    </span><span class="nt">&lt;None</span><span class="w"> </span><span class="na">Remove=</span><span class="s">&quot;ViewsRecipeDetailPage.xaml&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ItemGroup&gt;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;Page</span><span class="w"> </span><span class="na">Update=</span><span class="s">&quot;ViewsRecipeDetailPage.xaml&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Generator&gt;</span>MSBuild:Compile<span class="nt">&lt;/Generator&gt;</span>
<span class="nt">&lt;/Page&gt;</span>
</code></pre></div>
</div>
<p>Um die Navigation zu unterstützen, registrieren wir <code>RecipeDetailPage</code> in <code>PageService</code> im Ordner <code>Services</code> in den folgenden 3 Schritten:</p>
<ol>
<li>
<p>Nehmen wir den Ansichtsschlüssel in die Klasse <code>Pages</code> auf.</p>
<div class="highlight"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">Pages</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">Main</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Main&quot;</span><span class="p">;</span>
<span class="hll"><span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">Detail</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Detail&quot;</span><span class="p">;</span>
</span><span class="p">}</span>
</code></pre></div>
</li>
<li>
<p>Registrieren wir die Ansicht und ViewModel-Verbindung in <code>PageService</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="nf">PageService</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">Configure</span><span class="o">&lt;</span><span class="n">MainPageViewModel</span><span class="p">,</span><span class="w"> </span><span class="n">MainPage</span><span class="o">&gt;</span><span class="p">(</span><span class="n">Pages</span><span class="p">.</span><span class="n">Main</span><span class="p">);</span>
<span class="hll"><span class="w">    </span><span class="n">Configure</span><span class="o">&lt;</span><span class="n">RecipeDetailPageViewModel</span><span class="p">,</span><span class="w"> </span><span class="n">RecipeDetailPage</span><span class="o">&gt;</span><span class="p">(</span><span class="n">Pages</span><span class="p">.</span><span class="n">Detail</span><span class="p">);</span>
</span><span class="p">}</span>
</code></pre></div>
</li>
<li>
<p>In der Datei <code>App.xaml.cs</code> registrieren wir das ViewModel und den View im Dependency Injection Container in der Methode <code>ConfigureServices</code>. </p>
<div class="highlight"><pre><span></span><code><span class="n">services</span><span class="p">.</span><span class="n">AddTransient</span><span class="o">&lt;</span><span class="n">RecipeDetailPage</span><span class="o">&gt;</span><span class="p">();</span>
<span class="n">services</span><span class="p">.</span><span class="n">AddTransient</span><span class="o">&lt;</span><span class="n">RecipeDetailPageViewModel</span><span class="o">&gt;</span><span class="p">();</span>
</code></pre></div>
</li>
</ol>
<p>Diese werden benötigt, weil die <code>INavigationService</code> in der Projektvorlage die Ansichten grundsätzlich mit einem Schlüssel identifiziert, so dass das ViewModel den Ansichtstyp nicht kennen muss. Und anhand des Schlüssels kann man genau herausfinden, welche View angezeigt und welches ViewModel in der View <code>DataContext</code> aus dem DI-Container instanziiert werden soll.</p>
<p>In das <code>MainPageViewModel</code> injektieren wir den <code>INavigationService</code>, über den wir zur <code>RecipeDetailPage</code> navigieren werden.</p>
<div class="highlight"><pre><span></span><code><span class="k">private</span><span class="w"> </span><span class="k">readonly</span><span class="w"> </span><span class="n">INavigationService</span><span class="w"> </span><span class="n">_navigationService</span><span class="p">;</span>

<span class="k">public</span><span class="w"> </span><span class="nf">MainPageViewModel</span><span class="p">(</span><span class="n">IRecipeService</span><span class="w"> </span><span class="n">recipeService</span><span class="p">,</span><span class="w"> </span><span class="n">INavigationService</span><span class="w"> </span><span class="n">navigationService</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">_recipeService</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">recipeService</span><span class="p">;</span>
<span class="w">    </span><span class="n">_navigationService</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">navigationService</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<h4 id="command">Command<a class="headerlink" href="#command" title="Permanent link">&para;</a></h4>
<p>Bisher haben wir uns mit einem Aspekt des MVVM-Musters beschäftigt: wie die View auf die Daten im ViewModel zugreift und diese anzeigt, indem sie Daten bindet. Gleichzeitig besteht in der Regel eine weitere Beziehung zwischen View und ViewModel: Hier geht es darum, wie sich Ereignisse in der View (z.B. Klicks) auf das ViewModel auswirken. Damit werden wir uns jetzt befassen.</p>
<p>In unserem Fall müssen wir zum Beispiel dafür sorgen, dass ein Klick auf ein Rezept in der Hauptseitenansicht zu <code>MainPageViewModel</code> führt und dann zur Detailansicht dieses Rezepts navigiert.</p>
<p>Das ViewModel veröffentlicht die ausführbaren Operationen im MVVM-Muster durch Objekte, die typischerweise die Schnittstelle <code>ICommand</code> implementieren (die neben der Ausführung der spezifischen Operation auch die Bedingungen für die Ausführung der Operation verwalten können).</p>
<p>Erstellen wir unter <code>MainPageViewModel</code> einen Command, der ausgeführt wird, wenn wir auf das Rezept klicken. Der Command erhält die Kopfzeile des ausgewählten Rezepts als Parameter und wird an <code>RecipeDetailPage</code> weitergeleitet, wo die ID des ausgewählten Rezepts übergeben wird.</p>
<p>Jetzt sollten wir eine Klasse erstellen, die die Schnittstelle <code>ICommand</code> implementiert, und dann eine Instanz (Eigenschaft) davon in das ViewModel aufnehmen. Diese beiden Schritte werden durch das MVVM-Toolkit vereinfacht, wir müssen nur eine Funktion mit dem Attribut <code>[RelayCommand]</code> zum ViewModel hinzufügen:</p>
<div class="highlight"><pre><span></span><code><span class="na">[RelayCommand]</span>
<span class="k">private</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">RecipeSelected</span><span class="p">(</span><span class="n">RecipeHeader</span><span class="w"> </span><span class="n">recipe</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">_navigationService</span><span class="p">.</span><span class="n">NavigateTo</span><span class="p">(</span><span class="n">Pages</span><span class="p">.</span><span class="n">Detail</span><span class="p">,</span><span class="w"> </span><span class="n">recipe</span><span class="p">.</span><span class="n">Id</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>Dies veranlasst den Compiler, die Commandsklasse und die Eigenschaft im ViewModel als <code>RecipeSelectedCommand</code> zu generieren.</p>
<p><img alt="❗" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2757.svg" title=":exclamation:" /> Der Befehl und das ViewModel sind vorbereitet, aber die View weiß noch nichts über den Befehl. Unser Befehl im ViewModel muss mit den üblichen Techniken an das entsprechende Ereignis in der View gebunden werden. Verwenden wir für MVVM immer das Command-Muster wie dieses! Das Schöne an diesem Ansatz ist, dass er vollständig mit der standardmäßigen direktionalen Datenverbindung von View-&gt;ViewModel durchgeführt wird (die wir bereits mehrfach verwendet haben).</p>
<p>Binden wir daher auf <code>MainPage</code> die Eigenschaft <code>AdaptiveGridView</code> <code>ItemClickCommand</code> an <code>RecipeSelectedCommand</code>.</p>
<div class="highlight"><pre><span></span><code>ItemClickCommand=&quot;{x:Bind<span class="w"> </span>ViewModel.RecipeSelectedCommand}&quot;
</code></pre></div>
<p><strong>Probieren wir die App aus!</strong> Klicken wir auf die Rezepte, um die Rezeptdetailseite zu sehen.</p>
<details class="tip">
<summary>Ausblick: Gibt es keinen Befehl für das Ereignis, das Sie verwenden möchten?</summary>
<p>Wenn der Controller einen Befehl für bestimmte Ereignisse bereitstellt, ist dies relativ einfach zu bewerkstelligen, wie im obigen Beispiel gezeigt.
Wenn das Steuerelement jedoch keinen Befehl bereitstellt (z.B. das eingebaute <code>GridView.ItemClicked</code>), haben wir mehrere Möglichkeiten:</p>
<ol>
<li>
<p><strong>Code-Behind "Klebercode":</strong> Behandeln Sie das Ereignis des Controllers und rufen Sie die entsprechende Methode/Befehl des Code-Behind im ViewModel (xaml.cs) auf.</p>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;controls:AdaptiveGridView</span><span class="w"> </span><span class="na">x:Name=</span><span class="s">&quot;gridView&quot;</span>
<span class="w">                            </span><span class="na">ItemsSource=</span><span class="s">&quot;{x:Bind RecipeGroupsCollectionSource.View, Mode=OneWay}&quot;</span>
<span class="w">                            </span><span class="na">IsItemClickEnabled=</span><span class="s">&quot;True&quot;</span>
<span class="w">                            </span><span class="na">ItemClick=</span><span class="s">&quot;GridView_ItemClick&quot;</span><span class="nt">&gt;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="k">private</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">GridView_ItemClick</span><span class="p">(</span><span class="kt">object</span><span class="w"> </span><span class="n">sender</span><span class="p">,</span><span class="w"> </span><span class="n">ItemClickEventArgs</span><span class="w"> </span><span class="n">e</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">ViewModel</span><span class="p">.</span><span class="n">RecipeSelectedCommand</span><span class="p">.</span><span class="n">Execute</span><span class="p">((</span><span class="n">RecipeHeader</span><span class="p">)</span><span class="n">e</span><span class="p">.</span><span class="n">ClickedItem</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</li>
<li>
<p><strong>x:Bind-Ereignisbindung</strong>: Verwenden Sie die Bindungsoption der Methode <code>x:Bind</code>, um das Ereignis des Steuerelements an die <strong>Methode</strong> im ViewModel zu binden.
   Die Methode muss dann entweder parameterlos sein oder einen Parameter annehmen, der der Signatur des Ereignisses entspricht.</p>
<div class="highlight"><span class="filename">View - MainPage.xaml</span><pre><span></span><code><span class="nt">&lt;controls:AdaptiveGridView</span><span class="w"> </span><span class="na">x:Name=</span><span class="s">&quot;gridView&quot;</span>
<span class="w">                            </span><span class="na">ItemsSource=</span><span class="s">&quot;{x:Bind RecipeGroupsCollectionSource.View, Mode=OneWay}&quot;</span>
<span class="w">                            </span><span class="na">IsItemClickEnabled=</span><span class="s">&quot;True&quot;</span>
<span class="w">                            </span><span class="na">ItemClick=</span><span class="s">&quot;{x:Bind ViewModel.RecipeSelected&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;/controls:AdaptiveGridView&gt;</span>
</code></pre></div>
<div class="highlight"><span class="filename">ViewModel - MainPageViewModel</span><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">RecipeSelected</span><span class="p">(</span><span class="kt">object</span><span class="w"> </span><span class="n">sender</span><span class="p">,</span><span class="w"> </span><span class="n">ItemClickEventArgs</span><span class="w"> </span><span class="n">e</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="p">...</span>
<span class="p">}</span>
</code></pre></div>
<p>Der Nachteil dieser Methode ist, dass sie die Framework-Abhängigkeiten des View (Eventhandler-Parametertypen) mit den Ereignisparametern in das ViewModel einführt, obwohl die Idee war, das ViewModel unabhängig von der View zu machen. Natürlich kann diese Methode auch gut funktionieren, wenn wir die strikte Einhaltung des MVVM-Musters teilweise aufgeben.</p>
</li>
<li>
<p>Mit Hilfe von Behavior, ganz konkret <code>EventTriggerBehavior</code> und <code>InvokeCommandAction</code> Klassen, können Sie einen Command an ein Ereignis eines beliebigen Steuererelementes binden.</p>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;controls:AdaptiveGridView</span><span class="w"> </span><span class="na">x:Name=</span><span class="s">&quot;gridView&quot;</span>
<span class="w">                            </span><span class="na">ItemsSource=</span><span class="s">&quot;{x:Bind RecipeGroupsCollectionSource.View, Mode=OneWay}&quot;</span>
<span class="w">                            </span><span class="na">IsItemClickEnabled=</span><span class="s">&quot;True&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;i:Interaction.Behaviors&gt;</span>
<span class="w">        </span><span class="nt">&lt;c:EventTriggerBehavior</span><span class="w"> </span><span class="na">EventName=</span><span class="s">&quot;ItemClick&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;c:InvokeCommandAction</span><span class="w"> </span><span class="na">Command=</span><span class="s">&quot;{x:Bind ViewModel.RecipeSelectedCommand}&quot;</span><span class="w"> </span>
<span class="w">                                   </span><span class="na">InputConverter=</span><span class="s">&quot;{StaticResource ItemClickedInputConverter}&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;/c:EventTriggerBehavior&gt;</span>
<span class="w">    </span><span class="nt">&lt;/i:Interaction.Behaviors&gt;</span>
</code></pre></div>
<p>Dies ermöglicht es uns, die Ansicht fast vollständig deklarativ zu gestalten, aber wir müssen immer noch eine Klasse <code>ItemClickedInputConverter</code> erstellen, die die Ereignisparameter mithilfe der Schnittstelle <code>IValueConverter</code> in den entsprechenden Typ umwandelt.</p>
<div class="highlight"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">ItemClickedInputConverter</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">IValueConverter</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="kt">object</span><span class="w"> </span><span class="nf">Convert</span><span class="p">(</span><span class="kt">object</span><span class="w"> </span><span class="k">value</span><span class="p">,</span><span class="w"> </span><span class="n">Type</span><span class="w"> </span><span class="n">targetType</span><span class="p">,</span><span class="w"> </span><span class="kt">object</span><span class="w"> </span><span class="n">parameter</span><span class="p">,</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">language</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">RecipeHeader</span><span class="p">)((</span><span class="k">value</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">ItemClickEventArgs</span><span class="p">)</span><span class="o">?.</span><span class="n">ClickedItem</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="kt">object</span><span class="w"> </span><span class="nf">ConvertBack</span><span class="p">(</span><span class="kt">object</span><span class="w"> </span><span class="k">value</span><span class="p">,</span><span class="w"> </span><span class="n">Type</span><span class="w"> </span><span class="n">targetType</span><span class="p">,</span><span class="w"> </span><span class="kt">object</span><span class="w"> </span><span class="n">parameter</span><span class="p">,</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">language</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">NotImplementedException</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Behaviors sind in der XAML-Welt weit verbreiteter Mechanismus, um wiederverwendbare Verhaltensweisen zu Views hinzuzufügen (weitere Informationen <a href="https://github.com/Microsoft/XamlBehaviors">hier</a>).</p>
</li>
</ol>
</details>
<h3 id="24-rezept-detailansicht">2.4 Rezept-Detailansicht<a class="headerlink" href="#24-rezept-detailansicht" title="Permanent link">&para;</a></h3>
<p>Um die Details des Rezepts anzuzeigen, verwenden wir eine <code>Grid</code> mit zwei Spalten. Legen wir in die erste Spalte ein <code>ScrollViewer</code>, in das ein <code>StackPanel</code> eingefügt wird. Legen wir auf <code>StackPanel</code> eine <code>FlipView</code>, an der die Bilder des Rezepts angezeigt werden sollen.  <code>FlipView</code> funktioniert wie eine Liste, zeigt aber ihre Elemente in einer blätterbaren Oberfläche an.</p>
<p>Unter <code>FlipView</code> finden wir <code>ItemsControl</code> (eine einfache Liste, die kein Scrollen, Auswählen, Anklicken usw. unterstützt), in der die Zutaten des Rezepts angezeigt werden.</p>
<p>Darunter befindet sich eine <code>TextBlock</code>, die die Schritte zur Zubereitung des Rezepts enthält.</p>
<p>In der zweiten Spalte platzieren wir ein <code>Grid</code>, wo die Liste der Kommentare und ihre Eingabefelder platziert werden.</p>
<p>Wir können den folgenden Code während des Praktikums auf <code>RecipeDetailPage.xaml</code> kopieren. Dieser Code ist im Vergleich zu den vorherigen nicht neu.</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;</span>
<span class="nt">&lt;Page</span><span class="w"> </span><span class="na">x:Class=</span><span class="s">&quot;MvvmLab.Views.RecipeDetailPage&quot;</span>
<span class="w">      </span><span class="na">xmlns=</span><span class="s">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span>
<span class="w">      </span><span class="na">xmlns:x=</span><span class="s">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span>
<span class="w">      </span><span class="na">xmlns:d=</span><span class="s">&quot;http://schemas.microsoft.com/expression/blend/2008&quot;</span>
<span class="w">      </span><span class="na">xmlns:local=</span><span class="s">&quot;using:MvvmLab.Views&quot;</span>
<span class="w">      </span><span class="na">xmlns:mc=</span><span class="s">&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot;</span>
<span class="w">      </span><span class="na">xmlns:models=</span><span class="s">&quot;using:MvvmLab.Core.Models&quot;</span>
<span class="w">      </span><span class="na">Background=</span><span class="s">&quot;{ThemeResource ApplicationPageBackgroundThemeBrush}&quot;</span>
<span class="w">      </span><span class="na">mc:Ignorable=</span><span class="s">&quot;d&quot;</span><span class="nt">&gt;</span>

<span class="w">    </span><span class="nt">&lt;Grid</span><span class="w"> </span><span class="na">x:Name=</span><span class="s">&quot;ContentArea&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;Grid.RowDefinitions&gt;</span>
<span class="w">            </span><span class="nt">&lt;RowDefinition</span><span class="w"> </span><span class="na">Height=</span><span class="s">&quot;Auto&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;RowDefinition</span><span class="w"> </span><span class="na">Height=</span><span class="s">&quot;*&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;/Grid.RowDefinitions&gt;</span>

<span class="w">        </span><span class="nt">&lt;TextBlock</span><span class="w"> </span><span class="na">Grid.Row=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">Padding=</span><span class="s">&quot;10&quot;</span>
<span class="w">                   </span><span class="na">Style=</span><span class="s">&quot;{StaticResource TitleTextBlockStyle}&quot;</span>
<span class="w">                   </span><span class="na">Text=</span><span class="s">&quot;{x:Bind ViewModel.Recipe.Title, Mode=OneWay}&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>

<span class="w">        </span><span class="nt">&lt;Grid</span><span class="w"> </span><span class="na">Grid.Row=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;Grid.ColumnDefinitions&gt;</span>
<span class="w">                </span><span class="nt">&lt;ColumnDefinition</span><span class="w"> </span><span class="na">Width=</span><span class="s">&quot;3*&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">                </span><span class="nt">&lt;ColumnDefinition</span><span class="w"> </span><span class="na">Width=</span><span class="s">&quot;*&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;/Grid.ColumnDefinitions&gt;</span>

<span class="w">            </span><span class="nt">&lt;ScrollViewer</span><span class="w"> </span><span class="na">Grid.Column=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">Padding=</span><span class="s">&quot;20 10 0 20&quot;</span><span class="nt">&gt;</span>
<span class="w">                </span><span class="nt">&lt;StackPanel</span><span class="w"> </span><span class="na">Orientation=</span><span class="s">&quot;Vertical&quot;</span><span class="nt">&gt;</span>
<span class="w">                    </span><span class="nt">&lt;StackPanel</span><span class="w"> </span><span class="na">x:Name=</span><span class="s">&quot;images&quot;</span>
<span class="w">                                </span><span class="na">Margin=</span><span class="s">&quot;0,0,24,0&quot;</span>
<span class="w">                                </span><span class="na">Orientation=</span><span class="s">&quot;Vertical&quot;</span><span class="nt">&gt;</span>
<span class="w">                        </span><span class="nt">&lt;TextBlock</span><span class="w"> </span><span class="na">Margin=</span><span class="s">&quot;0,0,0,12&quot;</span>
<span class="w">                                   </span><span class="na">Style=</span><span class="s">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span>
<span class="w">                                   </span><span class="na">Text=</span><span class="s">&quot;Images&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">                        </span><span class="nt">&lt;FlipView</span><span class="w"> </span><span class="na">x:Name=</span><span class="s">&quot;flipView&quot;</span>
<span class="w">                                  </span><span class="na">MaxHeight=</span><span class="s">&quot;250&quot;</span>
<span class="w">                                  </span><span class="na">VerticalAlignment=</span><span class="s">&quot;Top&quot;</span>
<span class="w">                                  </span><span class="na">ItemsSource=</span><span class="s">&quot;{x:Bind ViewModel.Recipe.ExtraImages, Mode=OneWay}&quot;</span><span class="nt">&gt;</span>
<span class="w">                            </span><span class="nt">&lt;FlipView.ItemTemplate&gt;</span>
<span class="w">                                </span><span class="nt">&lt;DataTemplate&gt;</span>
<span class="w">                                    </span><span class="nt">&lt;Image</span><span class="w"> </span><span class="na">Source=</span><span class="s">&quot;{Binding}&quot;</span><span class="w"> </span><span class="na">Stretch=</span><span class="s">&quot;Uniform&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">                                </span><span class="nt">&lt;/DataTemplate&gt;</span>
<span class="w">                            </span><span class="nt">&lt;/FlipView.ItemTemplate&gt;</span>
<span class="w">                        </span><span class="nt">&lt;/FlipView&gt;</span>
<span class="w">                    </span><span class="nt">&lt;/StackPanel&gt;</span>

<span class="w">                    </span><span class="nt">&lt;StackPanel</span><span class="w"> </span><span class="na">x:Name=</span><span class="s">&quot;ingredients&quot;</span>
<span class="w">                                </span><span class="na">Margin=</span><span class="s">&quot;0,0,24,0&quot;</span>
<span class="w">                                </span><span class="na">Orientation=</span><span class="s">&quot;Vertical&quot;</span><span class="nt">&gt;</span>
<span class="w">                        </span><span class="nt">&lt;TextBlock</span><span class="w"> </span><span class="na">Margin=</span><span class="s">&quot;0,0,0,12&quot;</span>
<span class="w">                                   </span><span class="na">Style=</span><span class="s">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span>
<span class="w">                                   </span><span class="na">Text=</span><span class="s">&quot;Ingredients&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">                        </span><span class="nt">&lt;ItemsControl</span><span class="w"> </span><span class="na">HorizontalAlignment=</span><span class="s">&quot;Left&quot;</span><span class="w"> </span><span class="na">ItemsSource=</span><span class="s">&quot;{x:Bind ViewModel.Recipe.Ingredients, Mode=OneWay}&quot;</span><span class="nt">&gt;</span>
<span class="w">                            </span><span class="nt">&lt;ItemsControl.ItemTemplate&gt;</span>
<span class="w">                                </span><span class="nt">&lt;DataTemplate&gt;</span>
<span class="w">                                    </span><span class="nt">&lt;TextBlock</span><span class="w"> </span><span class="na">Margin=</span><span class="s">&quot;0,0,0,10&quot;</span>
<span class="w">                                               </span><span class="na">Text=</span><span class="s">&quot;{Binding}&quot;</span>
<span class="w">                                               </span><span class="na">TextWrapping=</span><span class="s">&quot;Wrap&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">                                </span><span class="nt">&lt;/DataTemplate&gt;</span>
<span class="w">                            </span><span class="nt">&lt;/ItemsControl.ItemTemplate&gt;</span>
<span class="w">                        </span><span class="nt">&lt;/ItemsControl&gt;</span>
<span class="w">                    </span><span class="nt">&lt;/StackPanel&gt;</span>

<span class="w">                    </span><span class="nt">&lt;StackPanel</span><span class="w"> </span><span class="na">x:Name=</span><span class="s">&quot;directions&quot;</span>
<span class="w">                                </span><span class="na">Margin=</span><span class="s">&quot;0,0,24,0&quot;</span>
<span class="w">                                </span><span class="na">Orientation=</span><span class="s">&quot;Vertical&quot;</span>
<span class="w">                                </span><span class="na">RelativePanel.RightOf=</span><span class="s">&quot;ingredients&quot;</span><span class="nt">&gt;</span>
<span class="w">                        </span><span class="nt">&lt;TextBlock</span><span class="w"> </span><span class="na">Margin=</span><span class="s">&quot;0,0,0,12&quot;</span>
<span class="w">                                   </span><span class="na">Style=</span><span class="s">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span>
<span class="w">                                   </span><span class="na">Text=</span><span class="s">&quot;Directions&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">                        </span><span class="nt">&lt;TextBlock</span><span class="w"> </span><span class="na">HorizontalAlignment=</span><span class="s">&quot;Left&quot;</span>
<span class="w">                                   </span><span class="na">Text=</span><span class="s">&quot;{x:Bind ViewModel.Recipe.Directions, Mode=OneWay}&quot;</span>
<span class="w">                                   </span><span class="na">TextWrapping=</span><span class="s">&quot;Wrap&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">                    </span><span class="nt">&lt;/StackPanel&gt;</span>
<span class="w">                </span><span class="nt">&lt;/StackPanel&gt;</span>
<span class="w">            </span><span class="nt">&lt;/ScrollViewer&gt;</span>

<span class="w">            </span><span class="nt">&lt;Grid</span><span class="w"> </span><span class="na">Grid.Column=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="na">RowSpacing=</span><span class="s">&quot;12&quot;</span><span class="nt">&gt;</span>
<span class="w">                </span><span class="nt">&lt;Grid.RowDefinitions&gt;</span>
<span class="w">                    </span><span class="nt">&lt;RowDefinition</span><span class="w"> </span><span class="na">Height=</span><span class="s">&quot;Auto&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">                    </span><span class="nt">&lt;RowDefinition</span><span class="w"> </span><span class="na">Height=</span><span class="s">&quot;*&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">                    </span><span class="nt">&lt;RowDefinition</span><span class="w"> </span><span class="na">Height=</span><span class="s">&quot;Auto&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">                </span><span class="nt">&lt;/Grid.RowDefinitions&gt;</span>

<span class="w">                </span><span class="nt">&lt;TextBlock</span><span class="w"> </span><span class="na">Grid.Row=</span><span class="s">&quot;0&quot;</span>
<span class="w">                           </span><span class="na">Style=</span><span class="s">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span>
<span class="w">                           </span><span class="na">Text=</span><span class="s">&quot;Comments&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>

<span class="w">                </span><span class="nt">&lt;ListView</span><span class="w"> </span><span class="na">Grid.Row=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="na">ItemsSource=</span><span class="s">&quot;{x:Bind ViewModel.Recipe.Comments, Mode=OneWay}&quot;</span><span class="nt">&gt;</span>
<span class="w">                    </span><span class="nt">&lt;ListView.ItemTemplate&gt;</span>
<span class="w">                        </span><span class="nt">&lt;DataTemplate</span><span class="w"> </span><span class="na">x:DataType=</span><span class="s">&quot;models:Comment&quot;</span><span class="nt">&gt;</span>
<span class="w">                            </span><span class="nt">&lt;StackPanel</span><span class="w"> </span><span class="na">Orientation=</span><span class="s">&quot;Vertical&quot;</span><span class="w"> </span><span class="na">Padding=</span><span class="s">&quot;0 5 0 5&quot;</span><span class="nt">&gt;</span>
<span class="w">                                </span><span class="nt">&lt;TextBlock</span><span class="w"> </span><span class="na">FontWeight=</span><span class="s">&quot;Bold&quot;</span><span class="w"> </span><span class="na">Text=</span><span class="s">&quot;{x:Bind Name}&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">                                </span><span class="nt">&lt;TextBlock</span><span class="w"> </span><span class="na">Text=</span><span class="s">&quot;{x:Bind Text}&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">                            </span><span class="nt">&lt;/StackPanel&gt;</span>
<span class="w">                        </span><span class="nt">&lt;/DataTemplate&gt;</span>
<span class="w">                    </span><span class="nt">&lt;/ListView.ItemTemplate&gt;</span>
<span class="w">                </span><span class="nt">&lt;/ListView&gt;</span>

<span class="w">                </span><span class="nt">&lt;StackPanel</span><span class="w"> </span><span class="na">x:Name=</span><span class="s">&quot;comments&quot;</span>
<span class="w">                            </span><span class="na">Grid.Row=</span><span class="s">&quot;2&quot;</span>
<span class="w">                            </span><span class="na">Margin=</span><span class="s">&quot;24,0,24,0&quot;</span>
<span class="w">                            </span><span class="na">Orientation=</span><span class="s">&quot;Vertical&quot;</span><span class="nt">&gt;</span>
<span class="w">                    </span><span class="cm">&lt;!-- TODO input fields for comments --&gt;</span>
<span class="w">                </span><span class="nt">&lt;/StackPanel&gt;</span>
<span class="w">            </span><span class="nt">&lt;/Grid&gt;</span>
<span class="w">        </span><span class="nt">&lt;/Grid&gt;</span>
<span class="w">    </span><span class="nt">&lt;/Grid&gt;</span>
<span class="nt">&lt;/Page&gt;</span>
</code></pre></div>
<p><strong>Probieren wir die App aus!</strong></p>
<h2 id="aufgabe-3-kommentare-hinzufugen">Aufgabe 3. - Kommentare hinzufügen<a class="headerlink" href="#aufgabe-3-kommentare-hinzufugen" title="Permanent link">&para;</a></h2>
<p>Wenn wir einen engen Zeitplan haben, können wir eine Funktion zum Hinzufügen von Kommentaren auf der Rezeptdetailseite erstellen.</p>
<h3 id="webdienst">Webdienst<a class="headerlink" href="#webdienst" title="Permanent link">&para;</a></h3>
<p>Fügen wir der Schnittstelle <code>IRecipeService</code> und der Implementierung eine Methode <code>SendCommentAsync</code> hinzu, die einen Kommentar an den Server unter dem Endpunkt <code>POST /Recipes/{recipeId}/Comments</code> sendet.</p>
<div class="highlight"><span class="filename">IRecipeService</span><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="n">Task</span><span class="w"> </span><span class="nf">SendCommentAsync</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">recipeId</span><span class="p">,</span><span class="w"> </span><span class="n">Comment</span><span class="w"> </span><span class="n">comment</span><span class="p">);</span>
</code></pre></div>
<div class="highlight"><span class="filename">RecipeService</span><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="n">Task</span><span class="w"> </span><span class="nf">SendCommentAsync</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">recipeId</span><span class="p">,</span><span class="w"> </span><span class="n">Comment</span><span class="w"> </span><span class="n">comment</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="nn">var</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HttpClient</span><span class="p">();</span>
<span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="n">client</span><span class="p">.</span><span class="n">PostAsJsonAsync</span><span class="p">(</span><span class="s">$&quot;{_baseUrl}/Recipes/{recipeId}/Comments&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">comment</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="viewmodel">ViewModel<a class="headerlink" href="#viewmodel" title="Permanent link">&para;</a></h3>
<p>Erstellen wir in <code>RecipeDetailPageViewModel</code>eine Eigenschaft <code>string</code> mit dem Namen <code>NewCommentText</code> und eine Eigenschaft <code>NewCommentName</code> <code>string</code> mit dem Namen, in denen die vom Benutzer bereitgestellten Kommentarinformationen gespeichert werden sollen. Verwenden wir das Attribut <code>ObservableProperty</code>! </p>
<div class="highlight"><pre><span></span><code><span class="na">[ObservableProperty]</span>
<span class="k">private</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">_newCommentName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>

<span class="na">[ObservableProperty]</span>
<span class="k">private</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">_newCommentText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>
</code></pre></div>
<p>Erstellen wir in <code>RecipeDetailPageViewModel</code> eine Funktion namens <code>SendComment</code>, mit der der Kommentar des Benutzers an den Server gesendet werden kann. Generieren wir einen Befehl aus der Funktion mit dem MVVM Toolkit (<code>[RelayCommand]</code>).</p>
<p>Die Umsetzung ist einfach: Wir senden den Kommentar an den Server und aktualisieren dann das Rezept.</p>
<div class="highlight"><pre><span></span><code><span class="na">[RelayCommand]</span>
<span class="k">private</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="n">Task</span><span class="w"> </span><span class="nf">SendComment</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="n">_recipeService</span><span class="p">.</span><span class="n">SendCommentAsync</span><span class="p">(</span><span class="n">Recipe</span><span class="p">.</span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Comment</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">Name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NewCommentName</span><span class="p">,</span>
<span class="w">        </span><span class="n">Text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NewCommentText</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">NewCommentName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>
<span class="w">    </span><span class="n">NewCommentText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>

<span class="w">    </span><span class="n">Recipe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="n">_recipeService</span><span class="p">.</span><span class="n">GetRecipeAsync</span><span class="p">(</span><span class="n">Recipe</span><span class="p">.</span><span class="n">Id</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>Die folgenden Elemente werden in der Ansicht platziert, um Kommentare hinzuzufügen:</p>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;StackPanel</span><span class="w"> </span><span class="na">x:Name=</span><span class="s">&quot;comments&quot;</span>
<span class="w">            </span><span class="na">Grid.Row=</span><span class="s">&quot;2&quot;</span>
<span class="w">            </span><span class="na">Margin=</span><span class="s">&quot;24,0,24,0&quot;</span>
<span class="w">            </span><span class="na">Orientation=</span><span class="s">&quot;Vertical&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;TextBox</span><span class="w"> </span><span class="na">Margin=</span><span class="s">&quot;0,0,0,16&quot;</span>
<span class="w">             </span><span class="na">Header=</span><span class="s">&quot;Name&quot;</span>
<span class="w">             </span><span class="na">Text=</span><span class="s">&quot;{x:Bind ViewModel.NewCommentName, Mode=TwoWay}&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;TextBox</span><span class="w"> </span><span class="na">Margin=</span><span class="s">&quot;0,0,0,16&quot;</span>
<span class="w">             </span><span class="na">Header=</span><span class="s">&quot;Comment&quot;</span>
<span class="w">             </span><span class="na">Text=</span><span class="s">&quot;{x:Bind ViewModel.NewCommentText, Mode=TwoWay}&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Button</span><span class="w"> </span><span class="na">Margin=</span><span class="s">&quot;0,0,0,16&quot;</span>
<span class="w">            </span><span class="na">HorizontalAlignment=</span><span class="s">&quot;Right&quot;</span>
<span class="w">            </span><span class="na">Command=</span><span class="s">&quot;{x:Bind ViewModel.SendCommentCommand}&quot;</span>
<span class="w">            </span><span class="na">Content=</span><span class="s">&quot;Send&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="nt">&lt;/StackPanel&gt;</span>
</code></pre></div>
<p>Beachten wir, dass die Eigenschaft <code>Text</code> von <code>TextBox</code> an die Eigenschaften <code>NewCommentName</code> und <code>NewCommentText</code> im ViewModel mit einer bidirektionalen Bindung gebunden ist, und dass die Eigenschaft Command der Taste an die Eigenschaft <code>SendCommentCommand</code> im ViewModel gebunden ist.</p>
<h2 id="ausblick-bedingungen-fur-die-ausfuhrung-von-befehlen">Ausblick: Bedingungen für die Ausführung von Befehlen<a class="headerlink" href="#ausblick-bedingungen-fur-die-ausfuhrung-von-befehlen" title="Permanent link">&para;</a></h2>
<p>Der Befehl <code>SendCommentCommand</code> erfordert, dass die Eigenschaften <code>NewCommentName</code> und <code>NewCommentText</code> nicht leer sind. Befehle bieten die Möglichkeit, ihre Ausführung an Bedingungen zu knüpfen, die in der Methode <code>CanExecute</code> angegeben werden können. In unserem Fall müssen wir dem Attribut Command generator einen Methoden-/Eigenschaftsnamen geben, der <code>bool</code> zurückgibt.</p>
<div class="highlight"><span class="filename">RecipeDetailPageViewModel-ben:</span><pre><span></span><code><span class="k">private</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">CanExecuteSendComment</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="o">!</span><span class="kt">string</span><span class="p">.</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="n">NewCommentName</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="kt">string</span><span class="p">.</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="n">NewCommentText</span><span class="p">);</span>

<span class="na">[RelayCommand(CanExecute = nameof(CanExecuteSendComment))]</span>
<span class="k">private</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="n">Task</span><span class="w"> </span><span class="nf">SendComment</span><span class="p">()</span>
</code></pre></div>
<p><strong>Probieren wir es aus.</strong> Wir stellen fest, dass die Taste nicht aktiviert wird, aber nach der Änderung von <code>TextBox</code> ändert sich der Zustand der Taste nicht.</p>
<p>Die Methode <code>CanExecute</code> wird aufgerufen (von den Steuerelementen), wenn Command das Ereignis <code>CanExecuteChanged</code> auslöst. In unserem Fall soll dieses Ereignis ausgelöst werden, wenn das Ereignis <code>PropertyChanged</code> der Eigenschaften <code>NewCommentName</code> und <code>NewCommentText</code> ausgelöst wird. Zu diesem Zweck bietet das MVVM Toolkit ein eigenes Attribut (<code>[NotifyCanExecuteChangedFor]</code>), das zu den Eigenschaften <code>NewCommentName</code> und <code>NewCommentText</code> hinzugefügt werden muss.</p>
<p>Wenn sich also der Wert der Eigenschaft <code>NewCommentName</code> oder <code>NewCommentText</code> ändert, wird auch das Ereignis <code>SendCommentCommand</code> Befehl <code>CanExecuteChanged</code> ausgelöst, wodurch die Methode <code>CanExecute</code> erneut ausgeführt und der Zustand der Taste aktualisiert wird.</p>
<div class="highlight"><pre><span></span><code><span class="na">[ObservableProperty]</span>
<span class="na">[NotifyCanExecuteChangedFor(nameof(SendCommentCommand))]</span>
<span class="k">private</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">_newCommentName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>

<span class="na">[ObservableProperty]</span>
<span class="na">[NotifyCanExecuteChangedFor(nameof(SendCommentCommand))]</span>
<span class="k">private</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">_newCommentText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>
</code></pre></div>
<p><strong>Probieren wir es aus.</strong></p>
<p>Es gibt nur noch eine Sache: Derzeit ändert sich der Zustand von <code>TextBox</code> nur, wenn der Benutzer <code>TextBox</code> verlässt. Dieses Verhalten kann über die Eigenschaft <code>UpdateSourceTrigger</code> der Datenverbindung geändert werden.</p>
<div class="highlight"><pre><span></span><code>Text=&quot;{x:Bind<span class="w"> </span>ViewModel.NewCommentName,<span class="w"> </span>Mode=TwoWay,<span class="w"> </span>UpdateSourceTrigger=PropertyChanged}&quot;

Text=&quot;{x:Bind<span class="w"> </span>ViewModel.NewCommentText,<span class="w"> </span>Mode=TwoWay,<span class="w"> </span>UpdateSourceTrigger=PropertyChanged}&quot;
</code></pre></div>
<p><strong>Probieren wir es aus.</strong></p>
<hr>
<div class="md-source-file">
  <span class="md-source-file__fact"> <span class="md-icon" title="Utolsó frissítés"> <svg
        xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
        <path
          d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z">
        </path>
      </svg>
    </span>
    <span title="2025. március 7. 11:48:58">
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago" title="2025. március 7. 11:48:58"><span class="timeago" datetime="2025-03-07T11:48:58+01:00" locale="hu"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="2025. március 7. 11:48:58">2025-03-07</span>
    </span>
  </span>

  

  <span class="md-source-file__fact">
    <span class="md-icon" title="Szerzők">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
        <path
          d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2Z">
        </path>
      </svg>
    </span>
    <span>Szerzők</span>
    <nav><a href="https://github.com/bzolka" target="_blank" rel="noopener noreferrer" class="md-author" title="@Zoltán Benedek">
        <img src="https://avatars.githubusercontent.com/u/22932444?u=a3e164177137cbef68f0e72985785b0795ac7565&v=4?size=72" alt="@Zoltán Benedek">
      </a><a href="https://github.com/szucscintialia" target="_blank" rel="noopener noreferrer" class="md-author" title="@Cintia Szücs">
        <img src="https://avatars.githubusercontent.com/u/26093637?v=4?size=72" alt="@Cintia Szücs">
      </a></nav>      
  </span>
</div>




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Vissza a tetejére
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; BME VIK AUT
    </div>
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.instant", "navigation.top", "search.suggest", "content.action.edit", "toc.follow"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "V\u00e1g\u00f3lapra m\u00e1solva", "clipboard.copy": "M\u00e1sol\u00e1s v\u00e1g\u00f3lapra", "search.result.more.one": "1 tov\u00e1bbi tal\u00e1lat az oldalon", "search.result.more.other": "# tov\u00e1bbi tal\u00e1lat az oldalon", "search.result.none": "Nincs tal\u00e1lat", "search.result.one": "1 egyez\u0151 dokumentum", "search.result.other": "# egyez\u0151 dokumentum", "search.result.placeholder": "Keres\u00e9shez \u00edrj ide valamit", "search.result.term.missing": "\u00dcres", "select.version": "Verzi\u00f3v\u00e1lt\u00e1s"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.8fd75fb4.min.js"></script>
      
        <script src="../../../js/timeago.min.js"></script>
      
        <script src="../../../js/timeago_mkdocs_material.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>