
<!doctype html>
<html lang="hu" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Benedek Zoltán">
      
      
        <link rel="canonical" href="https://bmeviauab00.github.io/szoftvertechnikak/2024/labor/old-5-mvvm/">
      
      
      
      
      <link rel="icon" href="../../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.9">
    
    
      
        <title>5. MVVM - BMEVIAUAB00 Szoftvertechnikák</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.f2e4d321.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/timeago.css">
    
      <link rel="stylesheet" href="../../extra-material-theme.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="aut" data-md-color-primary="aut" data-md-color-accent="red">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#5-mvvm" class="md-skip">
          Kihagyás
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Élőfej">
    <a href="../.." title="BMEVIAUAB00 Szoftvertechnikák" class="md-header__button md-logo" aria-label="BMEVIAUAB00 Szoftvertechnikák" data-md-component="logo">
      
  <img src="../../img/logo-bme-aut.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            BMEVIAUAB00 Szoftvertechnikák
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              5. MVVM
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="aut" data-md-color-primary="aut" data-md-color-accent="red"  aria-label="Váltás sötét témára"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Váltás sötét témára" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="red" data-md-color-accent="indigo"  aria-label="Váltás világos témára"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Váltás világos témára" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Keresés" placeholder="Keresés" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Keresés">
        
        <button type="reset" class="md-search__icon md-icon" title="Törlés" aria-label="Törlés" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Keresés inicializálása
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/bmeviauab00/szoftvertechnikak" title="Főoldalra ugrás" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    bmeviauab00/szoftvertechnikak
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Lapok" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Szoftvertechnikák (2024-től)

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../1-model-es-kod-kapcsolata/" class="md-tabs__link">
          
  
  Laborok

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../hazi/" class="md-tabs__link">
          
  
  Önálló/házi feladatok

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../1-model-es-kod-kapcsolata/index_eng/" class="md-tabs__link">
          
  
  English course labs

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../hazi/index_eng/" class="md-tabs__link">
          
  
  Homework

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../1-model-es-kod-kapcsolata/index_ger/" class="md-tabs__link">
          
  
  Deutschkurs-Labore

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../hazi/meghirdetes-elott_ger/" class="md-tabs__link">
          
  
  Hausaufgaben

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigáció" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="BMEVIAUAB00 Szoftvertechnikák" class="md-nav__button md-logo" aria-label="BMEVIAUAB00 Szoftvertechnikák" data-md-component="logo">
      
  <img src="../../img/logo-bme-aut.png" alt="logo">

    </a>
    BMEVIAUAB00 Szoftvertechnikák
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/bmeviauab00/szoftvertechnikak" title="Főoldalra ugrás" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    bmeviauab00/szoftvertechnikak
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Szoftvertechnikák (2024-től)
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Laborok
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Laborok
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1-model-es-kod-kapcsolata/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. A modell és a kód kapcsolata
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2-nyelvi-eszkozok/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. Nyelvi eszközök
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3-felhasznaloi-felulet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. A felhasználói felület kialakítása
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4-tobbszalu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4. Többszálú alkalmazások készítése
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5-mvvm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5. MVVM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../6-tervezesi-mintak/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6. Tervezési minták (kiterjeszthetőség)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../7-adatkezeles/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7. Adatkezelés
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Önálló/házi feladatok
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Önálló/házi feladatok
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hazi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Útmutató
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hazi/1-model-es-kod-kapcsolata/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. HF - A modell és a kód kapcsolata
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hazi/2-nyelvi-eszkozok/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. HF - Nyelvi eszközök
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hazi/3-felhasznaloi-felulet-kialakitasa/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. HF - Felhasználói felület kialakítása
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hazi/4-tobbszalu-alkalmazasok-fejlesztese/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4. HF - Többszálú alkalmazások fejlesztése
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hazi/5-mvvm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5. HF - MVVM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hazi/6-tervezesi-mintak/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6. HF - Tervezési minták
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hazi/imsc-liftsystem/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IMSc HF - Liftrendszer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hazi/fejlesztokornyezet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fejlesztőkörnyezet
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    English course labs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            English course labs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1-model-es-kod-kapcsolata/index_eng/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. The relationship between the model and the code
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2-nyelvi-eszkozok/index_eng/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. Language tools
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3-felhasznaloi-felulet/index_eng/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. The design of the user interface
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4-tobbszalu/index_eng/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4. Developing multithreaded applications
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5-mvvm/index_eng/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5. MVVM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../6-tervezesi-mintak/index_eng/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6. Design patterns (extensibility)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../7-adatkezeles/index_eng/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7. Data management
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Homework
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Homework
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hazi/index_eng/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hazi/1-model-es-kod-kapcsolata/index_eng/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. HW - The relationship between the model and the code
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hazi/2-nyelvi-eszkozok/index_eng/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. HW - Language tools
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hazi/3-felhasznaloi-felulet-kialakitasa/index_eng/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. HW - Implementing the user interface
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hazi/4-tobbszalu-alkalmazasok-fejlesztese/index_eng/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4. HW - Developing multithreaded applications
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hazi/5-mvvm/index_eng/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5. HW - MVVM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hazi/6-tervezesi-mintak/index_eng/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6. HW - Design patterns
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hazi/meghirdetes-elott_eng/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IMSc HW - Liftsystem
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hazi/fejlesztokornyezet/index_eng/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Development environment
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Deutschkurs-Labore
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Deutschkurs-Labore
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1-model-es-kod-kapcsolata/index_ger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. Beziehung zwischen dem Modell und dem Code
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2-nyelvi-eszkozok/index_ger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. Sprachliche Mittel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3-felhasznaloi-felulet/index_ger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. Entwurf der Benutzeroberfläche
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4-tobbszalu/index_ger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4. Erstellung von mehrfädigen Anwendungen
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5-mvvm/index_ger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5. MVVM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../6-tervezesi-mintak/index_ger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6. Entwurfsmuster (Erweiterbarkeit)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../7-adatkezeles/index_ger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7. Datenverwaltung
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Hausaufgaben
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Hausaufgaben
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hazi/meghirdetes-elott_ger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. Beziehung zwischen dem Modell und dem Code
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hazi/meghirdetes-elott_ger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. Sprachliche Mittel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hazi/3-felhasznaloi-felulet-kialakitasa/index_ger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. Entwurf der Benutzeroberfläche
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hazi/4-tobbszalu-alkalmazasok-fejlesztese/index_ger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4. Entwicklung von Multithreading-Anwendungen
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hazi/5-mvvm/index_ger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5. MVVM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hazi/6-tervezesi-mintak/index_ger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6. Entwurfsmuster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hazi/fejlesztokornyezet/index_ger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Entwicklungsumgebung
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Tartalomjegyzék">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tartalomjegyzék
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#a-gyakorlat-celja" class="md-nav__link">
    <span class="md-ellipsis">
      A gyakorlat célja
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elofeltetelek" class="md-nav__link">
    <span class="md-ellipsis">
      Előfeltételek
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kiindulo-projekt" class="md-nav__link">
    <span class="md-ellipsis">
      Kiinduló projekt
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#az-mvvm-mintarol" class="md-nav__link">
    <span class="md-ellipsis">
      Az MVVM mintáról
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#0-feladat-projekt-felepitese" class="md-nav__link">
    <span class="md-ellipsis">
      0. Feladat - Projekt felépítése
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-feladat-receptek-fooldal" class="md-nav__link">
    <span class="md-ellipsis">
      1. Feladat - Receptek főoldal
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Feladat - Receptek főoldal">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-adateleresi-szolgaltatas" class="md-nav__link">
    <span class="md-ellipsis">
      1.1 Adatelérési szolgáltatás
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-fooldal-viewmodel" class="md-nav__link">
    <span class="md-ellipsis">
      1.2 Főoldal ViewModel
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1.2 Főoldal ViewModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dependency-injection" class="md-nav__link">
    <span class="md-ellipsis">
      Dependency Injection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viewmodel-allapot" class="md-nav__link">
    <span class="md-ellipsis">
      ViewModel állapot
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-fooldal-nezet" class="md-nav__link">
    <span class="md-ellipsis">
      1.3 Főoldal nézet
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-feladat-recept-reszletes-oldal" class="md-nav__link">
    <span class="md-ellipsis">
      2. Feladat - Recept részletes oldal
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Feladat - Recept részletes oldal">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-recept-lekerdezese" class="md-nav__link">
    <span class="md-ellipsis">
      2.1 Recept lekérdezése
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-recept-reszletes-viewmodel" class="md-nav__link">
    <span class="md-ellipsis">
      2.2 Recept részletes ViewModel
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-recept-reszletes-oldal-navigacio" class="md-nav__link">
    <span class="md-ellipsis">
      2.3 Recept részletes oldal, navigáció
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.3 Recept részletes oldal, navigáció">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#command" class="md-nav__link">
    <span class="md-ellipsis">
      Command
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24-recept-reszletes-nezet" class="md-nav__link">
    <span class="md-ellipsis">
      2.4 Recept részletes nézet
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-feladat-kommentek-hozzaadasa" class="md-nav__link">
    <span class="md-ellipsis">
      3. Feladat - Kommentek hozzáadása
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Feladat - Kommentek hozzáadása">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#webszolgaltatas" class="md-nav__link">
    <span class="md-ellipsis">
      Webszolgáltatás
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viewmodel" class="md-nav__link">
    <span class="md-ellipsis">
      ViewModel
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kitekintes-commandok-vegrehajtasanak-feltetelei" class="md-nav__link">
    <span class="md-ellipsis">
      Kitekintés: Commandok végrehajtásának feltételei
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/bmeviauab00/szoftvertechnikak/edit/master/docs/labor/old-5-mvvm/index.md" title="Oldal szerkesztése" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg>
    </a>
  
  


<h1 id="5-mvvm">5. MVVM<a class="headerlink" href="#5-mvvm" title="Permanent link">&para;</a></h1>
<h2 id="a-gyakorlat-celja">A gyakorlat célja<a class="headerlink" href="#a-gyakorlat-celja" title="Permanent link">&para;</a></h2>
<p>A labor során egy recept böngésző alkalmazást fogunk készíteni, amelyben alkalmazzuk az MVVM tervezési mintát.</p>
<h2 id="elofeltetelek">Előfeltételek<a class="headerlink" href="#elofeltetelek" title="Permanent link">&para;</a></h2>
<p>A labor elvégzéséhez szükséges eszközök:</p>
<ul>
<li>Windows 10 vagy Windows 11 operációs rendszer (Linux és macOS nem alkalmas)</li>
<li>Visual Studio 2022<ul>
<li>Windows Desktop Development Workload</li>
</ul>
</li>
</ul>
<h2 id="kiindulo-projekt">Kiinduló projekt<a class="headerlink" href="#kiindulo-projekt" title="Permanent link">&para;</a></h2>
<p>Klónozzuk le a kiinduló projektet az alábbi paranccsal:</p>
<div class="highlight"><pre><span></span><code>git clone https://github.com/bmeviauab00/lab-mvvm-kiindulo
</code></pre></div>
<details class="success">
<summary>A kész megoldás letöltése</summary>
<p><img alt="❗" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2757.svg" title=":exclamation:" /> Lényeges, hogy a labor során a laborvezetőt követve kell dolgozni, tilos (és értelmetlen) a kész megoldás letöltése. Ugyanakkor az utólagos önálló gyakorlás során hasznos lehet a kész megoldás áttekintése, így ezt elérhetővé tesszük.</p>
<p>A megoldás <a href="https://github.com/bmeviauab00/lab-mvvm-kiindulo">GitHubon érhető el</a> a <code>megoldas</code> ágon. A legegyszerűbb mód a letöltésére, ha parancssorból a <code>git clone</code> utasítással leklónozzuk a gépünkre a <code>megoldas</code> ágat:</p>
<p><code>git clone https://github.com/bmeviauab00/lab-mvvm-kiindulo -b megoldas</code></p>
</details>
<h2 id="az-mvvm-mintarol">Az MVVM mintáról<a class="headerlink" href="#az-mvvm-mintarol" title="Permanent link">&para;</a></h2>
<p>Az MVVM (Model-View-ViewModel) egy architekturális tervezési minta, amelyet a XAML alkalmazások fejlesztése során használhatunk, de gyakran más kliens oldali technológiák esetében is megjelenik. Az MVVM minta célja, hogy a felhasználói felületet és a mögötte lévő logikát szétválassza, és ezzel egy lazább csatolású alkalmazást hozzon létre, ami növeli a tesztelhetőséget, a karbantarthatóságot és az újrafelhasználhatóságot.</p>
<p>Az MVVM minta három (+1) fő részből áll:</p>
<ul>
<li><strong>Model</strong>: Az alkalmazás üzleti modelljét tartalmazza, amelyet a ViewModel-ek használhatnak az adatok tárolására.</li>
<li><strong>View</strong>: A felhasználói felület leírását tartalmazza, és a tisztán a nézetekhez kapcsolódó logikát (pl.: animációk kezelését).</li>
<li><strong>ViewModel</strong>: A nézet <strong>absztrakciója</strong>, mely tartalmazza a nézet állapotát és a nézeten végrehajtható műveleteket, <strong>nézet függetlenül</strong>. A laza csatolást a ViewModel és a nézet között az adatkötés biztosítja.</li>
<li><strong>Services</strong> (szolgáltatások): Az alkalmazás üzleti logikáját tartalmazó osztályok, amelyeket a ViewModel-ek használnak. Ha minden üzleti logika a ViewModel-ekben lenne, azok túl bonyolultak és átláthatatlanok lennének. Ez nem az MVVM minta része, de itt említjük meg, mert mi is így fogjuk használni az alkalmazás architektúráját.</li>
</ul>
<p>Új:</p>
<ul>
<li><strong>Model</strong>: Domainspecifikus adatokat fog össze, melyet a ViewModel-ek használhatnak az adatok tárolására. Pl. Recipe/Product/Order osztály, egy recept/termék/megrendelés adatait fogja össze.</li>
<li><strong>View</strong>: A felhasználói felület leírását tartalmazza, (és a tisztán a nézetekhez kapcsolódó logikát, pl. animációk kezelését). Tipikusan Window, Page, UserControl leszármazott osztály, XAML-beli deklaratív leírással, a code-behind sokszor üres (mert a logika a ViewModel-ben van).</li>
<li><strong>ViewModel</strong>: A nézethez tartozó logika van benne: tartalmazza a nézet állapotát és a nézeten végrehajtható műveleteket. <strong>Független</strong> a nézettől, a laza csatolást a ViewModel és a nézet között adatkötés biztosítja (a nézet vezérlői kötnek a ViewModel tulajdonságaihoz). Unit tesztelhető!</li>
<li><strong>Services</strong> (szolgáltatások): Az alkalmazás üzleti/alkalmazás logikáját tartalmazó osztályok, amelyeket a ViewModel-ek használnak. Ha minden üzleti logika a ViewModel-ekben lenne, azok túl bonyolultak és átláthatatlanok lennének. Ez nem az MVVM minta része, de itt említjük meg, mert mi is így fogjuk felépíteni az alkalmazás architektúráját.</li>
</ul>
<figure>
<p><a class="glightbox" href="images/mvvm.drawio.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="MVVM" src="images/mvvm.drawio.png" /></a></p>
</figure>
<p><img alt="❗" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2757.svg" title=":exclamation:" /> Mihez készítünk ViewModel osztályokat?</p>
<ul>
<li>Az egyes <strong>nézetekhez</strong> (pl. Window, Page, Dialog, UserControl) mindig készítünk ViewModel osztályt, és belőle egy nézethez egy objektumot hozunk létre.  Pl. MainPage-hez MainPageViewModel, DancerDialog-hoz DancerDialogViewModel. Ezt a gyakorlat során is alkalmazzuk.</li>
<li>Az egyes <strong>modell</strong> osztályokhoz (pl. Recipe, Product, Dancer stb.) opcionálisan készíthetünk csomagoló ViewModel osztályokat (pl. RecipeViewModel, ProductViewModel, DancerViewModel), ilyeneket a gyakorlat során <strong>nem</strong> fogunk készíteni. Ez azért van, mert nem a Strict, hanem a Relaxed MVVM mintát követjük (lásd előadás).</li>
</ul>
<h2 id="0-feladat-projekt-felepitese">0. Feladat - Projekt felépítése<a class="headerlink" href="#0-feladat-projekt-felepitese" title="Permanent link">&para;</a></h2>
<p>Az alkalmazás váza már elő van készítve. Tekintsük át a projekt felépítését.</p>
<p>Az <code>MvvmLab</code> a futtatható alkalmazás projektje, amely WinUI keretrendszert használ a megjelenítési rétegében a már tanult XAML nyelvvel. Az <code>MvvmLab.Core</code> projekt (class library) a teljesen nézet független üzleti logikákat tartalmazza.</p>
<p>Ami számunkra fontos a kiinduló projektben:</p>
<ul>
<li><code>App.xaml.cs</code>: Az alkalmazás belépési pontja, amely használja a modern .NET alkalmazásokban alkalmazott Host Builder és Dependency Injection mintákat. A félévnek ez nem az anyaga, de a függőség injektálásról még a labor során lesz szó.</li>
<li><code>Views</code> mappa: Az alkalmazás nézeteit tartalmazza, jelenleg a <code>MainPage</code>-et</li>
<li><code>ViewModels</code> mappa: Az alkalmazás ViewModel-jeit tartalmazza, jelenleg a <code>MainPageViewModel</code>-t</li>
<li><code>INagivationService</code> (<code>Services</code> mappában): oldalak közötti navigációhoz használt szolgáltatás</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">MVVM és Boilerplate könyvtárak</p>
<p>MVVM mintát ritkán szoktunk kizárólag a .NET keretrendszerre támaszkodva implementálni. Érdemes használni valamilyen MVVM könyvtárat, amelyek segítségével a kódunk tömörebb, átláthatóbb, és kevesebb boilerplate kódot fog tartalmazni. A könyvtárak közül a legelterjedtebbek a következők:</p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/dotnet/communitytoolkit/mvvm/">MVVM Toolkit</a>: Microsoft által gondozott MVVM könyvtár</li>
<li><a href="https://prismlibrary.com/">Prism</a>: Régen Microsoft gondozásában állt és nagyon elterjedt volt, de már külső fejlesztők tartják karban és fizetős lett idő közben.</li>
<li><a href="https://reactiveui.net/">ReactiveUI</a>: A Reactive Extensions (Rx) könyvtárakat használja a ViewModel állapotának kezelésére, és a nézet és ViewModel közötti adatkötésre. Ez a könyvtár nyújtja a legtöbb szolgáltatást, de a legnehezebben tanulható is.</li>
<li><a href="https://platform.uno/uno-extensions/">Uno.Extensions</a>: MVVM Toolkitre épül, de több olyan szolgáltatást is tartalmaz, amelyek a WinUI keretrendszer hiányosságait pótolják.</li>
</ul>
<p>A labor során a Microsoft által gondozott MVVM Toolkitet fogjuk használni.</p>
<p>A kiinduló projekt pedig a <a href="https://marketplace.visualstudio.com/items?itemName=TemplateStudio.TemplateStudioForWinUICs">Windows Template Studio</a> Visual Studio kiegészítő segítségével készült.</p>
</div>
<h2 id="1-feladat-receptek-fooldal">1. Feladat - Receptek főoldal<a class="headerlink" href="#1-feladat-receptek-fooldal" title="Permanent link">&para;</a></h2>
<p>A megoldás során "alulról", az adatok felől fogunk építkezni és fokozatosan fogunk eljutni a nézetig. Ugyan a való életben egy top-bottom fejlesztés gyakran hasznosabb, de a labor során az idő rövidsége miatt az alulról építkezés gyorsabb és egyszerűbb, mert így nem kell az adatokat mockolni. Az alábbi ábra a főoldalhoz tartozó fontosabb osztályokat tekinti át.</p>
<figure>
<p><a class="glightbox" href="images/mvvm-mainpage.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Főoldal" src="images/mvvm-mainpage.png" /></a>
<figurecation>A főoldal MMVM alapú megvalósítása<figurecaption></p>
</figure>
<p>Fontosabb elemek:</p>
<ul>
<li><code>MainPage</code>: ez a View, egy Page leszármazott, a felület XAML alapú leírása.</li>
<li><code>MainPageViewModel</code>: a főoldalhoz (<code>MainPage</code>) tartozó ViewModel. Egy (generált) <code>RecipeGroups</code> tulajdonságban receptcsoportokat, a receptcsoportokban recepteket tartalmaz. A nézet ezen a receptcsoportok fejlécét, illetve a csoportokban levő receptek fejlécét és képeit jeleníti meg adatkötéssel.</li>
<li><code>RecipeGroup</code> és <code>Recipe</code>: a receptcsoportokat és a recepteket reprezentáló modell osztályok.</li>
<li><code>RecipeService</code>: alkalmazáslogika/adatelérés a receptek kezeléséhez (egy távoli szolgáltatással kommunikál), a ViewModel használja.</li>
</ul>
<h3 id="11-adateleresi-szolgaltatas">1.1 Adatelérési szolgáltatás<a class="headerlink" href="#11-adateleresi-szolgaltatas" title="Permanent link">&para;</a></h3>
<p>Kezdjük az adatelérési réteggel, amit most tekinthetünk az MVVM mintában a modell rétegnek is.</p>
<p>Az alkalmazásunk adatait egy webszerverről kérdezi le (ún. REST API-n, HTTP-n keresztül éri el). Az ehhez hasonló kliens-szerver architektúrájú alkalmazások egy kifejezetten gyakori megoldásnak számítanak a modern alkalmazások fejlesztése során. Erről bővebben a következő félévben a Mobil és Webes szoftverek, illetve az Adatvezérelt alkalmazások tárgyakban lesz szó. Most elég annyit tudni, hogy a kliens alkalmazásunk HTTP kéréseket fog küldeni a szervernek, amelyekre a szerver válaszolni fog, mégpedig JSON formátumban szolgáltat adatokat.</p>
<figure>
<p><a class="glightbox" href="images/client-server.drawio.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Kliens-szerver architektúra" src="images/client-server.drawio.png" /></a>
<figurecation>Kliens-szerver architektúra<figurecaption></p>
</figure>
<p>A távoli szolgáltatás a következő címen érhető el: <a href="https://bmecookbook2.azurewebsites.net/api">https://bmecookbook2.azurewebsites.net/api</a>. A szolgáltatáshoz pedig tartozik egy OpenApi alapú dokumentáció a <a href="https://bmecookbook2.azurewebsites.net/swagger">https://bmecookbook2.azurewebsites.net/swagger</a> címen. Tanulmányozzuk ezt át, vagy akár próbáljuk ki a végpotokat a Swagger felületén keresztül (ehhez írjuk be az előző "swagger" végződésű URL-t egy böngésző címsorába).
Az első feladathoz a <code>/api/Recipes/Groups</code> végpontot fogjuk használni, amely a receptek csoportosítását adja vissza.</p>
<p>Vegyünk fel az <code>MvvmLab.Core</code> projekt <code>Models</code> mappájába egy új osztályt <code>RecipeGroup</code> néven.</p>
<p>A swagger segítségével hívjuk meg az "api/Recipes/Groups" végpontot (pontosabban egy http GET kérést küldjü)</p>
<ul>
<li>A swagger felületen a "Get api/Recipes/Groups" végpont leírást nyissuk le</li>
<li>Kattintsunk az Execute gombon</li>
<li>A szolgáltatás által küldött JSON válasz a "Response body" alatt jelenik meg: itt azt látjuk, hogy a válaszban receptcsoportokat kaptunk. Minden csoportnak van egy "title"-je (pl. Chinese, Mexican, Italian), és a csoportok alatt találhatók <code>[]</code> között (JSON tömb) a csoportban levő receptek adatai. </li>
<li>
<p>Másoljunk vágólapra egy <code>RecipeGroup</code>-nyi JSON adatot. Használhatjuk az "Example Value" alatti kimenetet is a vágólapra másoláskor (de a nyitó [ és záró ] karatereket ne másoljuk ki). Ha valamiért elakadnánk, az alábbi lenyíló szakaszból is kimásolhatjuk a vágólapra a tartalmat:</p>
<details>
<summary>Vágólapra másolandó</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;Title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;Recipes&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;Id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;BackgroundImage&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
</details>
</li>
</ul>
<p>Visual Studio-ban az <code>Edit</code> menü <code>Paste Special</code> menüpontjában a <code>Paste JSON as Classes</code> menüpontot választva illesszük be a vágólap tartalmát. Ekkor olyan osztályokat generál a VS, mely megfelel a beillesztett JSON szerkezetének.</p>
<p><a class="glightbox" href="images/paste-json-as-classes.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Paste JSON as Classes" src="images/paste-json-as-classes.png" /></a></p>
<p>A kapott osztályokat átnevezhetjük, hogy a C# kódolási konvencióknak megfeleljenek. A <code>Rootobject</code> osztályt nevezzük át <code>RecipeGroup</code>-ra, a <code>Recipe</code> osztályt pedig <code>RecipeHeader</code>-re.</p>
<div class="highlight"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">RecipeGroup</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">Title</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="n">RecipeHeader</span><span class="p">[]</span><span class="w"> </span><span class="n">Recipes</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">RecipeHeader</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">Id</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">Title</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">BackgroundImage</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title"><code>List&lt;T&gt;</code> használata</p>
<p>Esetünkben nem volt rá szükség (mert nem bővjük receptgyűjteményeket), de ha kényelmesebb számunkra, akkor nyugodtan írjuk át a generált kódban a tömböket <code>List&lt;T&gt;</code>-re.</p>
</div>
<p>Készítsünk egy <code>IRecipeService</code> interfészt az <code>MvvmLab.Core.Services</code> névtérbe, amelyen keresztül el fogjuk érni a távoli szolgáltatást. Az interfészben egy <code>GetRecipeGroupsAsync</code> metódust hozzunk létre, amely a recept csoportokat kérdezi le és adja vissza.</p>
<div class="highlight"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="k">interface</span><span class="w"> </span><span class="n">IRecipeService</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="n">Task</span><span class="o">&lt;</span><span class="n">RecipeGroup</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="n">GetRecipeGroupsAsync</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Task visszatérési érték</p>
<p>Az interfészben a tényleges visszatérési értéket (<code>RecipeGroup[]</code>) egy <code>Task&lt;T&gt;</code> objektumba csomagoljuk, mivel a hálózati műveleteket aszinkron célszerű implementálni. .NET-ben az aszinkron megvalósítás legkorszerűbb és legegyszerűbb módja a <code>Task</code>-ok alkalmazása. Az aszinkronitás pedig azt biztosítja itt számunkra, hogy ha a hálózati kérés sokáig tart, akkor se fagyjon be a felhasználói felület (és mindezt külön szálak indítása nélkül).</p>
</div>
<p>Az interfész implementációját a <code>MvvmLab.Core.Services</code> névtérben hozzuk létre <code>RecipeService</code> néven.
A szolgáltatásunk a <code>HttpClient</code> beépített .NET osztályt fogja használni a REST API hívásokhoz.
A <code>GetFromJsonAsync</code> indít egy HTTP GET aszinkron kérést a megadott címre, és a választ JSON formátumból deszerializálja a megadott típusra.</p>
<div class="highlight"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">RecipeService</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">IRecipeService</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">private</span><span class="w"> </span><span class="k">readonly</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">_baseUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;https://bmecookbook2.azurewebsites.net/api&quot;</span><span class="p">;</span>

<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="n">Task</span><span class="o">&lt;</span><span class="n">RecipeGroup</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="n">GetRecipeGroupsAsync</span><span class="p">()</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">using</span><span class="w"> </span><span class="nn">var</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HttpClient</span><span class="p">();</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="n">client</span><span class="p">.</span><span class="n">GetFromJsonAsync</span><span class="o">&lt;</span><span class="n">RecipeGroup</span><span class="p">[]</span><span class="o">&gt;</span><span class="p">(</span><span class="s">$&quot;{_baseUrl}/Recipes/Groups&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>A <code>GetFromJsonAsync</code> művelet aszinkron, így <code>Task</code>-kal tér vissza, ezt nem blokkoló módon bevárni és az eredményét elérni az <code>await</code> kulcsszóval tudjuk.</p>
<div class="admonition tip">
<p class="admonition-title">async-await</p>
<p>Az <code>async</code> és <code>await</code> kulcsszavak a legtöbb modern nyelvben az aszinkron függvényhívás nyelvi szintű kezelésére szolgálnak. A működéséről a félév végén lesz még szó részletesen, de most a használathoz az alábbiakat érdemes tudni:</p>
<ul>
<li>Az <code>await</code> kulcsszóval tudunk bevárni aszinkron végrehajtású műveletet, anélkül, hogy blokkolnánk a hívót.</li>
<li>Az <code>await</code> kulcsszót, csak <code>async</code> kulcsszóval ellátott függvényekben használhatjuk.</li>
<li>Az <code>async</code> függvényeknek csak <code>Task</code> vagy <code>Task&lt;T&gt;</code> vagy <code>void</code> visszatérési értékük lehet. (Illetve "Task szerű", de ezt nem itt vesszük.)<ul>
<li>Ha egy <code>async</code> függvényt kívülről be szeretnénk várni, akkor az voiddal nem tudjuk megtenni, mindenképpen <code>Task</code> vagy <code>Task&lt;T&gt;</code> visszatérési értékkel kell rendelkeznie.</li>
<li>az <code>async</code> függvényekben a <code>return</code> utasítás szintaktikája megváltozik: nem a Task objektummal kell visszatérjünk, hanem az általa tartalmazott adattal (<code>Task</code> esetében <code>void</code>, <code>Task&lt;T&gt;</code> esetében <code>T</code>).</li>
</ul>
</li>
</ul>
</div>
<h3 id="12-fooldal-viewmodel">1.2 Főoldal ViewModel<a class="headerlink" href="#12-fooldal-viewmodel" title="Permanent link">&para;</a></h3>
<p>Következő lépésben a főoldal ViewModeljét fogjuk elkészíteni, amely az előbb elkészített szolgáltatást fogja használni a recept csoportok lekérdezéséhez, és állapotként tárolja azokat a nézet számára.</p>
<h4 id="dependency-injection">Dependency Injection<a class="headerlink" href="#dependency-injection" title="Permanent link">&para;</a></h4>
<p>Nyissuk meg a <code>MainPageViewModel</code> osztályt az <code>MvvmLab.ViewModels</code> mappából.
A ViewModel-ünknek szüksége lesz egy <code>IRecipeService</code> interfészt implementáló osztályra, amelyen keresztül le tudja kérdezni a recept csoportokat.
A <code>MainPageViewModel</code> konstruktorában függőség injektáláson keresztül szerezzük be a szükséges függőséget.
Esetünkben ez annyit tesz, hogy várunk egy <code>IRecipeService</code> típusú paramétert, amelyet majd a ViewModel példányosításkor fog megkapni, a paramétert pedig elmentjük egy privát változóba.</p>
<div class="highlight"><pre><span></span><code><span class="k">private</span><span class="w"> </span><span class="k">readonly</span><span class="w"> </span><span class="n">IRecipeService</span><span class="w"> </span><span class="n">_recipeService</span><span class="p">;</span>

<span class="k">public</span><span class="w"> </span><span class="nf">MainPageViewModel</span><span class="p">(</span><span class="n">IRecipeService</span><span class="w"> </span><span class="n">recipeService</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">_recipeService</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">recipeService</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<details class="tip">
<summary>Függőség Injektálás - Dependency Injection - DI</summary>
<p>Alapesetben az osztályok szoros csatolást alakítanak ki a függőségeikkel (referencia, példányosítás). </p>
<p><figure markdown>
<a class="glightbox" href="images/without-di.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Without DI" src="images/without-di.png" /></a>
<figurecaption>Erős csatolás DI nélkül</figurecaption>
</figure></p>
<p>Ez a szoros csatolás nehezíti a tesztelhetőséget, a karbantarthatóságot és az újrafelhasználhatóságot. Ezen segít a Dependency Injection (és a Strategy) alkalamazása. A tárgy keretében a tervezési mintákhoz kapcsolódóan tanulunk a Dependency Injection (DI) tervezési mintáról, melyet mindig a Strategy mintával együtt alkalmazunk. A lényege az, hogy egy osztály nem maga hozza létre a függőségeit (azon osztályokat, melyektől függ, melyeket felhasznál), hanem kívülről kapja meg, pl. konstruktor paraméterben. A Strategy mintából adódóan pedig az következik, hogy csak "interfészként" függ tőlük. </p>
<p>A mai legtöbb platform egy plusz szolgáltatást, ún. DI (más nevén IoC) <strong>konténert</strong> is biztosít a függgőségek kényelmes kezeléséhez. 
A függőségek életciklusát ez esetben egy kitüntetett komponens kezeli, a DI konténer. A DI konténer (ábrán Builder) felelős az osztályok példányosításáért és a függőségek beinjektálásáért rekurzívan.</p>
<p><figure markdown>
<a class="glightbox" href="images/with-di.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="With DI" src="images/with-di.png" /></a>
<figurecaption>DI osztálydiagramm</figurecaption>
</figure></p>
</details>
<p>Ahhoz, hogy a példányosítás során a függőségi gráfot bejárva beinjektálja a megfelelő implementációkat a konténer, a DI konténerbe be kell regisztrálni a <strong>függőségi leképezéseket</strong>. Alkalmazásunkban ezt az <code>App.xaml.cs</code> fájlban a <code>ConfigureServices</code> metódusban tesszük meg. Vegyük fel az alábbi sort, pl. a <code>// Core Services</code> szakasz alá:</p>
<div class="highlight"><pre><span></span><code><span class="n">services</span><span class="p">.</span><span class="n">AddTransient</span><span class="o">&lt;</span><span class="n">IRecipeService</span><span class="p">,</span><span class="w"> </span><span class="n">RecipeService</span><span class="o">&gt;</span><span class="p">();</span>
</code></pre></div>
<p>Ez azt mondja meg, hogy ahol egy osztályunk <code>IRecipeService</code> függőséget vár (pl. <code>MainPageViewModel</code> konstruktora), a DI keretrendszer egy <code>RecipeService</code> implementációt szúr be (és mivel itt <strong>Tranziens</strong> élettartamúként regisztráltuk, minden egyes <code>IRecipeService</code> függőség igényt egy új <code>RecipeService</code> példány fog kielégíteni).</p>
<p>Ahhoz, hogy a Dependency Injection az alkalmazásunkban működjön, a <code>MainPageViewModel</code> osztályt is be kell regisztrálni a konténerbe, ezt is megtaláljuk a <code>ConfigureServices</code> alatt.</p>
<div class="admonition note">
<p class="admonition-title">DI konténerekről részletesen</p>
<p>A DI konténerek használatával és működésével Adatvezérelt rendszerek tárgy keretében fogunk később részletesen megismerkedni.</p>
</div>
<h4 id="viewmodel-allapot">ViewModel állapot<a class="headerlink" href="#viewmodel-allapot" title="Permanent link">&para;</a></h4>
<p>Következő lépésben a ViewModel állapotának feltöltését implementáljuk.</p>
<p>A célunk az, hogy</p>
<ul>
<li>a <code>MainPageViewModel</code>-ben legyen <code>RecipeGroups</code>nevű tulajdonság, melyben receptcsoportok vannak (ezt akarjuk a felülethez kötni),</li>
<li>a <code>RecipeGroups</code> változásait kövesse le a felület, melyhez szükség van az <code>INotifyPropertyChanged</code> megvalósítására és a <code>PropertyChanged</code> megfelelő elsütésére (ahogy a korábbi laboron/házi feladatban már láttuk).</li>
</ul>
<p>Ehhez viszonylag "sokat" kellene dolgoznunk, de az MVVM toolkit leegyszerűsíti az életünket, mindössze a következőt kell megtennünk:</p>
<ul>
<li>A <code>MainPageViewModel</code>-ben hozzunk létre egy <code>_recipeGroups</code> nevű <code>RecipeGroup[]</code> <strong>tagváltozót</strong> (vagyis nem tulajdonságot).</li>
<li>A változót lássuk el a <code>ObservableProperty</code> attribútummal. </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="na">[ObservableProperty]</span>
<span class="k">private</span><span class="w"> </span><span class="n">RecipeGroup</span><span class="p">[]</span><span class="w"> </span><span class="n">_recipeGroups</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Array</span><span class="p">.</span><span class="n">Empty</span><span class="o">&lt;</span><span class="n">RecipeGroup</span><span class="o">&gt;</span><span class="p">();</span>
</code></pre></div>
<p>Kész is vagyunk. De mi történik ennek hatására?</p>
<ul>
<li>Ez alapján az MVVM Toolkit automatikusan generálni fog egy <code>RecipeGroups</code> nevű property-t az osztály generált másik (partial) felében.</li>
<li>Ez a generált property kihasználja az <code>INotifyPropertyChanged</code> interfészt, így a <code>RecipeGroups</code> property értékének megváltozásakor a <code>PropertyChanged</code> eseményt kiváltva értesíti a nézetet, az adatkötések mentén.</li>
<li>A <code>MainPageViewModel</code>-ünk már megvalósítja az <code>INotifyPropertyChanged</code> interfészt, mert az MVVM Toolkit <code>ObservableObject</code> osztályából származik.</li>
</ul>
<p>A <code>MainPageViewModel</code>-ben implementáljuk az előkészített <code>INavigationAware</code> interfészt, amelynek segítségével a nézetek közötti navigációs életciklus eseményt tudjuk lekezelni, és akár adatokat is tudunk átadni a ViewModel-ek között.
A <code>OnNavigatedTo</code> metódusban kérdezzük le a recept csoportokat az <code>IRecipeService</code>-en keresztül, majd tároljuk el a <code>RecipeGroups</code> változóban.</p>
<div class="highlight"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="k">partial</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">MainPageViewModel</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ObservableObject</span><span class="p">,</span><span class="w"> </span><span class="n">INavigationAware</span>
<span class="p">{</span>
<span class="w">    </span><span class="c1">// ...</span>

<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">OnNavigatedTo</span><span class="p">(</span><span class="kt">object</span><span class="w"> </span><span class="n">parameter</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="hll"><span class="w">        </span><span class="n">RecipeGroups</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="n">_recipeService</span><span class="p">.</span><span class="n">GetRecipeGroupsAsync</span><span class="p">();</span>
</span><span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">OnNavigatedFrom</span><span class="p">()</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="13-fooldal-nezet">1.3 Főoldal nézet<a class="headerlink" href="#13-fooldal-nezet" title="Permanent link">&para;</a></h3>
<p>A <code>MainPage</code>-en készítsük el a nézetet, amelyen megjelenítjük a recept csoportokat.</p>
<p>Ahhoz, hogy a csoportosítást kezelni tudja a <code>GridView</code>, szükségünk van egy olyan listára, mely elvégzi a csoportosítást.
Ezt a <code>CollectionViewSource</code> osztály segítségével tudjuk megvalósítani, ami bizonyos szempontból UI specifikus burkoló feladatokat lát el gyűjteményeken.
A <code>CollectionViewSource</code>-nak meg kell adnunk a csoportosítandó elemeket, valamint azt, hogy a csoportokat milyen property alapján hozza létre.
Továbbá meg kell adnunk azt is, hogy a csoportokon belül milyen property alapján jelenítse meg az elemeket.</p>
<p>Hozzuk létre az oldal erőforrásai között a <code>CollectionViewSource</code> példányt (az alábbi kódot a <code>MainPage.xaml</code>-be, a Grid fölé tegyük be, vele egy szintre).</p>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;Page.Resources&gt;</span>
<span class="w">    </span><span class="nt">&lt;CollectionViewSource</span><span class="w"> </span><span class="na">x:Name=</span><span class="s">&quot;RecipeGroupsCollectionSource&quot;</span>
<span class="w">                            </span><span class="na">IsSourceGrouped=</span><span class="s">&quot;True&quot;</span>
<span class="w">                            </span><span class="na">ItemsPath=</span><span class="s">&quot;Recipes&quot;</span>
<span class="w">                            </span><span class="na">Source=</span><span class="s">&quot;{x:Bind ViewModel.RecipeGroups, Mode=OneWay}&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="nt">&lt;/Page.Resources&gt;</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Vegyük észre, hogy az adatkötés során a <code>ViewModel</code> tulajdonsághoz kötünk, mely a <code>MainPage.xaml.cs</code>-ben található, és egyszerűen csak átkasztolja a <code>DataContext</code> property-t a ViewModel típusunkra.</p>
<div class="highlight"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="n">MainPageViewModel</span><span class="w"> </span><span class="n">ViewModel</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">DataContext</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">MainPageViewModel</span><span class="p">;</span>
</code></pre></div>
<p>Az, hogy a vezérlők (oldalak) <code>DataContext</code> tulajdonságában a ViewModel-t tároljuk tipikus az MVVM mintában. Esetünkben ezt a generált projekt <code>NavigationService</code> osztálya teszi meg nekünk.</p>
</div>
<details class="tip">
<summary>Erőforrások</summary>
<p>XAML környezetben minden vezérlő (fenti példában Page) és az <code>Application</code> osztály is, rendelkezik egy <code>Resources</code> property-vel, mely egy kulcs érték tároló (<code>Dictionary&lt;string, object&gt;</code>), alap esetben. Ebbe tudunk többször felhasználható objektumokat rakni, akár alkalmazás szinten is. Ha ehhez az erőforrások példányosításakor megadjuk az <code>x:Key</code> attribútumot, akkor az erőforrásokat a kulcs alapján tudjuk lekérdezni pl.: a <code>{StaticResource Key}</code> markup extensionnel.</p>
<p>Mi viszont itt kifejezetten <code>x:Key</code> helyett <code>x:Name</code>-et adtunk meg, mert az <code>x:Bind</code>-ban név szerint szeretnénk majd hivatkozni rá (emlékezzünk: az <code>x:Name</code> attribútum segítségével azt tudjuk elérni, hogy generálódik ilyen néven egy tagváltozó az osztályunkban, így a code behind fájlból, vagy x:Bind adatkötés során ilyen néven el tudjuk érni).</p>
</details>
<p>A receptek listázásához, most egy speciális <code>GridView</code> leszármazott vezérlőt használjunk, mégpedig az <code>AdaptiveGridView</code>-t a <a href="https://learn.microsoft.com/en-us/windows/communitytoolkit/">CommunityToolkit</a> csomagból, amely a nézet méretének megfelelően változtatja a megjelenített elemek számát és méretét, illetve támogatja a Command-okat az elem kattintás esetében. A külső vezérlők hivatkozásához vegyük fel az oldalra a következő névteret:</p>
<div class="highlight"><pre><span></span><code>xmlns:controls=&quot;using:CommunityToolkit.WinUI.UI.Controls&quot;
</code></pre></div>
<p>Készítsük el a GridView-t, amelynek a <code>ItemsSource</code> property-jét a fenti erőforrásban lévő <code>RecipeGroupsCollectionSource.View</code>-ra kötjük.</p>
<p>A <code>GridView</code>-en belül a megszokott módon az <code>ItemTemplate</code> property-n keresztül tudjuk megadni, hogy az egyes elemeket hogyan kell megjeleníteni.
Esetünkben egy képet és egy szöveget rakunk ki a receptek címe alapján egy "kártya" szerű layoutra.</p>
<p>A <code>GroupStyle</code> property-n keresztül pedig meg tudjuk adni, hogy a csoportokat hogyan kell megjeleníteni. Esetünkben a fejlécet akarjuk testreszabni.</p>
<p>A <code>MainPage.xaml</code>-ben a <code>&lt;Grid x:Name="ContentArea"&gt; ...</code> grid-et cseréljük le a következőre:</p>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;Grid</span><span class="w"> </span><span class="na">x:Name=</span><span class="s">&quot;ContentArea&quot;</span><span class="w"> </span><span class="na">Padding=</span><span class="s">&quot;10&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Grid.RowDefinitions&gt;</span>
<span class="w">        </span><span class="nt">&lt;RowDefinition</span><span class="w"> </span><span class="na">Height=</span><span class="s">&quot;Auto&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;RowDefinition</span><span class="w"> </span><span class="na">Height=</span><span class="s">&quot;*&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/Grid.RowDefinitions&gt;</span>

<span class="w">    </span><span class="nt">&lt;TextBlock</span><span class="w"> </span><span class="na">Text=</span><span class="s">&quot;Recipes&quot;</span>
<span class="w">               </span><span class="na">Grid.Row=</span><span class="s">&quot;0&quot;</span>
<span class="w">               </span><span class="na">Style=</span><span class="s">&quot;{StaticResource TitleLargeTextBlockStyle}&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>

<span class="w">    </span><span class="nt">&lt;controls:AdaptiveGridView</span><span class="w"> </span><span class="na">Grid.Row=</span><span class="s">&quot;1&quot;</span>
<span class="w">                               </span><span class="na">DesiredWidth=</span><span class="s">&quot;180&quot;</span>
<span class="w">                               </span><span class="na">IsItemClickEnabled=</span><span class="s">&quot;True&quot;</span>
<span class="w">                               </span><span class="na">ItemHeight=</span><span class="s">&quot;160&quot;</span>
<span class="w">                               </span><span class="na">ItemsSource=</span><span class="s">&quot;{x:Bind RecipeGroupsCollectionSource.View, Mode=OneWay}&quot;</span>
<span class="w">                               </span><span class="na">SelectionMode=</span><span class="s">&quot;None&quot;</span>
<span class="w">                               </span><span class="na">StretchContentForSingleRow=</span><span class="s">&quot;False&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;GridView.ItemTemplate&gt;</span>
<span class="w">            </span><span class="nt">&lt;DataTemplate</span><span class="w"> </span><span class="na">x:DataType=</span><span class="s">&quot;models:RecipeHeader&quot;</span><span class="nt">&gt;</span>
<span class="w">                </span><span class="nt">&lt;Grid</span><span class="w"> </span><span class="na">MaxWidth=</span><span class="s">&quot;300&quot;</span><span class="nt">&gt;</span>
<span class="w">                    </span><span class="nt">&lt;Image</span><span class="w"> </span><span class="na">Source=</span><span class="s">&quot;{x:Bind BackgroundImage}&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">                    </span><span class="nt">&lt;Border</span><span class="w"> </span><span class="na">Height=</span><span class="s">&quot;40&quot;</span>
<span class="w">                            </span><span class="na">Padding=</span><span class="s">&quot;10,0,0,0&quot;</span>
<span class="w">                            </span><span class="na">VerticalAlignment=</span><span class="s">&quot;Bottom&quot;</span>
<span class="w">                            </span><span class="na">Background=</span><span class="s">&quot;#88000000&quot;</span><span class="nt">&gt;</span>
<span class="w">                        </span><span class="nt">&lt;TextBlock</span><span class="w"> </span><span class="na">VerticalAlignment=</span><span class="s">&quot;Center&quot;</span>
<span class="w">                                   </span><span class="na">Foreground=</span><span class="s">&quot;White&quot;</span>
<span class="w">                                   </span><span class="na">Text=</span><span class="s">&quot;{x:Bind Title}&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">                    </span><span class="nt">&lt;/Border&gt;</span>
<span class="w">                </span><span class="nt">&lt;/Grid&gt;</span>
<span class="w">            </span><span class="nt">&lt;/DataTemplate&gt;</span>
<span class="w">        </span><span class="nt">&lt;/GridView.ItemTemplate&gt;</span>
<span class="w">        </span><span class="nt">&lt;GridView.GroupStyle&gt;</span>
<span class="w">            </span><span class="nt">&lt;GroupStyle&gt;</span>
<span class="w">                </span><span class="nt">&lt;GroupStyle.HeaderTemplate&gt;</span>
<span class="w">                    </span><span class="nt">&lt;DataTemplate</span><span class="w"> </span><span class="na">x:DataType=</span><span class="s">&quot;models:RecipeGroup&quot;</span><span class="nt">&gt;</span>
<span class="w">                        </span><span class="nt">&lt;TextBlock</span><span class="w"> </span><span class="na">Margin=</span><span class="s">&quot;0&quot;</span>
<span class="w">                                   </span><span class="na">Style=</span><span class="s">&quot;{ThemeResource TitleTextBlockStyle}&quot;</span>
<span class="w">                                   </span><span class="na">Text=</span><span class="s">&quot;{x:Bind Title}&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">                    </span><span class="nt">&lt;/DataTemplate&gt;</span>
<span class="w">                </span><span class="nt">&lt;/GroupStyle.HeaderTemplate&gt;</span>
<span class="w">            </span><span class="nt">&lt;/GroupStyle&gt;</span>
<span class="w">        </span><span class="nt">&lt;/GridView.GroupStyle&gt;</span>
<span class="w">    </span><span class="nt">&lt;/controls:AdaptiveGridView&gt;</span>
<span class="nt">&lt;/Grid&gt;</span>
</code></pre></div>
<p>Vegyük fel a következő névteret (ebben vannak a modell osztályaink):</p>
<div class="highlight"><pre><span></span><code>`xmlns:models=&quot;using:MvvmLab.Core.Models&quot;`
</code></pre></div>
<p><strong>Próbáljuk ki az alkalmazást!</strong> Győződjünk meg róla, hogy a recept csoportok megjelennek a főoldalon.</p>
<h2 id="2-feladat-recept-reszletes-oldal">2. Feladat - Recept részletes oldal<a class="headerlink" href="#2-feladat-recept-reszletes-oldal" title="Permanent link">&para;</a></h2>
<p>A receptek részletes oldalának elkészítése a következő lépésekből fog állni:</p>
<ol>
<li>Kiegészítjük az <code>IRecipeService</code> interfészt egy <code>GetRecipeAsync</code> metódussal, és létrehozzuk a szükséges osztályokat</li>
<li>Létrehozzuk a <code>RecipeDetailPageViewModel</code> ViewModel-t, amiben lekérdezzük a recept adatait a <code>RecipeDetailPageViewModel</code>-ben az <code>IRecipeService</code>-en keresztül (a VM az azonosítót kapja meg a navigáció során)</li>
<li>Létrehozzuk a <code>RecipeDetailPage</code> nézetet, építve a ViewModel adataira</li>
<li>Regisztráljuk a ViewModel-t és a nézetet a Dependency Injection konfigurációhoz és a navigációhoz</li>
<li>Átnavigálunk a <code>RecipeDetailPage</code>-re a <code>MainPageViewModel</code>-ből a receptre történő kattintásra az <code>INavigationService</code> segítségével, és átadjuk a kiválasztott recept azonosítóját a részletes oldalnak</li>
</ol>
<h3 id="21-recept-lekerdezese">2.1 Recept lekérdezése<a class="headerlink" href="#21-recept-lekerdezese" title="Permanent link">&para;</a></h3>
<p>Hozzuk létre a  <code>Recipe</code> osztályt a <code>MvvmLab.Core.Model</code> névtérbe, és generáljuk le a tartalmát a <code>/api/recipes/{id}</code> végpont által visszaadott példa JSON adatokból, a fent megismert módszerrel (Paste special).</p>
<div class="highlight"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">Recipe</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">Id</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">BackgroundImage</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">Title</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="kt">string</span><span class="p">[]</span><span class="w"> </span><span class="n">ExtraImages</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="kt">string</span><span class="p">[]</span><span class="w"> </span><span class="n">Ingredients</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">Directions</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="n">Comment</span><span class="p">[]</span><span class="w"> </span><span class="n">Comments</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">Comment</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">Name</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">Text</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>A "Paste Special" során fontos, hogy olyan receptet tegyünk előtte a vágólapra, melyhez tartozik megjegyzés (különben a <code>Comment</code> osztály nem fog legenerálódni, illetve a <code>Recipe</code> osztályban a <code>Comments</code> típusának <code>object[]</code> típus generálódik). Érdemes ehhez a swagger leírás "Example value" mezőjéből a vágólapra másolni a mintát!</p>
</div>
<p>A <code>IRecipeService</code> interfészt és implementációját egészítsük ki egy <code>GetRecipeAsync</code> metódussal, mely egy receptet ad vissza az azonosítója alapján.</p>
<div class="highlight"><span class="filename">IRecipeService</span><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="n">Task</span><span class="o">&lt;</span><span class="n">Recipe</span><span class="o">&gt;</span><span class="w"> </span><span class="n">GetRecipeAsync</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="p">);</span>
</code></pre></div>
<div class="highlight"><span class="filename">RecipeService</span><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="n">Task</span><span class="o">&lt;</span><span class="n">Recipe</span><span class="o">&gt;</span><span class="w"> </span><span class="n">GetRecipeAsync</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="nn">var</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HttpClient</span><span class="p">();</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="n">client</span><span class="p">.</span><span class="n">GetFromJsonAsync</span><span class="o">&lt;</span><span class="n">Recipe</span><span class="o">&gt;</span><span class="p">(</span><span class="s">$&quot;{_baseUrl}/Recipes/{id}&quot;</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="22-recept-reszletes-viewmodel">2.2 Recept részletes ViewModel<a class="headerlink" href="#22-recept-reszletes-viewmodel" title="Permanent link">&para;</a></h3>
<p>A ViewModel készítése a főoldalhoz képest már ujjgyakorlat (alapvetően annak mintájára lehet dolgozni). Hozzuk létre a <code>RecipeDetailPageViewModel</code> osztályt az <code>MvvmLab.ViewModels</code> mappában.</p>
<p>A ViewModel-nek szüksége lesz egy <code>IRecipeService</code> interfészt implementáló osztályra, amelyen keresztül le tudja kérdezni a receptet. A <code>RecipeDetailPageViewModel</code> konstruktorában DI segítségével szerezzük be a szükséges függőséget.</p>
<div class="highlight"><pre><span></span><code><span class="k">private</span><span class="w"> </span><span class="k">readonly</span><span class="w"> </span><span class="n">IRecipeService</span><span class="w"> </span><span class="n">_recipeService</span><span class="p">;</span>

<span class="k">public</span><span class="w"> </span><span class="nf">RecipeDetailPageViewModel</span><span class="p">(</span><span class="n">IRecipeService</span><span class="w"> </span><span class="n">recipeService</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">_recipeService</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">recipeService</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>A <code>RecipeDetailPageViewModel</code>-ben hozzunk létre egy <code>_recipe</code> nevű <code>Recipe</code> típusú változót, amelyben tárolni fogjuk a receptet.
A változót attributáljuk fel a <code>ObservableProperty</code> attribútummal, mely alapján az MVVM Toolkit automatikusan generálni fogja a <code>Recipe</code> nevű property-t az osztály másik generált partial felében.
Ehhez szükséges, hogy az osztály az <code>ObservableObject</code> osztályból származzon, publikus legyen és a <code>partial</code> kulcsszóval legyen ellátva.</p>
<div class="highlight"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="k">partial</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">RecipeDetailPageViewModel</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ObservableObject</span>
<span class="p">{</span>
<span class="w">    </span><span class="c1">// ...</span>

<span class="w">    </span><span class="na">[ObservableProperty]</span>
<span class="w">    </span><span class="k">private</span><span class="w"> </span><span class="n">Recipe</span><span class="w"> </span><span class="n">_recipe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="p">();</span>
</code></pre></div>
<p>Implementáljuk a <code>RecipeDetailPageViewModel</code>-ben az előkészített <code>INavigationAware</code> interfészt.
Arra készülünk, hogy a navigációs paraméterként a megjeleníteni kívánt recept azonosítóját fogjuk megkapni.
A <code>OnNavigatedTo</code> metódusban kérdezzük le a receptet a <code>RecipeService</code>-en keresztül, majd tároljuk el a <code>Recipe</code> tulajdonságban.</p>
<div class="highlight"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="k">partial</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">RecipeDetailPageViewModel</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ObservableObject</span><span class="p">,</span><span class="w"> </span><span class="n">INavigationAware</span>
<span class="p">{</span>
<span class="w">    </span><span class="c1">// ...</span>

<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">OnNavigatedTo</span><span class="p">(</span><span class="kt">object</span><span class="w"> </span><span class="n">parameter</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">Recipe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="n">_recipeService</span><span class="p">.</span><span class="n">GetRecipeAsync</span><span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">parameter</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">OnNavigatedFrom</span><span class="p">()</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A <code>OnNavigatedTo</code> művelet fejlécében használni kellett az <code>async</code> kulcsszót, mert használtuk az <code>await</code>-et a törzsében.</p>
</div>
<h3 id="23-recept-reszletes-oldal-navigacio">2.3 Recept részletes oldal, navigáció<a class="headerlink" href="#23-recept-reszletes-oldal-navigacio" title="Permanent link">&para;</a></h3>
<p>Hozzunk létre egy új oldalt <code>RecipeDetailPage</code> néven a <code>Views</code> mappába (<em>Views mappán jobb gomb / Add New Item / Blank Page (WinUI 3)</em>), amelyen megjelenítjük a receptet. Első körben csak a recept címét jelenítsük meg egy <code>TextBlock</code>-ban.</p>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;Grid</span><span class="w"> </span><span class="na">x:Name=</span><span class="s">&quot;ContentArea&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Grid.RowDefinitions&gt;</span>
<span class="w">        </span><span class="nt">&lt;RowDefinition</span><span class="w"> </span><span class="na">Height=</span><span class="s">&quot;48&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;RowDefinition</span><span class="w"> </span><span class="na">Height=</span><span class="s">&quot;*&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/Grid.RowDefinitions&gt;</span>

<span class="w">    </span><span class="nt">&lt;TextBlock</span><span class="w"> </span><span class="na">Grid.Row=</span><span class="s">&quot;0&quot;</span>
<span class="w">               </span><span class="na">Style=</span><span class="s">&quot;{StaticResource PageTitleStyle}&quot;</span>
<span class="w">               </span><span class="na">Text=</span><span class="s">&quot;{x:Bind ViewModel.Recipe.Title, Mode=OneWay}&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="nt">&lt;/Grid&gt;</span>
</code></pre></div>
<p>Az adatkötéshez vegyük fel a <code>RecipeDetailPage.xaml.cs</code>-ben a <code>ViewModel</code> property-t a főoldal mintájára.</p>
<div class="highlight"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="n">RecipeDetailPageViewModel</span><span class="w"> </span><span class="n">ViewModel</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">RecipeDetailPageViewModel</span><span class="p">)</span><span class="n">DataContext</span><span class="p">;</span>
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Fordítási hibák</p>
<p>Ha valamiért egzotikus hibákat kapnánk az új oldal felvétele után töröljük ki a projekt fájlból az alábbi sorokat:</p>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;ItemGroup&gt;</span>
<span class="w">    </span><span class="nt">&lt;None</span><span class="w"> </span><span class="na">Remove=</span><span class="s">&quot;Views\RecipeDetailPage.xaml&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ItemGroup&gt;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;Page</span><span class="w"> </span><span class="na">Update=</span><span class="s">&quot;Views\RecipeDetailPage.xaml&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Generator&gt;</span>MSBuild:Compile<span class="nt">&lt;/Generator&gt;</span>
<span class="nt">&lt;/Page&gt;</span>
</code></pre></div>
</div>
<p>A navigáció támogatásához a <code>Services</code> mappában lévő <code>PageService</code>-ben regisztráljuk be a <code>RecipeDetailPage</code>-et az alábbi 3 lépésben:</p>
<ol>
<li>
<p>Vegyük fel a nézet kulcsát a <code>Pages</code> osztályba.</p>
<div class="highlight"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">Pages</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">Main</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Main&quot;</span><span class="p">;</span>
<span class="hll"><span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">Detail</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Detail&quot;</span><span class="p">;</span>
</span><span class="p">}</span>
</code></pre></div>
</li>
<li>
<p>Regisztráljuk a nézetet és ViewModel kapcsolatot a <code>PageService</code>-ben.</p>
<div class="highlight"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="nf">PageService</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">Configure</span><span class="o">&lt;</span><span class="n">MainPageViewModel</span><span class="p">,</span><span class="w"> </span><span class="n">MainPage</span><span class="o">&gt;</span><span class="p">(</span><span class="n">Pages</span><span class="p">.</span><span class="n">Main</span><span class="p">);</span>
<span class="hll"><span class="w">    </span><span class="n">Configure</span><span class="o">&lt;</span><span class="n">RecipeDetailPageViewModel</span><span class="p">,</span><span class="w"> </span><span class="n">RecipeDetailPage</span><span class="o">&gt;</span><span class="p">(</span><span class="n">Pages</span><span class="p">.</span><span class="n">Detail</span><span class="p">);</span>
</span><span class="p">}</span>
</code></pre></div>
</li>
<li>
<p>Az <code>App.xaml.cs</code> fájlban a <code>ConfigureServices</code> metódusban regisztráljuk be a ViewModel-t és a nézetet a Dependency Injection konténerbe.</p>
<div class="highlight"><pre><span></span><code><span class="n">services</span><span class="p">.</span><span class="n">AddTransient</span><span class="o">&lt;</span><span class="n">RecipeDetailPage</span><span class="o">&gt;</span><span class="p">();</span>
<span class="n">services</span><span class="p">.</span><span class="n">AddTransient</span><span class="o">&lt;</span><span class="n">RecipeDetailPageViewModel</span><span class="o">&gt;</span><span class="p">();</span>
</code></pre></div>
</li>
</ol>
<p>Ezekre azért van szükség, mert a projekt sablonban lévő <code>INavigationService</code> alapvetően egy kulccsal azonosítja a nézeteket, annak érdekében, hogy a ViewModel-ben ne legyen szükség a nézet típusának ismeretére.
A kulcs alapján pedig ki tudja keresni, hogy pontosan melyik Viewt kell megjeleníteni, és melyik ViewModel-t kell példányosítani a nézet <code>DataContext</code>-jébe a DI konténerből.</p>
<p>A <code>MainPageViewModel</code>-ben injektáljuk be az <code>INavigationService</code>-t, amelyen keresztül navigálni fogunk a <code>RecipeDetailPage</code>-re.</p>
<div class="highlight"><pre><span></span><code><span class="k">private</span><span class="w"> </span><span class="k">readonly</span><span class="w"> </span><span class="n">INavigationService</span><span class="w"> </span><span class="n">_navigationService</span><span class="p">;</span>

<span class="k">public</span><span class="w"> </span><span class="nf">MainPageViewModel</span><span class="p">(</span><span class="n">IRecipeService</span><span class="w"> </span><span class="n">recipeService</span><span class="p">,</span><span class="w"> </span><span class="n">INavigationService</span><span class="w"> </span><span class="n">navigationService</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">_recipeService</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">recipeService</span><span class="p">;</span>
<span class="w">    </span><span class="n">_navigationService</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">navigationService</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<h4 id="command">Command<a class="headerlink" href="#command" title="Permanent link">&para;</a></h4>
<p>Eddig az MVVM minta egyik oldalával foglalkoztunk: hogyan éri el adatkötéssel és jeleníti meg a View a ViewModel-ben levő adatokat. Ugyanakkor, a View és ViewModel között általában van egy másik kapcsolat is: ez arról szól, hogy a View eseményei (pl. kattintás) hogyan hatnak vissza a ViewModel-re. Most ezzel fogunk foglalkozni.</p>
<p>Esetünkben pl. meg kell oldani, hogy a főoldali nézeten egy Recepten történő kattintás eljusson a <code>MainPageViewModel</code>-hez, és az ennek hatására átnavigáljon az adott recept részletes nézetére.</p>
<p>A ViewModel a végrehajtható műveleteket az MVVM mintában tipikusan <code>ICommand</code> interfészt megvalósító objektumokon keresztül publikálja (amelyek a konkrét művelet végrehajtásán túl kezelhetik a művelet végrehajtásának feltételeit is).</p>
<p>A <code>MainPageViewModel</code>-ben készítsünk egy Commandot, mely a receptre kattintva fog lefutni. A Command paraméterként megkapja a kiválasztott recept fejlécet, és átnavigál a <code>RecipeDetailPage</code>-re, ahol átadásra kerül a kiválasztott recept azonosítója.</p>
<p>Most létre kellene hozzunk egy úgy, <code>ICommand</code> interfészt implementáló osztályt, majd ebből fel kellene vegyünk egy példányt (tulajdonságot) a ViewModel-be. Ezt a két lépést az MVVM toolkit leegyszerűsíti, csak egy <code>[RelayCommand]</code> attribútummal ellátott függvényt kell felvegyünk a ViewModelbe:</p>
<div class="highlight"><pre><span></span><code><span class="na">[RelayCommand]</span>
<span class="k">private</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">RecipeSelected</span><span class="p">(</span><span class="n">RecipeHeader</span><span class="w"> </span><span class="n">recipe</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">_navigationService</span><span class="p">.</span><span class="n">NavigateTo</span><span class="p">(</span><span class="n">Pages</span><span class="p">.</span><span class="n">Detail</span><span class="p">,</span><span class="w"> </span><span class="n">recipe</span><span class="p">.</span><span class="n">Id</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>Ennek hatására a compiler legenerálja a command osztályt és a tulajdonságot a ViewModel-be <code>RecipeSelectedCommand</code> néven.</p>
<p><img alt="❗" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2757.svg" title=":exclamation:" /> A parancs és a ViewModel elő van készítve, de a View még semmit nem tud a parancsról. A ViewModel-ben levő commandunkat a szokásos technikákkal rá kell kössük a View megfelelő eseményére. MVVM esetén mindig így használjuk a Command mintát! A megközelítés szépsége az, hogy ez teljesen a szokásos, View-&gt;ViewModel irányú adatkötéssel történik (amit már eddig is többször használtunk).</p>
<p>Ennek megfelelően a <code>MainPage</code>-en kössük a <code>AdaptiveGridView</code> <code>ItemClickCommand</code> tulajdonságát a <code>RecipeSelectedCommand</code>-ra.</p>
<div class="highlight"><pre><span></span><code>ItemClickCommand=&quot;{x:Bind<span class="w"> </span>ViewModel.RecipeSelectedCommand}&quot;
</code></pre></div>
<p><strong>Próbáljuk ki az alkalmazást!</strong> Győződjünk meg róla, hogy a receptekre kattintva megjelenik a recept részletes oldala.</p>
<details class="tip">
<summary>Kitekintés: Ha nincs a használni kívánt eseményre Command?</summary>
<p>Ha a vezérlő bizonyos eseményekre biztosít Commandot, akkor viszonylag egyszerű dolgunk van, amire fentebb láthattunk egy példát.
Azonban, ha a vezérlő nem biztosít Commandot (pl.: a beépített <code>GridView.ItemClicked</code>), akkor több lehetőségünk is van:</p>
<ol>
<li>
<p><strong>Code-Behind "ragasztó kód":</strong> A vezérlő eseményét kezeljük le, és a code-behindban (xaml.cs) ViewModel-ben hívjuk meg a megfelelő metódust/commadot.</p>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;controls:AdaptiveGridView</span><span class="w"> </span><span class="na">x:Name=</span><span class="s">&quot;gridView&quot;</span>
<span class="w">                            </span><span class="na">ItemsSource=</span><span class="s">&quot;{x:Bind RecipeGroupsCollectionSource.View, Mode=OneWay}&quot;</span>
<span class="w">                            </span><span class="na">IsItemClickEnabled=</span><span class="s">&quot;True&quot;</span>
<span class="w">                            </span><span class="na">ItemClick=</span><span class="s">&quot;GridView_ItemClick&quot;</span><span class="nt">&gt;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="k">private</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">GridView_ItemClick</span><span class="p">(</span><span class="kt">object</span><span class="w"> </span><span class="n">sender</span><span class="p">,</span><span class="w"> </span><span class="n">ItemClickEventArgs</span><span class="w"> </span><span class="n">e</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">ViewModel</span><span class="p">.</span><span class="n">RecipeSelectedCommand</span><span class="p">.</span><span class="n">Execute</span><span class="p">((</span><span class="n">RecipeHeader</span><span class="p">)</span><span class="n">e</span><span class="p">.</span><span class="n">ClickedItem</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</li>
<li>
<p><strong>x:Bind esemény kötés</strong>: használjuk az <code>x:Bind</code> metódus kötési lehetőségét, amelynek segítségével a vezérlő eseményét tudjuk kötni a ViewModel-ben lévő <strong>metódusra</strong>.
   A metódusnak viszont ilyenkor vagy paraméter nélkülinek kell lennie, vagy olyan paramétereket kell fogadnia, amely az esemény szignatúrájára illeszkedik.</p>
<div class="highlight"><span class="filename">View - MainPage.xaml</span><pre><span></span><code><span class="nt">&lt;controls:AdaptiveGridView</span><span class="w"> </span><span class="na">x:Name=</span><span class="s">&quot;gridView&quot;</span>
<span class="w">                            </span><span class="na">ItemsSource=</span><span class="s">&quot;{x:Bind RecipeGroupsCollectionSource.View, Mode=OneWay}&quot;</span>
<span class="w">                            </span><span class="na">IsItemClickEnabled=</span><span class="s">&quot;True&quot;</span>
<span class="w">                            </span><span class="na">ItemClick=</span><span class="s">&quot;{x:Bind ViewModel.RecipeSelected&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;/controls:AdaptiveGridView&gt;</span>
</code></pre></div>
<div class="highlight"><span class="filename">ViewModel - MainPageViewModel</span><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">RecipeSelected</span><span class="p">(</span><span class="kt">object</span><span class="w"> </span><span class="n">sender</span><span class="p">,</span><span class="w"> </span><span class="n">ItemClickEventArgs</span><span class="w"> </span><span class="n">e</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="p">...</span>
<span class="p">}</span>
</code></pre></div>
<p>Ennek a módszernek a hátránya, hogy a esemény paramétereivel a ViewModel-be a nézet keretrendszer függőségeit is beviszi (eseménykezelő paraméter típusok), pedig az alap gondolatunk az volt, hogy a ViewModel független legyen a nézettől. Természetesen ez a módszer is jól tud működni, ha részben feladjuk az MVVM minta szigorú betartását.</p>
</li>
<li>
<p>A Behavior-ök segítségével, azon belül is az <code>EventTriggerBehavior</code> és <code>InvokeCommandAction</code> osztályokkal tudunk Commandot kötni tetszőleges vezérlő eseményre.</p>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;controls:AdaptiveGridView</span><span class="w"> </span><span class="na">x:Name=</span><span class="s">&quot;gridView&quot;</span>
<span class="w">                            </span><span class="na">ItemsSource=</span><span class="s">&quot;{x:Bind RecipeGroupsCollectionSource.View, Mode=OneWay}&quot;</span>
<span class="w">                            </span><span class="na">IsItemClickEnabled=</span><span class="s">&quot;True&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;i:Interaction.Behaviors&gt;</span>
<span class="w">        </span><span class="nt">&lt;c:EventTriggerBehavior</span><span class="w"> </span><span class="na">EventName=</span><span class="s">&quot;ItemClick&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;c:InvokeCommandAction</span><span class="w"> </span><span class="na">Command=</span><span class="s">&quot;{x:Bind ViewModel.RecipeSelectedCommand}&quot;</span><span class="w"> </span>
<span class="w">                                   </span><span class="na">InputConverter=</span><span class="s">&quot;{StaticResource ItemClickedInputConverter}&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;/c:EventTriggerBehavior&gt;</span>
<span class="w">    </span><span class="nt">&lt;/i:Interaction.Behaviors&gt;</span>
</code></pre></div>
<p>Ezzel szinte teljesen deklaratívvá tudjuk tenni hagyni a nézetet, de még így is készítenünk kell egy <code>ItemClickedInputConverter</code> osztályt, amely az esemény paramétereit átalakítja a megfelelő típusra az <code>IValueConverter</code> interfész segítségével.</p>
<div class="highlight"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">ItemClickedInputConverter</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">IValueConverter</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="kt">object</span><span class="w"> </span><span class="nf">Convert</span><span class="p">(</span><span class="kt">object</span><span class="w"> </span><span class="k">value</span><span class="p">,</span><span class="w"> </span><span class="n">Type</span><span class="w"> </span><span class="n">targetType</span><span class="p">,</span><span class="w"> </span><span class="kt">object</span><span class="w"> </span><span class="n">parameter</span><span class="p">,</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">language</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">RecipeHeader</span><span class="p">)((</span><span class="k">value</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">ItemClickEventArgs</span><span class="p">)</span><span class="o">?.</span><span class="n">ClickedItem</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="kt">object</span><span class="w"> </span><span class="nf">ConvertBack</span><span class="p">(</span><span class="kt">object</span><span class="w"> </span><span class="k">value</span><span class="p">,</span><span class="w"> </span><span class="n">Type</span><span class="w"> </span><span class="n">targetType</span><span class="p">,</span><span class="w"> </span><span class="kt">object</span><span class="w"> </span><span class="n">parameter</span><span class="p">,</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">language</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">NotImplementedException</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>A behavior-ök egyébként egy teljesen általános mechanizmus a XAML világban, amelyek segítségével a nézetekhez tudunk újrafelhasználható viselkedést hozzáadni (bővebben <a href="https://github.com/Microsoft/XamlBehaviors">itt</a>).</p>
</li>
</ol>
</details>
<h3 id="24-recept-reszletes-nezet">2.4 Recept részletes nézet<a class="headerlink" href="#24-recept-reszletes-nezet" title="Permanent link">&para;</a></h3>
<p>A recept részletes adatainak megjelenítéséhez egy <code>Grid</code>-et használjunk, amelynek két oszlopa van.
Az első oszlopban egy <code>ScrollViewer</code>-t helyezzünk el, amelybe egy <code>StackPanel</code> kerül.
A <code>StackPanel</code>-ben helyezzünk el egy <code>FlipView</code>-t, amelyben a recept képeit fogjuk megjeleníteni.
A <code>FlipView</code> egy listaként működik, de az elemeit egy lapozható felületen jeleníti meg.</p>
<p>A <code>FlipView</code> alatt lesz található el egy <code>ItemsControl</code> (egyszerű lista, mely nem támogat görgetést, kiválasztást, kattintást stb.), amelyben a recept hozzávalóit fogjuk megjeleníteni.</p>
<p>Ez alá kerül egy <code>TextBlock</code>, amelybe a recept elkészítésének lépései kerülnek.</p>
<p>A második oszlopba helyezzünk el egy <code>Grid</code>-et, amelybe kommentek listája és beviteli mezői fognak kerülni.</p>
<p>Az alábbi kódot a labor során nyugodtan másolhatjuk a <code>RecipeDetailPage.xaml</code> fájlba, újdonság ebben a kódban nincs az eddigiekhez képest.</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;</span>
<span class="nt">&lt;Page</span><span class="w"> </span><span class="na">x:Class=</span><span class="s">&quot;MvvmLab.Views.RecipeDetailPage&quot;</span>
<span class="w">      </span><span class="na">xmlns=</span><span class="s">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span>
<span class="w">      </span><span class="na">xmlns:x=</span><span class="s">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span>
<span class="w">      </span><span class="na">xmlns:d=</span><span class="s">&quot;http://schemas.microsoft.com/expression/blend/2008&quot;</span>
<span class="w">      </span><span class="na">xmlns:local=</span><span class="s">&quot;using:MvvmLab.Views&quot;</span>
<span class="w">      </span><span class="na">xmlns:mc=</span><span class="s">&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot;</span>
<span class="w">      </span><span class="na">xmlns:models=</span><span class="s">&quot;using:MvvmLab.Core.Models&quot;</span>
<span class="w">      </span><span class="na">Background=</span><span class="s">&quot;{ThemeResource ApplicationPageBackgroundThemeBrush}&quot;</span>
<span class="w">      </span><span class="na">mc:Ignorable=</span><span class="s">&quot;d&quot;</span><span class="nt">&gt;</span>

<span class="w">    </span><span class="nt">&lt;Grid</span><span class="w"> </span><span class="na">x:Name=</span><span class="s">&quot;ContentArea&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;Grid.RowDefinitions&gt;</span>
<span class="w">            </span><span class="nt">&lt;RowDefinition</span><span class="w"> </span><span class="na">Height=</span><span class="s">&quot;Auto&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;RowDefinition</span><span class="w"> </span><span class="na">Height=</span><span class="s">&quot;*&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;/Grid.RowDefinitions&gt;</span>

<span class="w">        </span><span class="nt">&lt;TextBlock</span><span class="w"> </span><span class="na">Grid.Row=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">Padding=</span><span class="s">&quot;10&quot;</span>
<span class="w">                   </span><span class="na">Style=</span><span class="s">&quot;{StaticResource TitleTextBlockStyle}&quot;</span>
<span class="w">                   </span><span class="na">Text=</span><span class="s">&quot;{x:Bind ViewModel.Recipe.Title, Mode=OneWay}&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>

<span class="w">        </span><span class="nt">&lt;Grid</span><span class="w"> </span><span class="na">Grid.Row=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;Grid.ColumnDefinitions&gt;</span>
<span class="w">                </span><span class="nt">&lt;ColumnDefinition</span><span class="w"> </span><span class="na">Width=</span><span class="s">&quot;3*&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">                </span><span class="nt">&lt;ColumnDefinition</span><span class="w"> </span><span class="na">Width=</span><span class="s">&quot;*&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;/Grid.ColumnDefinitions&gt;</span>

<span class="w">            </span><span class="nt">&lt;ScrollViewer</span><span class="w"> </span><span class="na">Grid.Column=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">Padding=</span><span class="s">&quot;20 10 0 20&quot;</span><span class="nt">&gt;</span>
<span class="w">                </span><span class="nt">&lt;StackPanel</span><span class="w"> </span><span class="na">Orientation=</span><span class="s">&quot;Vertical&quot;</span><span class="nt">&gt;</span>
<span class="w">                    </span><span class="nt">&lt;StackPanel</span><span class="w"> </span><span class="na">x:Name=</span><span class="s">&quot;images&quot;</span>
<span class="w">                                </span><span class="na">Margin=</span><span class="s">&quot;0,0,24,0&quot;</span>
<span class="w">                                </span><span class="na">Orientation=</span><span class="s">&quot;Vertical&quot;</span><span class="nt">&gt;</span>
<span class="w">                        </span><span class="nt">&lt;TextBlock</span><span class="w"> </span><span class="na">Margin=</span><span class="s">&quot;0,0,0,12&quot;</span>
<span class="w">                                   </span><span class="na">Style=</span><span class="s">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span>
<span class="w">                                   </span><span class="na">Text=</span><span class="s">&quot;Images&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">                        </span><span class="nt">&lt;FlipView</span><span class="w"> </span><span class="na">x:Name=</span><span class="s">&quot;flipView&quot;</span>
<span class="w">                                  </span><span class="na">MaxHeight=</span><span class="s">&quot;250&quot;</span>
<span class="w">                                  </span><span class="na">VerticalAlignment=</span><span class="s">&quot;Top&quot;</span>
<span class="w">                                  </span><span class="na">ItemsSource=</span><span class="s">&quot;{x:Bind ViewModel.Recipe.ExtraImages, Mode=OneWay}&quot;</span><span class="nt">&gt;</span>
<span class="w">                            </span><span class="nt">&lt;FlipView.ItemTemplate&gt;</span>
<span class="w">                                </span><span class="nt">&lt;DataTemplate&gt;</span>
<span class="w">                                    </span><span class="nt">&lt;Image</span><span class="w"> </span><span class="na">Source=</span><span class="s">&quot;{Binding}&quot;</span><span class="w"> </span><span class="na">Stretch=</span><span class="s">&quot;Uniform&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">                                </span><span class="nt">&lt;/DataTemplate&gt;</span>
<span class="w">                            </span><span class="nt">&lt;/FlipView.ItemTemplate&gt;</span>
<span class="w">                        </span><span class="nt">&lt;/FlipView&gt;</span>
<span class="w">                    </span><span class="nt">&lt;/StackPanel&gt;</span>

<span class="w">                    </span><span class="nt">&lt;StackPanel</span><span class="w"> </span><span class="na">x:Name=</span><span class="s">&quot;ingredients&quot;</span>
<span class="w">                                </span><span class="na">Margin=</span><span class="s">&quot;0,0,24,0&quot;</span>
<span class="w">                                </span><span class="na">Orientation=</span><span class="s">&quot;Vertical&quot;</span><span class="nt">&gt;</span>
<span class="w">                        </span><span class="nt">&lt;TextBlock</span><span class="w"> </span><span class="na">Margin=</span><span class="s">&quot;0,0,0,12&quot;</span>
<span class="w">                                   </span><span class="na">Style=</span><span class="s">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span>
<span class="w">                                   </span><span class="na">Text=</span><span class="s">&quot;Ingredients&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">                        </span><span class="nt">&lt;ItemsControl</span><span class="w"> </span><span class="na">HorizontalAlignment=</span><span class="s">&quot;Left&quot;</span><span class="w"> </span><span class="na">ItemsSource=</span><span class="s">&quot;{x:Bind ViewModel.Recipe.Ingredients, Mode=OneWay}&quot;</span><span class="nt">&gt;</span>
<span class="w">                            </span><span class="nt">&lt;ItemsControl.ItemTemplate&gt;</span>
<span class="w">                                </span><span class="nt">&lt;DataTemplate&gt;</span>
<span class="w">                                    </span><span class="nt">&lt;TextBlock</span><span class="w"> </span><span class="na">Margin=</span><span class="s">&quot;0,0,0,10&quot;</span>
<span class="w">                                               </span><span class="na">Text=</span><span class="s">&quot;{Binding}&quot;</span>
<span class="w">                                               </span><span class="na">TextWrapping=</span><span class="s">&quot;Wrap&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">                                </span><span class="nt">&lt;/DataTemplate&gt;</span>
<span class="w">                            </span><span class="nt">&lt;/ItemsControl.ItemTemplate&gt;</span>
<span class="w">                        </span><span class="nt">&lt;/ItemsControl&gt;</span>
<span class="w">                    </span><span class="nt">&lt;/StackPanel&gt;</span>

<span class="w">                    </span><span class="nt">&lt;StackPanel</span><span class="w"> </span><span class="na">x:Name=</span><span class="s">&quot;directions&quot;</span>
<span class="w">                                </span><span class="na">Margin=</span><span class="s">&quot;0,0,24,0&quot;</span>
<span class="w">                                </span><span class="na">Orientation=</span><span class="s">&quot;Vertical&quot;</span>
<span class="w">                                </span><span class="na">RelativePanel.RightOf=</span><span class="s">&quot;ingredients&quot;</span><span class="nt">&gt;</span>
<span class="w">                        </span><span class="nt">&lt;TextBlock</span><span class="w"> </span><span class="na">Margin=</span><span class="s">&quot;0,0,0,12&quot;</span>
<span class="w">                                   </span><span class="na">Style=</span><span class="s">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span>
<span class="w">                                   </span><span class="na">Text=</span><span class="s">&quot;Directions&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">                        </span><span class="nt">&lt;TextBlock</span><span class="w"> </span><span class="na">HorizontalAlignment=</span><span class="s">&quot;Left&quot;</span>
<span class="w">                                   </span><span class="na">Text=</span><span class="s">&quot;{x:Bind ViewModel.Recipe.Directions, Mode=OneWay}&quot;</span>
<span class="w">                                   </span><span class="na">TextWrapping=</span><span class="s">&quot;Wrap&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">                    </span><span class="nt">&lt;/StackPanel&gt;</span>
<span class="w">                </span><span class="nt">&lt;/StackPanel&gt;</span>
<span class="w">            </span><span class="nt">&lt;/ScrollViewer&gt;</span>

<span class="w">            </span><span class="nt">&lt;Grid</span><span class="w"> </span><span class="na">Grid.Column=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="na">RowSpacing=</span><span class="s">&quot;12&quot;</span><span class="nt">&gt;</span>
<span class="w">                </span><span class="nt">&lt;Grid.RowDefinitions&gt;</span>
<span class="w">                    </span><span class="nt">&lt;RowDefinition</span><span class="w"> </span><span class="na">Height=</span><span class="s">&quot;Auto&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">                    </span><span class="nt">&lt;RowDefinition</span><span class="w"> </span><span class="na">Height=</span><span class="s">&quot;*&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">                    </span><span class="nt">&lt;RowDefinition</span><span class="w"> </span><span class="na">Height=</span><span class="s">&quot;Auto&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">                </span><span class="nt">&lt;/Grid.RowDefinitions&gt;</span>

<span class="w">                </span><span class="nt">&lt;TextBlock</span><span class="w"> </span><span class="na">Grid.Row=</span><span class="s">&quot;0&quot;</span>
<span class="w">                           </span><span class="na">Style=</span><span class="s">&quot;{StaticResource SubtitleTextBlockStyle}&quot;</span>
<span class="w">                           </span><span class="na">Text=</span><span class="s">&quot;Comments&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>

<span class="w">                </span><span class="nt">&lt;ListView</span><span class="w"> </span><span class="na">Grid.Row=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="na">ItemsSource=</span><span class="s">&quot;{x:Bind ViewModel.Recipe.Comments, Mode=OneWay}&quot;</span><span class="nt">&gt;</span>
<span class="w">                    </span><span class="nt">&lt;ListView.ItemTemplate&gt;</span>
<span class="w">                        </span><span class="nt">&lt;DataTemplate</span><span class="w"> </span><span class="na">x:DataType=</span><span class="s">&quot;models:Comment&quot;</span><span class="nt">&gt;</span>
<span class="w">                            </span><span class="nt">&lt;StackPanel</span><span class="w"> </span><span class="na">Orientation=</span><span class="s">&quot;Vertical&quot;</span><span class="w"> </span><span class="na">Padding=</span><span class="s">&quot;0 5 0 5&quot;</span><span class="nt">&gt;</span>
<span class="w">                                </span><span class="nt">&lt;TextBlock</span><span class="w"> </span><span class="na">FontWeight=</span><span class="s">&quot;Bold&quot;</span><span class="w"> </span><span class="na">Text=</span><span class="s">&quot;{x:Bind Name}&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">                                </span><span class="nt">&lt;TextBlock</span><span class="w"> </span><span class="na">Text=</span><span class="s">&quot;{x:Bind Text}&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">                            </span><span class="nt">&lt;/StackPanel&gt;</span>
<span class="w">                        </span><span class="nt">&lt;/DataTemplate&gt;</span>
<span class="w">                    </span><span class="nt">&lt;/ListView.ItemTemplate&gt;</span>
<span class="w">                </span><span class="nt">&lt;/ListView&gt;</span>

<span class="w">                </span><span class="nt">&lt;StackPanel</span><span class="w"> </span><span class="na">x:Name=</span><span class="s">&quot;comments&quot;</span>
<span class="w">                            </span><span class="na">Grid.Row=</span><span class="s">&quot;2&quot;</span>
<span class="w">                            </span><span class="na">Margin=</span><span class="s">&quot;24,0,24,0&quot;</span>
<span class="w">                            </span><span class="na">Orientation=</span><span class="s">&quot;Vertical&quot;</span><span class="nt">&gt;</span>
<span class="w">                    </span><span class="cm">&lt;!-- TODO input fields for comments --&gt;</span>
<span class="w">                </span><span class="nt">&lt;/StackPanel&gt;</span>
<span class="w">            </span><span class="nt">&lt;/Grid&gt;</span>
<span class="w">        </span><span class="nt">&lt;/Grid&gt;</span>
<span class="w">    </span><span class="nt">&lt;/Grid&gt;</span>
<span class="nt">&lt;/Page&gt;</span>
</code></pre></div>
<p><strong>Próbáljuk ki az alkalmazást!</strong></p>
<h2 id="3-feladat-kommentek-hozzaadasa">3. Feladat - Kommentek hozzáadása<a class="headerlink" href="#3-feladat-kommentek-hozzaadasa" title="Permanent link">&para;</a></h2>
<p>Ha jól állunk idővel, készítsünk funkciót a kommentek hozzáadásához a recept részletes oldalán.</p>
<h3 id="webszolgaltatas">Webszolgáltatás<a class="headerlink" href="#webszolgaltatas" title="Permanent link">&para;</a></h3>
<p>Az <code>IRecipeService</code> interfészt és implementációt egészítsük ki egy <code>SendCommentAsync</code> metódussal, mely egy kommentet küld a szervernek a <code>POST /Recipes/{recipeId}/Comments</code> végpontra.</p>
<div class="highlight"><span class="filename">IRecipeService</span><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="n">Task</span><span class="w"> </span><span class="nf">SendCommentAsync</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">recipeId</span><span class="p">,</span><span class="w"> </span><span class="n">Comment</span><span class="w"> </span><span class="n">comment</span><span class="p">);</span>
</code></pre></div>
<div class="highlight"><span class="filename">RecipeService</span><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="n">Task</span><span class="w"> </span><span class="nf">SendCommentAsync</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">recipeId</span><span class="p">,</span><span class="w"> </span><span class="n">Comment</span><span class="w"> </span><span class="n">comment</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="nn">var</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HttpClient</span><span class="p">();</span>
<span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="n">client</span><span class="p">.</span><span class="n">PostAsJsonAsync</span><span class="p">(</span><span class="s">$&quot;{_baseUrl}/Recipes/{recipeId}/Comments&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">comment</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="viewmodel">ViewModel<a class="headerlink" href="#viewmodel" title="Permanent link">&para;</a></h3>
<p>A <code>RecipeDetailPageViewModel</code>-ben hozzunk létre egy <code>NewCommentText</code> nevű <code>string</code> típusú tulajdonságot és egy <code>NewCommentName</code> <code>string</code> tulajdonságot, melyekben tárolni fogjuk a felhasználó által megadott komment adatait. Használjuk az <code>ObservableProperty</code> attribútumot!</p>
<div class="highlight"><pre><span></span><code><span class="na">[ObservableProperty]</span>
<span class="k">private</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">_newCommentName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>

<span class="na">[ObservableProperty]</span>
<span class="k">private</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">_newCommentText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>
</code></pre></div>
<p>A <code>RecipeDetailPageViewModel</code>-ben hozzunk létre egy <code>SendComment</code> nevű függvényt, amelyen keresztül a felhasználó által megadott kommentet tudjuk elküldeni a szervernek.
A függvényből generáltassunk egy Commandot az MVVM Toolkit segítségével (<code>[RelayCommand]</code>).</p>
<p>Az implementáció egyszerű: elküldjük a kommentet a szervernek, majd frissítjük a receptet.</p>
<div class="highlight"><pre><span></span><code><span class="na">[RelayCommand]</span>
<span class="k">private</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="n">Task</span><span class="w"> </span><span class="nf">SendComment</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="n">_recipeService</span><span class="p">.</span><span class="n">SendCommentAsync</span><span class="p">(</span><span class="n">Recipe</span><span class="p">.</span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Comment</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">Name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NewCommentName</span><span class="p">,</span>
<span class="w">        </span><span class="n">Text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NewCommentText</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">NewCommentName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>
<span class="w">    </span><span class="n">NewCommentText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>

<span class="w">    </span><span class="n">Recipe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="n">_recipeService</span><span class="p">.</span><span class="n">GetRecipeAsync</span><span class="p">(</span><span class="n">Recipe</span><span class="p">.</span><span class="n">Id</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>A nézeten a következő elemeket helyezzük el a kommentek hozzáadásához:</p>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;StackPanel</span><span class="w"> </span><span class="na">x:Name=</span><span class="s">&quot;comments&quot;</span>
<span class="w">            </span><span class="na">Grid.Row=</span><span class="s">&quot;2&quot;</span>
<span class="w">            </span><span class="na">Margin=</span><span class="s">&quot;24,0,24,0&quot;</span>
<span class="w">            </span><span class="na">Orientation=</span><span class="s">&quot;Vertical&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;TextBox</span><span class="w"> </span><span class="na">Margin=</span><span class="s">&quot;0,0,0,16&quot;</span>
<span class="w">             </span><span class="na">Header=</span><span class="s">&quot;Name&quot;</span>
<span class="w">             </span><span class="na">Text=</span><span class="s">&quot;{x:Bind ViewModel.NewCommentName, Mode=TwoWay}&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;TextBox</span><span class="w"> </span><span class="na">Margin=</span><span class="s">&quot;0,0,0,16&quot;</span>
<span class="w">             </span><span class="na">Header=</span><span class="s">&quot;Comment&quot;</span>
<span class="w">             </span><span class="na">Text=</span><span class="s">&quot;{x:Bind ViewModel.NewCommentText, Mode=TwoWay}&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Button</span><span class="w"> </span><span class="na">Margin=</span><span class="s">&quot;0,0,0,16&quot;</span>
<span class="w">            </span><span class="na">HorizontalAlignment=</span><span class="s">&quot;Right&quot;</span>
<span class="w">            </span><span class="na">Command=</span><span class="s">&quot;{x:Bind ViewModel.SendCommentCommand}&quot;</span>
<span class="w">            </span><span class="na">Content=</span><span class="s">&quot;Send&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="nt">&lt;/StackPanel&gt;</span>
</code></pre></div>
<p>Vegyük észre, hogy a <code>TextBox</code>-ok <code>Text</code> property-jét kétirányú kötéssel kötöttük a ViewModel-ben lévő <code>NewCommentName</code> és <code>NewCommentText</code> tulajdonságokhoz, és a gomb Command-ját is a ViewModel-ben lévő <code>SendCommentCommand</code> tulajdonsághoz kötöttük.</p>
<h2 id="kitekintes-commandok-vegrehajtasanak-feltetelei">Kitekintés: Commandok végrehajtásának feltételei<a class="headerlink" href="#kitekintes-commandok-vegrehajtasanak-feltetelei" title="Permanent link">&para;</a></h2>
<p>A <code>SendCommentCommand</code> Command végrehajtásának feltétele, hogy a <code>NewCommentName</code> és a <code>NewCommentText</code> tulajdonságok ne legyenek üresek.
A Commandok lehetőséget adnak arra, hogy a végrehajtásukat feltételekhez kössük, amelyeket a <code>CanExecute</code> metódusban tudunk megadni.
Esetünkben egy <code>bool</code>-lal visszatérő metódus/property nevet kell megadnunk a Command generátor attribútumnak.</p>
<div class="highlight"><span class="filename">RecipeDetailPageViewModel-ben:</span><pre><span></span><code><span class="k">private</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">CanExecuteSendComment</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="o">!</span><span class="kt">string</span><span class="p">.</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="n">NewCommentName</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="kt">string</span><span class="p">.</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="n">NewCommentText</span><span class="p">);</span>

<span class="na">[RelayCommand(CanExecute = nameof(CanExecuteSendComment))]</span>
<span class="k">private</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="n">Task</span><span class="w"> </span><span class="nf">SendComment</span><span class="p">()</span>
</code></pre></div>
<p><strong>Próbáljuk ki.</strong> Azt tapasztaljuk, hogy a gomb nem lesz engedélyezve, viszont a <code>TextBox</code>-ok módosítása után sem változik a gomb állapota.</p>
<p>A <code>CanExecute</code> metódus akkor hívódik meg (akkor hívják a vezérlők), amikor a Command elsüti a <code>CanExecuteChanged</code> eseményt.
Esetünkben ezt az eseményt a <code>NewCommentName</code> és a <code>NewCommentText</code> tulajdonságok <code>PropertyChanged</code> eseményének kiváltásakor kell kiváltani.
Erre az MVVM Toolkit egy külön attribútumot biztosít (<code>[NotifyCanExecuteChangedFor]</code>), amelyet a <code>NewCommentName</code> és a <code>NewCommentText</code> tulajdonságokra kell rárakni.</p>
<p>Tehát, ha a <code>NewCommentName</code> vagy a <code>NewCommentText</code> tulajdonság értéke megváltozik, akkor a <code>SendCommentCommand</code> Command <code>CanExecuteChanged</code> eseményét is kiváltjuk, ami miatt a <code>CanExecute</code> metódus újra lefut, és a gomb állapota is frissül.</p>
<div class="highlight"><pre><span></span><code><span class="na">[ObservableProperty]</span>
<span class="na">[NotifyCanExecuteChangedFor(nameof(SendCommentCommand))]</span>
<span class="k">private</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">_newCommentName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>

<span class="na">[ObservableProperty]</span>
<span class="na">[NotifyCanExecuteChangedFor(nameof(SendCommentCommand))]</span>
<span class="k">private</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">_newCommentText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>
</code></pre></div>
<p><strong>Próbáljuk ki.</strong></p>
<p>Már csak egy dolog van hátra: jelenleg a <code>TextBox</code> állapota csak akkor változik, ha a felhasználó elhagyja a <code>TextBox</code>-ot.
Ezt a viselkedést az adatkötés <code>UpdateSourceTrigger</code> tulajdonságán keresztül tudjuk módosítani.</p>
<div class="highlight"><pre><span></span><code>Text=&quot;{x:Bind<span class="w"> </span>ViewModel.NewCommentName,<span class="w"> </span>Mode=TwoWay,<span class="w"> </span>UpdateSourceTrigger=PropertyChanged}&quot;

Text=&quot;{x:Bind<span class="w"> </span>ViewModel.NewCommentText,<span class="w"> </span>Mode=TwoWay,<span class="w"> </span>UpdateSourceTrigger=PropertyChanged}&quot;
</code></pre></div>
<p><strong>Próbáljuk ki.</strong></p>
<hr>
<div class="md-source-file">
  <span class="md-source-file__fact"> <span class="md-icon" title="Utolsó frissítés"> <svg
        xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
        <path
          d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z">
        </path>
      </svg>
    </span>
    <span title="2025. március 7. 11:48:58">
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago" title="2025. március 7. 11:48:58 CET"><span class="timeago" datetime="2025-03-07T11:48:58+01:00" locale="hu"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="2025. március 7. 11:48:58 CET">2025-03-07</span>
    </span>
  </span>

  

  <span class="md-source-file__fact">
    <span class="md-icon" title="Szerzők">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
        <path
          d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2Z">
        </path>
      </svg>
    </span>
    <span>Szerzők</span>
    <nav><a href="https://github.com/tibitoth" target="_blank" rel="noopener noreferrer" class="md-author" title="@tibitoth">
        <img src="https://avatars.githubusercontent.com/tibitoth?size=72" alt="@tibitoth">
      </a><a href="https://github.com/bzolka" target="_blank" rel="noopener noreferrer" class="md-author" title="@Zoltán Benedek">
        <img src="https://avatars.githubusercontent.com/u/22932444?u=a3e164177137cbef68f0e72985785b0795ac7565&v=4?size=72" alt="@Zoltán Benedek">
      </a></nav>      
  </span>
</div>




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Vissza a tetejére
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; BME VIK AUT
    </div>
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.instant", "navigation.top", "search.suggest", "content.action.edit", "toc.follow"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "V\u00e1g\u00f3lapra m\u00e1solva", "clipboard.copy": "M\u00e1sol\u00e1s v\u00e1g\u00f3lapra", "search.result.more.one": "1 tov\u00e1bbi tal\u00e1lat az oldalon", "search.result.more.other": "# tov\u00e1bbi tal\u00e1lat az oldalon", "search.result.none": "Nincs tal\u00e1lat", "search.result.one": "1 egyez\u0151 dokumentum", "search.result.other": "# egyez\u0151 dokumentum", "search.result.placeholder": "Keres\u00e9shez \u00edrj ide valamit", "search.result.term.missing": "\u00dcres", "select.version": "Verzi\u00f3v\u00e1lt\u00e1s"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.8fd75fb4.min.js"></script>
      
        <script src="../../js/timeago.min.js"></script>
      
        <script src="../../js/timeago_mkdocs_material.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>