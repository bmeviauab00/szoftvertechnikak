
<!DOCTYPE html>

<html class="no-js" lang="hu">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Benedek Zoltán" name="author"/>
<link href="../5-adatkezeles/" rel="prev"/>
<link href="../7-tervezesi-mintak/" rel="next"/>
<link href="../../img/favicon.ico" rel="icon"/>
<meta content="mkdocs-1.4.2, mkdocs-material-9.0.12" name="generator"/>
<title>6. Document-View architektúra - BMEVIAUAB00 Szoftvertechnikák</title>
<link href="../../assets/stylesheets/main.0d440cfe.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.2505c338.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="../../css/timeago.css" rel="stylesheet"/>
<link href="../../extra-material-theme.css" rel="stylesheet"/>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            
                .gscrollbar-fixer { padding-right: 15px; }
                .gdesc-inner { font-size: 0.75rem; }
                body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
                body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
                body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
                </style><script src="../../assets/javascripts/glightbox.min.js"></script></head>
<body data-md-color-accent="red" data-md-color-primary="aut" data-md-color-scheme="aut" dir="ltr">
<script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#6-document-view-architektura">
          Kihagyás
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Élőfej" class="md-header__inner md-grid">
<a aria-label="BMEVIAUAB00 Szoftvertechnikák" class="md-header__button md-logo" data-md-component="logo" href="../.." title="BMEVIAUAB00 Szoftvertechnikák">
<img alt="logo" src="../../img/logo-bme-aut.png"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            BMEVIAUAB00 Szoftvertechnikák
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              6. Document-View architektúra
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Váltás sötét témára" class="md-option" data-md-color-accent="red" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="aut" data-md-color-scheme="aut" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_2" hidden="" title="Váltás sötét témára">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5Z"></path></svg>
</label>
<input aria-label="Váltás világos témára" class="md-option" data-md-color-accent="" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="red" data-md-color-scheme="slate" id="__palette_2" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Váltás világos témára">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1Z"></path></svg>
</label>
</form>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Keresés" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Keresés" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="Keresés" class="md-search__options">
<button aria-label="Törlés" class="md-search__icon md-icon" tabindex="-1" title="Törlés" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
<div class="md-search__suggest" data-md-component="search-suggest"></div>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Keresés inicializálása
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/bmeviauab00/szoftvertechnikak" title="Főoldalra ugrás">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg>
</div>
<div class="md-source__repository">
    bmeviauab00/szoftvertechnikak
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<nav aria-label="Lapok" class="md-tabs" data-md-component="tabs">
<div class="md-tabs__inner md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../..">
      Szoftvertechnikák
    </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link md-tabs__link--active" href="../1-model-es-kod-kapcsolata/">
        Laborok
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../hazi/">
        Önálló/házi feladatok
      </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigáció" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="BMEVIAUAB00 Szoftvertechnikák" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="BMEVIAUAB00 Szoftvertechnikák">
<img alt="logo" src="../../img/logo-bme-aut.png"/>
</a>
    BMEVIAUAB00 Szoftvertechnikák
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/bmeviauab00/szoftvertechnikak" title="Főoldalra ugrás">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg>
</div>
<div class="md-source__repository">
    bmeviauab00/szoftvertechnikak
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../..">
        Szoftvertechnikák
      </a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Laborok
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
          Laborok
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../1-model-es-kod-kapcsolata/">
        1. A modell és a kód kapcsolata
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../2-nyelvi-eszkozok/">
        2. Nyelvi eszközök
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../3-felhasznaloi-felulet/">
        3. A felhasználói felület kialakítása
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../4-tobbszalu/">
        4. Többszálú alkalmazások készítése
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../5-adatkezeles/">
        5. Adatkezelés
      </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
          6. Document-View architektúra
          <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
        6. Document-View architektúra
      </a>
<nav aria-label="Tartalomjegyzék" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Tartalomjegyzék
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#a-gyakorlat-celja">
    A gyakorlat célja
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#elofeltetelek">
    Előfeltételek
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#a-gyakorlat-menete">
    A gyakorlat menete
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#1-feladat-a-feladat-ismertetese">
    1. Feladat - A feladat ismertetése
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#2-feladat-az-alkalmazas-megtervezese">
    2. Feladat - Az alkalmazás megtervezése
  </a>
<nav aria-label="2. Feladat - Az alkalmazás megtervezése" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#document-view-architektura">
    Document-View architektúra
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#konkret-dokumentum-es-adatai">
    Konkrét dokumentum és adatai
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#dokumentumok-menedzselese-app-singleton-osztaly">
    Dokumentumok menedzselése - App Singleton osztály
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#nezetek">
    Nézetek
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#3-feladat-a-kesz-alkalmazas-attekintese">
    3. Feladat - A kész alkalmazás áttekintése
  </a>
<nav aria-label="3. Feladat - A kész alkalmazás áttekintése" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#nezetek-megvalositasa">
    Nézetek megvalósítása
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#egy-oldal-tab-elrendezese">
    Egy oldal (tab) elrendezése
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#forgatokonyv-1-egy-pixel-invertalasa-nezetek-szinkronizalasa">
    Forgatókönyv 1 – Egy pixel invertálása, nézetek szinkronizálása
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#forgatokonyv-2-uj-dokumentum-letrehozasa-opcionalis">
    Forgatókönyv 2 – Új dokumentum létrehozása (opcionális)
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../7-tervezesi-mintak/">
        7. Tervezési minták
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Önálló/házi feladatok
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
          Önálló/házi feladatok
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../hazi/">
        Útmutató
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../hazi/meghirdetes-elott/">
        1. HF - A modell és a kód kapcsolata
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../hazi/meghirdetes-elott/">
        2. HF - Nyelvi eszközök
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../hazi/meghirdetes-elott/">
        3. HF - Felhasználói felület kialakítása
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../hazi/meghirdetes-elott/">
        4. HF - Többszálú alkalmazások fejlesztése
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../hazi/meghirdetes-elott/">
        5. HF - Document-View architektúra
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../hazi/fejlesztokornyezet/">
        Fejlesztőkörnyezet
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Tartalomjegyzék" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Tartalomjegyzék
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#a-gyakorlat-celja">
    A gyakorlat célja
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#elofeltetelek">
    Előfeltételek
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#a-gyakorlat-menete">
    A gyakorlat menete
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#1-feladat-a-feladat-ismertetese">
    1. Feladat - A feladat ismertetése
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#2-feladat-az-alkalmazas-megtervezese">
    2. Feladat - Az alkalmazás megtervezése
  </a>
<nav aria-label="2. Feladat - Az alkalmazás megtervezése" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#document-view-architektura">
    Document-View architektúra
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#konkret-dokumentum-es-adatai">
    Konkrét dokumentum és adatai
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#dokumentumok-menedzselese-app-singleton-osztaly">
    Dokumentumok menedzselése - App Singleton osztály
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#nezetek">
    Nézetek
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#3-feladat-a-kesz-alkalmazas-attekintese">
    3. Feladat - A kész alkalmazás áttekintése
  </a>
<nav aria-label="3. Feladat - A kész alkalmazás áttekintése" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#nezetek-megvalositasa">
    Nézetek megvalósítása
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#egy-oldal-tab-elrendezese">
    Egy oldal (tab) elrendezése
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#forgatokonyv-1-egy-pixel-invertalasa-nezetek-szinkronizalasa">
    Forgatókönyv 1 – Egy pixel invertálása, nézetek szinkronizálása
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#forgatokonyv-2-uj-dokumentum-letrehozasa-opcionalis">
    Forgatókönyv 2 – Új dokumentum létrehozása (opcionális)
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<a class="md-content__button md-icon" href="https://github.com/bmeviauab00/szoftvertechnikak/edit/master/docs/labor/6-doc-view/index.md" title="Oldal szerkesztése">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"></path></svg>
</a>
<h1 id="6-document-view-architektura">6. Document-View architektúra<a class="headerlink" href="#6-document-view-architektura" title="Permanent link">¶</a></h1>
<h2 id="a-gyakorlat-celja">A gyakorlat célja<a class="headerlink" href="#a-gyakorlat-celja" title="Permanent link">¶</a></h2>
<p>A gyakorlat céljai:</p>
<ul>
<li>UML alapú tervezés és néhány tervezési minta alkalmazása</li>
<li>A Document-View architektúra alkalmazása a gyakorlatban</li>
<li>UserControl szerepének bemutatása Window Forms alkalmazásokban, Document-View architektúra esetén</li>
<li>A grafikus megjelenítés elveinek gyakorlása Window Forms alkalmazásokban (<code>Paint</code> esemény, <code>Invalidate</code>, <code>Graphics</code> használata)</li>
</ul>
<p>A kapcsolódó előadások és korábbi gyakorlatok anyaga:</p>
<ul>
<li>UML alapú modellezés (1. gyakorlat)</li>
<li>Windows Forms alkalmazásfejlesztés</li>
<li>Szoftverarchitektúrák (Document-View architektúra)</li>
</ul>
<h2 id="elofeltetelek">Előfeltételek<a class="headerlink" href="#elofeltetelek" title="Permanent link">¶</a></h2>
<p>A gyakorlat elvégzéséhez szükséges eszközök:</p>
<ul>
<li>Visual Studio 2022</li>
<li>Windows 10 vagy Windows 11 operációs rendszer (Linux és macOS nem alkalmas)</li>
</ul>
<h2 id="a-gyakorlat-menete">A gyakorlat menete<a class="headerlink" href="#a-gyakorlat-menete" title="Permanent link">¶</a></h2>
<p>Az alábbiak szerint fogunk dolgozni:</p>
<ul>
<li>A feladat/célok rövid ismertetése: egy interaktív fonteditor (betűtípus-szerkesztő) megtervezése</li>
<li>A kész alkalmazást futtatva a feladat (a kész alkalmazás működésének) ismertetése</li>
<li>Az alkalmazás architektúrájának megtervezése (osztálydiagram elkészítése)</li>
<li>A kész alkalmazás forráskódjának alapján néhány fontosabb forgatókönyv megvalósításának áttekintése</li>
</ul>
<details class="note">
<summary>Megjegyzés gyakorlatvezetők számára</summary>
<p>A gyakorlat elején töltsük le a kész alkalmazást. A hallgatók ekkor még ne töltsék le, ne ezt kattintgassák, majd csak a gyakorlat második részében. A gyakorlatvezetőknek viszont szüksége lesz rá, mert ennek segítségével történik a feladat bemutatása.</p>
</details>
<h2 id="1-feladat-a-feladat-ismertetese">1. Feladat - A feladat ismertetése<a class="headerlink" href="#1-feladat-a-feladat-ismertetese" title="Permanent link">¶</a></h2>
<p>Interaktív FontEditor (betűtípus szerkesztő) készítése, amelyben lehet szerkeszteni a karaktereket, és az aktuális betűkészlet alapján tetszőleges példaszöveg megjeleníthető. Az alkalmazás felhasználói felülete futás közben:</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="100%" href="images/fonteditor-app-intro.png"><img alt="A FontEditor alkalmazás felülete" src="images/fonteditor-app-intro.png"/></a></p>
<p>A következő funkciókat kell támogatnia:</p>
<ul>
<li>Több betűtípus egyidejű szerkesztése. Ez egyes betűtípusok külön tab oldalakon szerkeszthetők (MDI – Multiple Document Interface).</li>
<li>Új betűtípus a <em>File/New</em> menüelem kiválasztásával hozható létre (meg kell adni a nevét).</li>
<li>Ez egyes betűtípusok elmenthetők (<em>File/Save</em>), betölthetők (<em>File/Open</em>), és az aktuális dokumentum bezárható (<em>File/Close</em>). Ezek helye megvan az alkalmazásban, de nincsenek részleteiben implementálva (a függvények törzse nincs kitöltve – opcionális HF).</li>
<li>A felhasználói felület felépítése<ul>
<li>Az oldal tetején (Sample text) egy mintaszöveg adható meg, melyet az aktuális betűtípussal az alkalmazás megjelenít.</li>
<li>Az oldalak közepén egy karaktersáv található. Egy adott karakteren duplán kattintva alatta megjelenik egy, az adott karakterhez tartozó szerkesztőnézet.</li>
<li>Az oldal alján egymás mellett az eddig szerkesztésre megnyitott karakterek szerkesztőnézetei láthatók. Egy karakter többször is megnyitható szerkesztésre, ez esetben több szerkesztőnézet jön létre hozzá. Ennek az az értelme, hogy ugyanazt a karaktert különböző nagyítással is láthatjuk/szerkeszthetjük.</li>
</ul>
</li>
<li>A szerkesztőnézetek felépítése<ul>
<li>Nagy része (eltekintve a felső sáv) a szerkesztőfelület, ahol fekete háttéren sárgával jelennek meg az aktív pixelek. Egy adott pixelen az egérrel kattintva a pixel invertálódik.</li>
<li>Bal felső sarokban a megjelenített karakter látható</li>
<li>’c’ gomb: Clear, minden aktív pixelt töröl</li>
<li>’+’ gomb: nagyítás</li>
<li>’-’ gomb: kicsinyítés</li>
</ul>
</li>
</ul>
<p>Futtassuk az alkalmazást, és vizsgáljuk meg a működését a fentieknek megfelelően. Azt mindenképpen nézzük meg, hogy ha egy karakter szerepel a mintaszövegben, valamint többször megnyitjuk szerkesztésre, akkor <strong>az egyik nézetben változtatva (egy pixelt invertálva) valamennyi nézete frissül</strong>.</p>
<p>Az alkalmazás a kódmennyiség minimális értéken tartása érdekében minimalisztikus, pl. a hibakezelés nincs általánosságában kidolgozva, hiányoznak ellenőrzések. Ugyanakkor kódmegjegyzésekkel el van látva, mely segíti a kód utólagos megértését.</p>
<h2 id="2-feladat-az-alkalmazas-megtervezese">2. Feladat - Az alkalmazás megtervezése<a class="headerlink" href="#2-feladat-az-alkalmazas-megtervezese" title="Permanent link">¶</a></h2>
<p>A cél az, hogy lássuk, milyen folyamatot követve, milyen lépésekben dolgozunk, mikor milyen tervezői lépéseket kell meghoznunk. Törekedjünk oktatói és hallgatói részről is az interaktivitásra, közösen hozzuk meg a döntéseket.</p>
<p>Hozzunk létre egy új C# nyelvű „Window Form App” projektet (.NET 6-osat), legyen a neve FontEditor. Vegyünk fel egy osztálydiagramot: projekten jobb katt, <em>Add / New Item</em>, majd a megjelenő ablakban <em>Class Diagram</em> kiválasztása, a neve maradhat az alapértelmezett. Állítsuk be, hogy a diagram mutassa majd a műveletek szignatúráit is (pl. jobb katt a háttéren, <em>Change Members Format / Display Full Signature</em>). A gyakorlat nagy részében ezt a diagramot fogjuk szerkeszteni.</p>
<p>A kész osztálydiagram a következő, eddig fogunk fokozatosan eljutni:</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="100%" href="images/ClassDiagram.png"><img alt="ClassDiagram" src="images/ClassDiagram.png"/></a></p>
<h3 id="document-view-architektura">Document-View architektúra<a class="headerlink" href="#document-view-architektura" title="Permanent link">¶</a></h3>
<p>Az első tervezői döntés: architektúrát kell választani. A Document-View esetünkben egyértelmű választás: dokumentumokkal dolgozunk, és több nézettel, melyeket szinkronban kell tartani. Az alábbi ábra ismerteti a működést. A nézetek az <strong>observerek</strong>, a document pedig a <strong>subject</strong>, melynek változásaira az egyes nézetek fel vannak iratkozva.</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="100%" href="images/DocView.png"><img alt="DocView" src="images/DocView.png"/></a></p>
<p>A D-V architektúrából adódóan szükségünk lesz dokumentum osztályra, amely a dokumentum adatait tárolja (tagváltozókban), mint pl. a név, elérési út, pixelmátrix. Tegyük fel, hogy a későbbiekben több dokumentum típust is támogatni kell majd: pl. megnyithatunk egy olyan tabfület, melyen a BKK járművekhez tudjuk rendelni a betűtípusokat (elektronikus kijelző). Vannak olyan dokumentum adatok, melyek minden dokumentum típusban megjelennek (pl. név, elérési út). <strong>Az egyes dokumentum típusoknak a közös tulajdonságait/műveleteit célszerű egy <code>Document</code> ősosztályba kiszervezni</strong>, hogy ne legyenek duplikálva az egyes dokumentum típusokat reprezentáló dokumentum osztályokban.</p>
<ul>
<li>Vegyük fel a <code>Document</code> osztályt (ez az absztrakt ős).</li>
<li>Vegyünk fel bele egy <code>string Name</code> property-t (ez jelenik meg a tabfüleken).</li>
</ul>
<p>A Document-View architektúrából adódóan szükség van egy <strong>nézet interfészre</strong> (egy <code>Update</code> művelettel a nézet értesítéséhez), valamint a dokumentumoknak nyilván kell tartaniuk egy listában a nézeteiket:</p>
<ul>
<li>Vegyük fel az <code>IView</code> interfészt.</li>
<li>Vegyünk fel bele egy <code>Update</code> műveletet.</li>
<li>A <code>Document</code> osztályba vegyünk fel egy <code>List&lt;IView&gt; views</code> mezőt (a Fields-nél). Jobb gombbal kattintsunk a mező nevén a diagramon, és a menüből <em>Show as collection association</em> kiválasztása.</li>
<li>A <code>Document</code> osztályba vegyünk fel a <code>void AttachView(IView view)</code> műveletet, mellyel új nézetet lehet beregisztrálni.</li>
<li>Végül vegyünk fel egy <code>void DetachView(IView view)</code>-t, mert nézetet bezárni is lehet.</li>
</ul>
<p>Támogatnunk kell az egyes <strong>dokumentumok tartalmának perzisztálását</strong> (mentés/betöltés). Ezekhez vegyünk fel a <code>Document</code> ősbe a megfelelő műveleteket:</p>
<ul>
<li><code>Document</code>-be <code>LoadDocument(string path)</code> felvétele.</li>
<li><code>Document</code>-be <code>SaveDocument(string path)</code> felvétele.</li>
<li>Mindkettő legyen absztrakt, hiszen csak az egyes dokumentum leszármazottakban tudunk implementációt megadni: szelektáljuk ki a két műveletet, és a <em>Properties</em> ablakban az <em>Inheritence modifier</em> legyen <em>Abstract</em>.</li>
</ul>
<p>Az egyes <strong>dokumentumoknak támogatniuk kell a nézeteik frissítését</strong>, ez minden dokumentum típusra közös:</p>
<ul>
<li>A <code>Document</code>-be vegyük fel az <code>UpdateAllViews()</code>-t (ez felel meg az Observer minta Notify műveletének).</li>
</ul>
<h3 id="konkret-dokumentum-es-adatai">Konkrét dokumentum és adatai<a class="headerlink" href="#konkret-dokumentum-es-adatai" title="Permanent link">¶</a></h3>
<p>Szükség van egy <strong>olyan dokumentum típusra, ami a betűtípusok szerkesztéséhez tartozik</strong>, amely a tagváltozóiban nyilvántartja a szükséges adatokat: legyen a neve <code>FontEditorDocument</code>.</p>
<ul>
<li>Vegyük fel a <code>FontEditorDocument</code> osztályt.</li>
<li>Származtassuk a <code>Document</code>-ből (Toolbox – Inheritence kapcsolat).</li>
<li>Ekkor a <code>LoadDocument</code> és <code>SaveDocument</code> műveletekre automatikusan megszületik az override-oló művelet. Ha mégsem lenne így<ul>
<li>Jelöljük ki az ősben a két műveletet.</li>
<li>Copy</li>
<li>Jelöljük ki a <code>FontEditorDocument</code> osztályt.</li>
<li>Paste</li>
<li>Jelöljük itt ki a két műveletet, és a <em>Properties</em> ablakban a <em>Instance Modifier</em> legyen <code>override</code>.</li>
</ul>
</li>
</ul>
<p><strong>A dokumentumunk tagváltozókban tárolja az adatokat.</strong> Gondoljuk át, hogy ezt hogyan célszerű megvalósítani. Lehetne egy háromdimenziós tömb (karakter – x – y), de inkább emeljük ki egy <strong>külön osztályba az egy adott karakter pixeleinek tárolását/menedzselését</strong>: vezessük be a <code>CharDef</code> osztályt.</p>
<div class="admonition note">
<p class="admonition-title">Pixel tömb helyett</p>
<p>Azért nem a pixeltömböt használjuk közvetlenül, mert csak egy új osztály bevezetésével van lehetőségünk kifejezetten ide tartozó műveletek bevezetésére, vagyis az egységbezárás korrekt megvalósítására.</p>
</div>
<ul>
<li>Vegyük fel a <code>CharDef</code> osztályt.</li>
<li>
<p><code>CharDef</code>-be <code>bool[,] Pixels</code> tulajdonság felvétele.</p>
<div class="admonition tip">
<p class="admonition-title">többdimenzoós tömbök C#-ban</p>
<p>A fenti példában egy többdimenziós tömböt használtunk <code>bool[,]</code> és nem tömbök tömbjét <code>bool[][]</code>, mivel ezt nyelvi szinten is támogatja a C# és jobb teljesítményt nyújt, mint a tömbök tömbje, mert egy objektumként törolódik a heapen.</p>
</div>
</li>
<li>
<p><code>CharDef</code>-be <code>char Character</code> felvétele: az egyes <code>CharDef</code> osztályok tárolják magukról, hogy mely karakter pixeleit reprezentálják.</p>
</li>
</ul>
<p>A dokumentumnak lesz egy gyűjteménye <code>CharDef</code> objektumokból: minden karakterhez pontosan egy darab. Gondoljuk át, hogy a legcélszerűbb ezt megvalósítani. Az egyes karakterdefiníciókat a karakterkódjukkal akarjuk címezni, így a <code>Dictionary&lt;char, CharDef&gt;</code> ideális választás: a karakterkód a kulcs, az hozzá tartozó <code>CharDef</code> pedig az érték.</p>
<ul>
<li><code>FontEditorDocument</code>-be: <code>Dictionary&lt;char, CharDef&gt; charDefs</code> mező felvétele. Jobb katt, <em>Show as collection association</em>.</li>
</ul>
<h3 id="dokumentumok-menedzselese-app-singleton-osztaly">Dokumentumok menedzselése - App Singleton osztály<a class="headerlink" href="#dokumentumok-menedzselese-app-singleton-osztaly" title="Permanent link">¶</a></h3>
<p>Az alkalmazásban nyilván kell tartani a megnyitott dokumentumok listáját. Mely osztály felelőssége legyen? Vezessünk be rá egy <strong>alkalmazásszintű osztályt</strong>: legyen a neve <code>App</code> (Windows Forms alatt már van <code>Application</code>, nem célszerű ezt a nevet választani). Ez lesz az alkalmazásunk „gyökérosztálya”.</p>
<ul>
<li>Vegyük fel az <code>App</code> osztályt.</li>
<li><code>App</code>-ba <code>List&lt;FontEditorDocument&gt; documents</code> mező felvétele, majd <em>Show as collection association</em>.</li>
</ul>
<p>Gondoljuk végig, hogyan történik majd egy <strong>új dokumentum létrehozása</strong> (mi történik a <em>File/New</em> menüelem kiválasztásakor): be kell kérni a felhasználótól a dokumentum nevét, létre kell hozni egy <code>FontEditorDocument</code> objektumot, fel kell venni a megnyitott dokumentumok listájába stb. Ezt a logikát ne tegyük a GUI-ba (menüelem click eseménykezelő): tegyük abba az osztályba, melynek a felelőssége a megnyitott dokumentumok menedzselése, amely tárolja a szükséges adatokat hozzá (dokumentum lista). Így legyen ez az <code>App</code> osztályunk feladata, benne vegyük fel a szükséges műveleteket:</p>
<ul>
<li><code>App</code>-ba <code>NewDocument</code> és <code>OpenDocument</code> műveletek felvétele.</li>
</ul>
<p>Most a <strong>dokumentum mentést</strong> gondoljuk végig: a <em>File/Save</em> mindig az aktív dokumentumra vonatkozik. Valakinek <strong>nyilván kell tartani, melyik az aktív dokumentum</strong>: legyen ez az <code>App</code>, hiszen ő tárolja a dokumentumok listáját is.</p>
<ul>
<li>A Toolbox-on válasszuk ki az Association kapcsolatot. Az <code>App</code>-ból húzzunk egy nyilat a <code>FontEditorDocument</code>-be. Válasszuk ki az újonnan létrehozott kapcsolatot, és nevezzük át <code>ActiveDocument</code>-re.</li>
<li><code>App</code>-ba <code>void SaveActiveDocument()</code> felvétele.</li>
<li><code>App</code>-ba <code>void CloseActiveDocumentá()</code> felvétele.</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Konkrét dokumentumra vagy absztrakt ősre hivatkozzunk?</p>
<p>Mivel az <code>App</code> osztályunk alkalmazás specifikus funkciókat lát el, nyugodtan hivatkozhat a konkrét dokumentum típusra, és felesleges az absztrakt őstől függenünk, mert az csak nem kívánt castolásokhoz vezetne.</p>
</div>
<p>Az <code>App</code> objektumból <strong>értelemszerűen csak egyet kell/szabad létrehozni</strong>, amely a futó alkalmazást reprezentálja. Van még egy problémánk: a <em>File/Save</em> stb. menüelem click eseménykezelőben el kell érjük ezt az egy objektumot. Illetve, majd több más helyen is. Jó lenne, ha nem kellene minden osztályban külön elérhetővé tenni (tagváltozó vagy függvényparaméter formájában), hanem <strong>bárhonnan egyszerűen</strong> elérhető lenne. Erre nyújt megoldást a <strong>Singleton tervezési minta</strong>. Egy osztályból csak egy objektumot enged létrehozni, és ahhoz globális hozzáférést biztosít, mégpedig az osztály nevén és egy statikus <code>Instance</code> property-n keresztül, pl. így:
<code>App.Instance.SaveDocument</code>, stb. Nem valósítjuk meg teljes értékűen, de tegyük meg az alábbiakat:</p>
<ul>
<li><code>App</code>-ba <code>App Instance</code> property felvétele. Properties ablakban <em>static: true</em>.</li>
<li><code>App</code>-ba privát konstruktor felvétele.</li>
</ul>
<p>Az <code>App</code>-osztállyal végeztünk.</p>
<h3 id="nezetek">Nézetek<a class="headerlink" href="#nezetek" title="Permanent link">¶</a></h3>
<p>A nézetekkel eddig nem foglalkoztunk, ez a következő lépés. Futtassuk a kész alkalmazást, és nézzük meg, hogy <strong>hány típusú nézetre van szükség</strong>, melyikből hány <strong>példány</strong> lesz:</p>
<ul>
<li>Két <strong>típusú</strong> nézetre van szükség: az egyik a mintaszöveget jeleníti meg, a másik egy adott karakter szerkesztését teszi lehetővé.</li>
<li>Legyen az előző neve <code>SampleTextView</code>, az utóbbié <code>FontEditorView</code>.</li>
<li><code>SampleTextView</code>-ból mindig egy van (egy adott dokumentumra vonatkozóan), a <code>FontEditorView</code> objektumok igény szerint jönnek létre, 0..n példány létezhet.</li>
<li>Vegyük fel a két osztályt.</li>
<li>Implementáltassuk velük az <code>IView</code> interfészt (<em>Toolbox / Inheritence</em> kapcsolat). Az <code>Update</code> művelet automatikusan implementálva lesz.</li>
</ul>
<h2 id="3-feladat-a-kesz-alkalmazas-attekintese">3. Feladat - A kész alkalmazás áttekintése<a class="headerlink" href="#3-feladat-a-kesz-alkalmazas-attekintese" title="Permanent link">¶</a></h2>
<p>Idő hiányában nem valósítjuk meg az alkalmazást, hanem a kész megoldást nézzük át (laboron kb. 15 percben), annak is csak néhány lényeges használati esetét.</p>
<p>Töltsük le  a kész <a href="https://github.com/bmeviauab00/lab-docview-megoldas">megoldást</a>. Ehhez parancssorban navigáljunk a c:\work\<sajátnev> mappába (ha a laborban dolgozunk), és adjuk ki a következő parancsot:</sajátnev></p>
<p><code>git clone https://github.com/bmeviauab00/lab-docview-megoldas</code></p>
<p>Nyissuk meg a kész solution-t, futtassuk és próbáljuk ki az alkalmazás alapfunkcióit.</p>
<h3 id="nezetek-megvalositasa">Nézetek megvalósítása<a class="headerlink" href="#nezetek-megvalositasa" title="Permanent link">¶</a></h3>
<p>Nyissuk meg a <code>FontEditorView</code>-t, először a kódot nézzük. A <code>FontEditorView</code> egyrészt implementálja az <code>IView</code> interfészt, másrészt a <code>UserControl</code>-ból származik. Mégpedig azért, mert így a tervezőben (designer) tudjuk kialakítani a felhasználói felületét, pont úgy, mint egy űrlapnak. A Visual Studio designer felületén akár bele is módosíthatnánk a layoutba és a vezérlők tulajdonságaiba. Ha kíváncsiak vagyunk, ki is próbálhatjuk ezt (pl. a nagyítás és a kicsinyítés gombok helyének megváltoztatásával).</p>
<p>A <code>SampleTextView</code> is <code>UserControl</code> leszármazott, bár annak egyszerű a felülete (nincsenek rajta más vezérlők), így lehetett volna közönséges <code>Control</code> leszármazott is.</p>
<p><img alt="❗" class="twemoji" src="https://cdnjs.cloudflare.com/ajax/libs/twemoji/14.0.2/svg/2757.svg" title=":exclamation:"/> Vonjuk le a tanulságot: <strong>Windows Forms környezetben a nézeteket tipikusan <code>UserControl</code>-ként (esetleg <code>Control</code>-ként) célszerű megvalósítani.</strong></p>
<h3 id="egy-oldal-tab-elrendezese">Egy oldal (tab) elrendezése<a class="headerlink" href="#egy-oldal-tab-elrendezese" title="Permanent link">¶</a></h3>
<p>Futtassuk az alkalmazást. Valahogy ki kell alakítsuk egy adott oldal (tabpage) elrendezését. Lehetőleg tervezői nézetben, és nem futás közben, kódból pozícionálva az elemeket (legalábbis ahol nem muszáj). A <code>UserControl</code>-ok alkalmazása jelenti számunkra a megoldást. Nyissuk meg a <code>FontDocumentControl</code>-t tervezői nézetben. Ez egy olyan vezérlő, amely egy taboldalra kerül fel, azt tölti ki teljesen. Az oldalt a már ismert layout technikákkal alakítottuk ki (<code>Label</code>, <code>TextBox</code>, <code>Panel</code>-ek Dock-kolva). Ha van időnk, akkor nézzük meg a <em>Document Outline</em> ablakban. Az igazi érdekesség pedig az, hogy a <code>SampleTextView</code>-t is a <em>Toolbox</em>-ról <em>drag&amp;drop</em>-pal került felhelyezésre (pont úgy, mintha egy beépített vezérlő lenne). Annyit nézzünk meg, hogy a <code>SampleTextView</code> valóban ott van a <em>Toolbox</em> tetején.</p>
<h3 id="forgatokonyv-1-egy-pixel-invertalasa-nezetek-szinkronizalasa">Forgatókönyv 1 – Egy pixel invertálása, nézetek szinkronizálása<a class="headerlink" href="#forgatokonyv-1-egy-pixel-invertalasa-nezetek-szinkronizalasa" title="Permanent link">¶</a></h3>
<p><img alt="❗" class="twemoji" src="https://cdnjs.cloudflare.com/ajax/libs/twemoji/14.0.2/svg/2757.svg" title=":exclamation:"/> Ez egy kiemelt jelentőségű forgatókönyv, mert ezt illusztrálja a D-V architektúra alapmechanizmusát, a nézetek frissítését és konzisztensen tartását.
Keressük meg azt a függvényt, ahol az egész pixel invertálás folyamat elindul. A <code>FontEditorView.FontEditorView_MouseClick</code> a kiindulópont. Itt az alább kiemelt sor a lényeg:</p>
<div class="highlight"><pre><span></span><code><span class="k">private</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">FontEditorView_MouseClick</span><span class="p">(</span><span class="kt">object</span><span class="w"> </span><span class="n">sender</span><span class="p">,</span><span class="w"> </span><span class="n">MouseEventArgs</span><span class="w"> </span><span class="n">e</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">X</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">zoom</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">Y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">offsetY</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">zoom</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">CharDef</span><span class="p">.</span><span class="n">FontSize</span><span class="p">.</span><span class="n">Width</span><span class="p">)</span>
<span class="w">        </span><span class="k">return</span><span class="p">;</span>

<span class="hll"><span class="w">    </span><span class="n">document</span><span class="p">.</span><span class="n">InvertCharDefPixel</span><span class="p">(</span><span class="n">editedChar</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">);</span>
</span><span class="p">}</span>
</code></pre></div>
<p>Nézzük meg a <code>FontEditorDocument.InvertCharDefPixel</code>-t. Az invertálja a megfelelő <code>CharDef</code> pixelét, de a lényeg az utolsó sor:</p>
<div class="highlight"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">InvertCharDefPixel</span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">charDef</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetCharDefCore</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">charDef</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">null</span><span class="p">)</span>
<span class="w">        </span><span class="k">return</span><span class="p">;</span>

<span class="w">    </span><span class="n">charDef</span><span class="p">.</span><span class="n">Pixels</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">!</span><span class="n">charDef</span><span class="p">.</span><span class="n">Pixels</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">];</span>

<span class="hll"><span class="w">    </span><span class="n">UpdateAllViews</span><span class="p">();</span>
</span><span class="p">}</span>
</code></pre></div>
<p>Az <code>UpdateAllViews</code> a <code>Document</code> ősben van, <code>Update</code>-et hív minden nézetre. Ami érdekes, hogy az <code>Update</code> hogyan van megírva az egyes nézetekben. Nézzük meg pl. a <code>FontEditView</code>-t:</p>
<div class="highlight"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">Update</span><span class="p">()</span>
<span class="p">{</span>
<span class="hll"><span class="w">    </span><span class="n">Invalidate</span><span class="p">();</span>
</span><span class="p">}</span>
</code></pre></div>
<p>Az <code>Update</code> hatására a nézetek újra kell rajzolják magukat az aktuális dokumentum állapot alapján. De az <code>Update</code>-ben nem tudunk rajzolni, csak az <code>OnPaint</code>-ben. Így itt az <code>Invalidate</code> hívással kiváltjuk a <code>Paint</code> eseményt. Ez megint egy tanulság: <strong>Windows Forms alkalmazásokban a nézetek <code>Update</code> függvényében tipikusan egy <code>Invalidate</code> hívás szokott lenni.</strong></p>
<p>Zárásképpen nézzük meg a <code>FontEditView.OnPaint</code> megvalósítását. Egyetlen lényeges dolog van itt: a megjelenítéshez le kell kérni a dokumentumtól az aktuális <code>CharDef</code>-et (mert a nézet a D-V architektúra alapelveinek megfelelően nem tárolja), majd ki kell azt rajzolni.</p>
<div class="highlight"><pre><span></span><code><span class="k">protected</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">OnPaint</span><span class="p">(</span><span class="n">PaintEventArgs</span><span class="w"> </span><span class="n">e</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">base</span><span class="p">.</span><span class="n">OnPaint</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>

<span class="hll"><span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">editedCharDef</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">document</span><span class="p">.</span><span class="n">GetCharDef</span><span class="p">(</span><span class="n">editedChar</span><span class="p">);</span>
</span>
<span class="hll"><span class="w">    </span><span class="n">CharDefViewModel</span><span class="p">.</span><span class="n">DrawFont</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">Graphics</span><span class="p">,</span><span class="w"> </span><span class="n">editedCharDef</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">offsetY</span><span class="p">,</span><span class="w"> </span><span class="n">zoom</span><span class="p">);</span>
</span><span class="p">}</span>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Kirajzolás logikája</p>
<p>Mivel a kirajzolás logikája a <code>FontEditorView</code>-ban és a <code>SampleTextView</code>-ban is azonosan működik a <code>Graphics</code> osztály használatával, kiszerveztük ezt egy <code>CharDefViewModel</code> segédosztályba az újrafelhasználhatóság kedvéért.</p>
<p>A <code>CharDef</code>-be nem célszerű rakni ezt a logikát, mivel az egy nézet független adatreprezentáció, és sokkal inkább a dokumentumhoz tartozik, mint a nézethez.</p>
</div>
<h3 id="forgatokonyv-2-uj-dokumentum-letrehozasa-opcionalis">Forgatókönyv 2 – Új dokumentum létrehozása (opcionális)<a class="headerlink" href="#forgatokonyv-2-uj-dokumentum-letrehozasa-opcionalis" title="Permanent link">¶</a></h3>
<p>Azt nézzük meg, hogyan történik egy új dokumentum létrehozása, vagyis mi történik a <em>File/New</em> menüelem kiválasztásakor.</p>
<p>Nyissuk meg a <code>MainForm</code>-ot tervezői nézetben, válaszuk a <em>File/New</em> menüelemet, majd ugorjunk el a <code>Click</code> eseménykezelőhöz. Arra látunk példát, hogy az <code>App</code> osztály, mint Singleton, hogy érhető el:</p>
<div class="highlight"><pre><span></span><code><span class="n">App</span><span class="p">.</span><span class="n">Instance</span><span class="p">.</span><span class="n">NewDocument</span><span class="p">();</span>
</code></pre></div>
<p>Az összes többi menüelem eseménykezelője hasonló, nincs semmi logika a GUI-ban, csak egyszerű továbbhívás az <code>App</code>-ba.</p>
<p>Tekintsük át az <code>App.NewDocument</code> törzsét, és egy-egy mondatban fussuk át a fontosabb lépéseket.</p>
<ol>
<li><code>NewDocForm</code> nézet megnyitása és várakozás a válaszra.</li>
<li>Sikeres válasz esetén új <code>FontEditorDocument</code> létrehozása és felvétele a dokumentumok közé, valamint aktívvá tétele.</li>
<li>Új tab létrehozása a nézetekkel.</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">NewDocument</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="c1">// Bekérjükk az új font típus (dokumentum) nevét a</span>
<span class="w">    </span><span class="c1">// felhasználótól egy modális dialógs ablakban.</span>
<span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">form</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">NewDocForm</span><span class="p">(</span><span class="n">GetDocumentNames</span><span class="p">());</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">form</span><span class="p">.</span><span class="n">ShowDialog</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">DialogResult</span><span class="p">.</span><span class="n">OK</span><span class="p">)</span>
<span class="w">        </span><span class="k">return</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Új dokumentum objektum létrehozása és felvétele a dokumentum listába.</span>
<span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">doc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">FontEditorDocument</span><span class="p">(</span><span class="n">form</span><span class="p">.</span><span class="n">FontName</span><span class="p">);</span>
<span class="w">    </span><span class="n">documents</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Az új tab lesz az aktív, az activeDocument tagváltozót erre kell állítani.</span>
<span class="w">    </span><span class="n">UpdateActiveDocument</span><span class="p">(</span><span class="n">doc</span><span class="p">.</span><span class="n">Name</span><span class="p">);</span>

<span class="w">    </span><span class="n">CreateTabForNewDocument</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">App osztály felelősségi köre</p>
<p>Az egyszerűség érdekében az <code>App</code> osztály most több felelősséggel is rendelkezik, de ideális esetben szét lenne szedve pl. a következő osztályokra a felelősségi köröknek megfelelően:</p>
<ul>
<li><code>DocumentManager</code>: a megjelenítéstől függetlenül a dokumentumokat tárolná.</li>
<li><code>ViewManager</code>: feladata a nézetek menedzselése, tabcontrolokhoz hozzáadása stb. lenne.</li>
</ul>
</div>
<p>Az <code>App.OpenDocument</code> művelet törzse nincs implementálva, de a lépések kódmegjegyzések formájában adottak, remek otthoni gyakorlási lehetőség a művelet tényleges megvalósítása.</p>
<hr/>
<div class="md-source-file">
<span class="md-source-file__fact"> <span class="md-icon" title="Utolsó frissítés"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z">
</path>
</svg>
</span>
<span title="2023. február 25. 23:18:57">
<span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2023-02-25T23:18:57+01:00" locale="hu"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2023-02-25</span>
</span>
</span>
<span class="md-source-file__fact">
<span class="md-icon" title="Szerzők">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2Z">
</path>
</svg>
</span>
<span>Szerzők</span>
<nav><a class="md-author" href="https://github.com/bzolka" rel="noopener noreferrer" target="_blank" title="@bzolka">
<img alt="@bzolka" src="https://avatars.githubusercontent.com/bzolka?size=72"/>
</a><a class="md-author" href="https://github.com/tibitoth" rel="noopener noreferrer" target="_blank" title="@tibitoth">
<img alt="@tibitoth" src="https://avatars.githubusercontent.com/u/8333960?size=72"/>
</a><a class="md-author" href="https://github.com/zbenedek-mirango" rel="noopener noreferrer" target="_blank" title="@zbenedek-mirango">
<img alt="@zbenedek-mirango" src="https://avatars.githubusercontent.com/u/105201689?size=72"/>
</a></nav>
</span>
</div>
</article>
</div>
</div>
<a class="md-top md-icon" data-md-component="top" hidden="" href="#">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"></path></svg>
            Vissza a tetejére
          </a>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
<div class="md-copyright__highlight">
      Copyright © BME VIK AUT
    </div>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.instant", "navigation.top", "search.suggest", "content.action.edit"], "search": "../../assets/javascripts/workers/search.db81ec45.min.js", "translations": {"clipboard.copied": "V\u00e1g\u00f3lapra m\u00e1solva", "clipboard.copy": "M\u00e1sol\u00e1s v\u00e1g\u00f3lapra", "search.result.more.one": "1 tov\u00e1bbi tal\u00e1lat az oldalon", "search.result.more.other": "# tov\u00e1bbi tal\u00e1lat az oldalon", "search.result.none": "Nincs tal\u00e1lat", "search.result.one": "1 egyez\u0151 dokumentum", "search.result.other": "# egyez\u0151 dokumentum", "search.result.placeholder": "Keres\u00e9shez \u00edrj ide valamit", "search.result.term.missing": "\u00dcres", "select.version": "Verzi\u00f3v\u00e1lt\u00e1s"}}</script>
<script src="../../assets/javascripts/bundle.4b2c34cd.min.js"></script>
<script src="../../js/timeago.min.js"></script>
<script src="../../js/timeago_mkdocs_material.js"></script>
<script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>